<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;树莓派4B安装clash&quot;&gt;&lt;a href=&quot;#树莓派4B安装clash&quot; class=&quot;headerlink&quot; title=&quot;树莓派4B安装clash&quot;&gt;&lt;/a&gt;树莓派4B安装clash&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;clash网址：&lt;a href=&quot;https://github.com/Dreamacro/clash/releases&quot;&gt;Releases · Dreamacro/clash (github.com)&lt;/a&gt;。树莓派4B对应的是armv7。&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;wget https:&lt;span class=&quot;comment&quot;&gt;//github.com/Dreamacro/clash/releases/download/v1.4.2/clash-linux-armv7-v1.4.2.gz&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;安装clash"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>使用clash | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Raspberry-Pi/" rel="tag">Raspberry Pi</a></div><div class="post-time">2021-09-01</div></div></div><div class="container post-header"><h1>使用clash</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A0%91%E8%8E%93%E6%B4%BE4B%E5%AE%89%E8%A3%85clash"><span class="toc-number">1.</span> <span class="toc-text">树莓派4B安装clash</span></a></li></ol></details></div><div class="container post-content"><h1 id="树莓派4B安装clash"><a href="#树莓派4B安装clash" class="headerlink" title="树莓派4B安装clash"></a>树莓派4B安装clash</h1><ol>
<li>clash网址：<a target="_blank" rel="noopener" href="https://github.com/Dreamacro/clash/releases">Releases · Dreamacro/clash (github.com)</a>。树莓派4B对应的是armv7。</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="comment">//github.com/Dreamacro/clash/releases/download/v1.4.2/clash-linux-armv7-v1.4.2.gz</span></span><br></pre></td></tr></table></figure>

<ol>
<li><p>安装clash</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解压并移动到合适的文件夹</span></span><br><span class="line">gzip clash-linux-armv7-v1.<span class="number">4.2</span>.gz -d /usr/local/bin/clash</span><br><span class="line"><span class="comment">//如果下载的是二进制文件直接移动</span></span><br><span class="line">sudo mv clash-linux-armv7-vv1.<span class="number">4.2</span> /usr/local/bin/clash</span><br><span class="line"><span class="comment">//权限</span></span><br><span class="line">sudo chmod a+x /usr/local/bin/clash</span><br></pre></td></tr></table></figure></li>
<li><p>运行并配置clash</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首次运行会生成clash文件夹</span></span><br><span class="line">clash</span><br><span class="line"><span class="comment">//修改配置文件：配置文件地址：/home/pi/.config/clash/config.yaml</span></span><br><span class="line"><span class="comment">//如果是root用户：/root/.config/clash/config.yaml</span></span><br><span class="line">我这里手动修改配置文件，直接打开mac中clash的配置文件，将其复制到树莓派的/root/.config/clash/config.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment">//重启clash服务看看有没有问题</span></span><br></pre></td></tr></table></figure></li>
<li><p>配置系统代理(本机可以跳过)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/apt/apt.conf.d</span><br><span class="line">vim proxy</span><br></pre></td></tr></table></figure>

<p>代理的格式：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//无密码：</span></span><br><span class="line">Acquire::http::Proxy <span class="string">&quot;http://192.168.2.107:9090&quot;</span>;</span><br><span class="line"><span class="comment">//有密码：</span></span><br><span class="line">Acquire::http::Proxy <span class="string">&quot;http://admin:123456@192.168.2.107:9090&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>修改后保存退出，重启clash看看能不能使用。</p>
</li>
<li><p>配置ui，暂且配置一个方便的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> https:<span class="comment">//github.com/Dreamacro/clash-dashboard.git</span></span><br><span class="line">cd clash-dashboard</span><br><span class="line">git checkout -b gh-pages origin/gh-pages</span><br><span class="line"><span class="comment">//config中external-controller修改为127.0.0.1或0.0.0.0随便，并修改密码.如果想要外部访问，修改为对应的ip号码。比如192.168.2.107</span></span><br><span class="line"><span class="comment">//external-ui: /home/pi/.config/clash/clash-dashboard</span></span><br></pre></td></tr></table></figure>

<p>输入ip:9090，应该得到clash的欢迎信息<br>输入ip和密码检查是否能够连接上<a target="_blank" rel="noopener" href="http://clash.razord.top/">http://clash.razord.top</a><br>如果都可以那就大功告成了</p>
</li>
<li><p>开机自启动等（我觉得没必要，我直接挂screen后台运行即可）</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/systemd/system/clash.service</span><br><span class="line"></span><br><span class="line">//修改配置</span><br><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=Clash Service</span><br><span class="line"><span class="attr">After</span>=network.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">ExecStart</span>=/bin/clash -d /home/pi/clash-bin</span><br><span class="line"><span class="attr">Restart</span>=<span class="literal">on</span>-abort</span><br><span class="line"><span class="attr">LimitNOFILE</span>=<span class="number">1048576</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure>

<p>开启开机自启动</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start clash</span><br><span class="line">systemctl enable clash</span><br><span class="line">systemctl status clash</span><br></pre></td></tr></table></figure>

<p>检查无误即可。</p>
</li>
<li><p>坑</p>
<ul>
<li>配置文件保存在pi/.config/clash而不是/pi/clash，不要改错了</li>
<li>系统问题:只支持utf-8,中文备注也会报错，最好手动改一下配置，把奇怪的字符都删掉。</li>
<li>记得修改配置文件的ip和端口号，我日常忘记改。。</li>
</ul>
</li>
<li><p>体验：树莓派的配置还算是不错的，500m以下的网可以考虑直接拿来当软路由。现在github恢复满速，又可以愉快地抄代码了。</p>
</li>
</ol>
</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>