<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;第1-3章&quot;&gt;&lt;a href=&quot;#第1-3章&quot; class=&quot;headerlink&quot; title=&quot;第1-3章&quot;&gt;&lt;/a&gt;第1-3章&lt;/h1&gt;&lt;p&gt;数据分析分为以下几个大类:"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>利用Python进行数据分析1_第1到4章_NumPy基础：数组和矢量计算 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-none-link" href="/tags/Python/" rel="tag">Python</a></div><div class="post-time">2021-03-12</div></div></div><div class="container post-header"><h1>利用Python进行数据分析1_第1到4章_NumPy基础：数组和矢量计算</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC1-3%E7%AB%A0"><span class="toc-number">1.</span> <span class="toc-text">第1-3章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC4%E7%AB%A0-NumPy%E5%9F%BA%E7%A1%80%EF%BC%9A%E6%95%B0%E7%BB%84%E5%92%8C%E2%BD%AE%E9%87%8F%E8%AE%A1%E7%AE%97"><span class="toc-number">2.</span> <span class="toc-text">第4章 NumPy基础：数组和⽮量计算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-NumPy%E7%9A%84ndarray%EF%BC%9A%E2%BC%80%E7%A7%8D%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.1.</span> <span class="toc-text">4.1 NumPy的ndarray：⼀种多维数组对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E9%80%9A%E2%BD%A4%E5%87%BD%E6%95%B0%EF%BC%9A%E5%BF%AB%E9%80%9F%E7%9A%84%E5%85%83%E7%B4%A0%E7%BA%A7%E6%95%B0%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.</span> <span class="toc-text">4.2 通⽤函数：快速的元素级数组函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3%E5%88%A9%E2%BD%A4%E6%95%B0%E7%BB%84%E8%BF%9B%E2%BE%8F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">2.3.</span> <span class="toc-text">4.3利⽤数组进⾏数据处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4%E2%BD%A4%E4%BA%8E%E6%95%B0%E7%BB%84%E7%9A%84%E2%BD%82%E4%BB%B6%E8%BE%93%E2%BC%8A%E8%BE%93%E5%87%BA"><span class="toc-number">2.4.</span> <span class="toc-text">4.4⽤于数组的⽂件输⼊输出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0"><span class="toc-number">2.5.</span> <span class="toc-text">4.5线性代数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E2%BD%A3%E6%88%90"><span class="toc-number">2.6.</span> <span class="toc-text">4.6伪随机数⽣成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7%E9%9A%8F%E6%9C%BA%E6%BC%AB%E6%AD%A5"><span class="toc-number">2.7.</span> <span class="toc-text">4.7随机漫步:</span></a></li></ol></li></ol></details></div><div class="container post-content"><h1 id="第1-3章"><a href="#第1-3章" class="headerlink" title="第1-3章"></a>第1-3章</h1><p>数据分析分为以下几个大类:</p>
<ul>
<li>与外部世界交互<br>阅读编写多种⽂件格式和数据商店；</li>
<li>数据准备<br>清洗、修改、结合、标准化、重塑、切⽚、切割、转换数 据，以进⾏分析； </li>
<li>转换数据<br>对旧的数据集进⾏数学和统计操作，⽣成新的数据集（例如，通过各组变量聚类成⼤的表）；</li>
<li>建模和计算<br>将数据绑定统计模型、机器学习算法、或其他计算⼯具； </li>
<li>展示<br>创建交互式和静态的图表可视化和⽂本总结</li>
</ul>
<hr>
<p>模块命名惯例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> statsmodels <span class="keyword">as</span> sm</span><br></pre></td></tr></table></figure>

<hr>
<p>⾏话:</p>
<ul>
<li>数据规整（Munge/Munging/Wrangling）<br>指的是将⾮结构化和（或）散乱数据处理为结构化或整洁形式的整个过程。<br>Munge这个词跟Lunge押韵。</li>
<li>伪码（Pseudocode）<br>算法或过程的“代码式”描述，⽽这些代码本身并不是实际有效的源代码。</li>
</ul>
<hr>
<p>使用ipython</p>
<ol>
<li><p>运行py文件:<br><code>%run hello_world.py</code></p>
</li>
<li><p>补全方法:<br>因为ipython本身就是增强交互版的shell,比起原生的shell,还可以使用<code>tab</code>自动补全方法:<br><img src="/images/1557024995148.png" alt="1557024995148"><br>这同样适用于模块和函数的参数:<br><img src="/images/1557025068872.png" alt="1557025068872"><br><img src="/images/1557025207336.png" alt="1557025207336"></p>
<p>注意:默认情况下,tab补全会自动隐藏魔术⽅法和内部的“私有”⽅法和属性</p>
</li>
<li><p>使用<code>?</code>显示对象的信息:<br>(前/后都可以:eg:<code>?b</code>,<code>b?</code>)<br><img src="/images/1557025362978.png" alt="1557025362978"></p>
<p><img src="/images/1557025534915.png" alt="1557025534915"></p>
</li>
<li><p>使用<code>??</code>显示函数源码:<br><img src="/images/1557025613342.png" alt="1557025613342"></p>
</li>
<li><p><code>%paste</code>:直接运行剪贴板的代码:<br><img src="/images/1557025761716.png" alt="1557025761716"><br><code>%cpaste</code>:粘贴任意多的代码再运⾏。</p>
</li>
<li><p>魔术命令:<br>IPython中特殊的命令（Python中没有）被称作“魔术”命令。这些命令可以使普通任务更便捷，更容易控制IPython系统。<br><img src="/images/1557026045397.png" alt="1557026045397"></p>
</li>
</ol>
<hr>
<p>python知识复习:</p>
<ol>
<li><p>Python解释器同⼀时间只能运⾏⼀个程序的⼀条语句。</p>
</li>
<li><p>强类型化语⾔:<br>意味着<strong>每个对象都有明确的类型（或类）</strong>，不会发默许转换:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">4</span></span><br><span class="line"><span class="comment"># js会默许a变成字符串类型,然后拼接成54</span></span><br><span class="line"><span class="comment"># py中,a的类型已经确定,不会默许转化类型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;5&#x27;</span> + a)</span><br></pre></td></tr></table></figure>

<p>判断强类型语言的标准:<br>如果语言经常隐式地转换变量的类型，那这个语言就是弱类型语言，如果很少会这样做，那就是强类型语言。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="comment"># py也有默许转换,但是只会发⽣在特定的情况下</span></span><br><span class="line"><span class="comment"># 此时a会从int改为float</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1.0</span> + a)</span><br></pre></td></tr></table></figure></li>
<li><p>静态语言和动态语言的区别:<br>在编译时检查类型的语言是静态类型语言，在运行时检查类型的语言是动态类型语言。<br><strong>静态类型需要声明类型</strong>（有些现代语言使用类型推导避免部分类型声明）Fortran和Lisp是最早的两门语言，现在仍在使用，它们分别是静态类型语言和动态类型语言。</p>
<p>所以python是动态强类型语言.</p>
</li>
<li><p>标量:<br>标量类型,即标准库中内建的类型(None,str,bytes,float,bool,int)</p>
</li>
<li><p>datatime:<br><code>datetime.datetime是不可变类型</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, date, time</span><br><span class="line"></span><br><span class="line">dt = datetime(<span class="number">2011</span>,<span class="number">10</span>,<span class="number">29</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">21</span>)</span><br><span class="line"><span class="built_in">print</span>(dt.day)  <span class="comment"># 29</span></span><br><span class="line"><span class="built_in">print</span>(dt.minute)  <span class="comment"># 30</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dt.date())  <span class="comment"># 2011-10-29</span></span><br><span class="line"><span class="built_in">print</span>(dt.time())  <span class="comment"># 20:30:21</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dt.strftime(<span class="string">&#x27;%m/%d/%Y	%H:%M&#x27;</span>))  <span class="comment"># 10/29/2011	20:30</span></span><br><span class="line"><span class="comment"># 转为datetime对象 2009-10-31 00:00:00</span></span><br><span class="line"><span class="built_in">print</span>(datetime.strptime(<span class="string">&#x27;20091031&#x27;</span>,<span class="string">&#x27;%Y%m%d&#x27;</span>))</span><br><span class="line"><span class="comment"># 替换time字段</span></span><br><span class="line">dt.replace(minute=<span class="number">0</span>,second=<span class="number">0</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>两个datetime对象的差会产⽣⼀个datetime.timedelta类型:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, date, time</span><br><span class="line"></span><br><span class="line">dt1 = datetime(<span class="number">2011</span>,<span class="number">10</span>,<span class="number">29</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">21</span>)</span><br><span class="line">dt2 = datetime(<span class="number">2011</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">22</span>,<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">delta = dt2 - dt1</span><br><span class="line"><span class="built_in">print</span>(delta)        <span class="comment"># 17 days, 1:59:39</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(delta))  <span class="comment"># &lt;class &#x27;datetime.timedelta&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将timedelta添加到datetime，会产⽣⼀个新的偏移datetime：</span></span><br><span class="line"><span class="built_in">print</span>(dt1 + delta)  <span class="comment"># 2011-11-15 22:30:00</span></span><br></pre></td></tr></table></figure></li>
<li><p>加号运算符将元组串联起来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">y = (<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(x))  <span class="comment"># 2575049627832</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(y))  <span class="comment"># 2575049655352</span></span><br><span class="line"></span><br><span class="line">z = x + y</span><br><span class="line"><span class="built_in">print</span>(z)      <span class="comment"># (1, 2, 3, 4, 5, 6)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(z))  <span class="comment"># 2575048177896</span></span><br></pre></td></tr></table></figure></li>
<li><p>乘法只是引用对象,并没有复制对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = [[<span class="number">1</span>]]</span><br><span class="line">y = x * <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="comment"># [[1], [1], [1], [1]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 乘法只是引用对象,并没有复制对象</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(y[<span class="number">0</span>]))  <span class="comment"># 1782212092424</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(y[<span class="number">1</span>]))  <span class="comment"># 1782212092424</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(y[<span class="number">2</span>]))  <span class="comment"># 1782212092424</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = (<span class="number">1</span>,)</span><br><span class="line">y = x * <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="comment"># (1, 1, 1, 1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 乘法只是引用对象,并没有复制对象</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(y[<span class="number">0</span>]))  <span class="comment"># 140720600772352</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(y[<span class="number">1</span>]))  <span class="comment"># 140720600772352</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(y[<span class="number">2</span>]))  <span class="comment"># 140720600772352</span></span><br></pre></td></tr></table></figure></li>
<li><p>一般将将不需要的变量使⽤下划线：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">values = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">a,b,*_  = values</span><br></pre></td></tr></table></figure></li>
<li><p>list也支持拆包:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">values = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">a,b,c,*_ = values</span><br><span class="line"><span class="built_in">print</span>(a,b,c)  <span class="comment"># 1 2 3</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>list就是数组</strong>.<br>所以lsit.append比list.insert复杂度低的主要原因不是index的查找,而是因为对后续<br>元素的引⽤必须在内部迁移，以便为新元素提供空间。</p>
</li>
<li><p>不要使用+来拓展list,应该使用extend<br>通过加法将列表串联的计算量较⼤，因为要新建⼀个列表，并且要复制对象。</p>
</li>
<li><p>内建的二分查找:bisect模块:</p>
<ul>
<li>bisect.bisect可以找到插⼊值的位置，</li>
<li>bisect.insort是向这个位置插⼊值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bisect</span><br><span class="line"></span><br><span class="line">c = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>]</span><br><span class="line"><span class="built_in">print</span>(bisect.bisect(c,<span class="number">4</span>))  <span class="comment"># 2</span></span><br><span class="line"><span class="built_in">print</span>(c)   <span class="comment"># [1, 3, 5, 7, 9]</span></span><br><span class="line"></span><br><span class="line">bisect.insort(c,<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(c)   <span class="comment"># [1, 3, 5, 6, 7, 9]</span></span><br></pre></td></tr></table></figure>

<p>bisect模块不会检查列表是否已排好序因此，对未排序的列表使⽤bisect不会产⽣错误，但结果不⼀定正确。</p>
</li>
<li><p>一旦要同时迭代多个序列就要想到使用zip:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">seq1 = [<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;baz&#x27;</span>]</span><br><span class="line">seq2 = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>	i,(a,b)	<span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(seq1,seq2)):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;&#123;0&#125;:	&#123;1&#125;,&#123;2&#125;&#x27;</span>.<span class="built_in">format</span>(i,a,b))</span><br><span class="line">	</span><br><span class="line"><span class="comment"># 0:foo,one</span></span><br><span class="line"><span class="comment"># 1:bar,two</span></span><br><span class="line"><span class="comment"># 2:baz,three</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">y = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">z = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> <span class="built_in">iter</span>(<span class="built_in">zip</span>(x,y,z)):</span><br><span class="line">	<span class="built_in">print</span>(each)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (1, 1, 1)</span></span><br><span class="line"><span class="comment"># (2, 2, 2)</span></span><br><span class="line"><span class="comment"># (3, 3, 3)</span></span><br><span class="line"><span class="comment"># (4, 4, 4)</span></span><br></pre></td></tr></table></figure></li>
<li><p>zip还可以用来解压缩:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">y = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">z = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">a,b,c,d = <span class="built_in">zip</span>(*(x,y,z))</span><br><span class="line"><span class="built_in">print</span>(a)  <span class="comment"># (1, 1, 1)</span></span><br><span class="line"><span class="built_in">print</span>(b)  <span class="comment"># (2, 2, 2)</span></span><br><span class="line"><span class="built_in">print</span>(c)  <span class="comment"># (3, 3, 3)</span></span><br><span class="line"><span class="built_in">print</span>(d)  <span class="comment"># (4, 4, 4)</span></span><br></pre></td></tr></table></figure></li>
<li><p>使用zip将两个序列配对组合成字典:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">seq1 = [<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;baz&#x27;</span>]</span><br><span class="line">seq2 = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>]</span><br><span class="line"></span><br><span class="line">x = <span class="built_in">dict</span>(<span class="built_in">zip</span>(seq1,seq2))</span><br><span class="line"><span class="built_in">print</span>(x) <span class="comment"># &#123;&#x27;foo&#x27;: &#x27;one&#x27;, &#x27;bar&#x27;: &#x27;two&#x27;, &#x27;baz&#x27;: &#x27;three&#x27;&#125;</span></span><br></pre></td></tr></table></figure></li>
<li><p>删除字典不仅可以使用pop,还可以使用del</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = &#123;<span class="string">&#x27;hyl&#x27;</span>:<span class="number">89</span>,<span class="string">&#x27;dsz&#x27;</span>:<span class="number">100</span>,<span class="string">&#x27;czj&#x27;</span>:<span class="number">50</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> x[<span class="string">&#x27;hyl&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(x) <span class="comment"># &#123;&#x27;dsz&#x27;: 100, &#x27;czj&#x27;: 50&#125;</span></span><br></pre></td></tr></table></figure></li>
<li><p>虽然字典的键值对没有顺序，这两个⽅法可以⽤相同的顺序输出键和值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = &#123;<span class="string">&#x27;hyl&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;dsz&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;czj&#x27;</span>:<span class="number">3</span>,<span class="string">&#x27;jzr&#x27;</span>:<span class="number">4</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(x.keys()))   <span class="comment"># [&#x27;hyl&#x27;, &#x27;dsz&#x27;, &#x27;czj&#x27;, &#x27;jzr&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(x.values())) <span class="comment"># [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure></li>
<li><p>Python 字典 setdefault() 函数:<strong>获取,获取不到就设置为键</strong>.<br>和get()方法类似, 如果键不存在于字典中，将会添加键并将值设为默认值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = &#123;<span class="string">&#x27;hyl&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;dsz&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;czj&#x27;</span>:<span class="number">3</span>,<span class="string">&#x27;jzr&#x27;</span>:<span class="number">4</span>&#125;</span><br><span class="line"></span><br><span class="line">a = x.setdefault(<span class="string">&#x27;hyl&#x27;</span>,<span class="number">9</span>)</span><br><span class="line"><span class="built_in">print</span>(a,x) </span><br><span class="line"><span class="comment"># 1 &#123;&#x27;hyl&#x27;: 1, &#x27;dsz&#x27;: 2, &#x27;czj&#x27;: 3, &#x27;jzr&#x27;: 4&#125;</span></span><br><span class="line"></span><br><span class="line">b = x.setdefault(<span class="string">&#x27;yyy&#x27;</span>,<span class="number">9</span>)</span><br><span class="line"><span class="built_in">print</span>(b,x)</span><br><span class="line"><span class="comment"># 9 &#123;&#x27;hyl&#x27;: 1, &#x27;dsz&#x27;: 2, &#x27;czj&#x27;: 3, &#x27;jzr&#x27;: 4, &#x27;yyy&#x27;: 9&#125;</span></span><br></pre></td></tr></table></figure>

<p>将单词按字母分类:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="string">&#x27;apple&#x27;</span>,<span class="string">&#x27;box&#x27;</span>,<span class="string">&#x27;class&#x27;</span>,<span class="string">&#x27;an&#x27;</span>]</span><br><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> x:</span><br><span class="line">	letter = each[<span class="number">0</span>]</span><br><span class="line">	d.setdefault(letter,[]).append(each)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment"># &#123;&#x27;a&#x27;: [&#x27;apple&#x27;, &#x27;an&#x27;], &#x27;b&#x27;: [&#x27;box&#x27;], &#x27;c&#x27;: [&#x27;class&#x27;]&#125;</span></span><br></pre></td></tr></table></figure></li>
<li><p>集合的所有逻辑运算都有原地方法和非原地方法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s1 = <span class="built_in">set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">s2 = <span class="built_in">set</span>([<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 非原地实现方法</span></span><br><span class="line">x = s1 | s2</span><br><span class="line"><span class="built_in">print</span>(x)    <span class="comment"># &#123;1, 2, 3, 4&#125;</span></span><br><span class="line"><span class="comment"># 原地实现方法</span></span><br><span class="line">s1 |= s2</span><br><span class="line"><span class="built_in">print</span>(s1)   <span class="comment"># &#123;1, 2, 3, 4&#125;</span></span><br></pre></td></tr></table></figure></li>
<li><p>set某种意义和tuple是完全相反的:</p>
<ul>
<li><code>tuple本身是不可变对象,但是tuple内部对象可以是可变的</code>.</li>
<li><code>虽然set本身是可变对象,但是内部元素必须是不可变对象</code>:<br>(因为内部元素必须进行哈希映射)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s1 = <span class="built_in">set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(s1))  <span class="comment"># 1642137660552</span></span><br><span class="line">s1.add(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(s1))  <span class="comment"># 1642137660552</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TypeError: unhashable type: &#x27;list&#x27;</span></span><br><span class="line">s1 = <span class="built_in">set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</span><br></pre></td></tr></table></figure></li>
<li><p>柯⾥化（currying）:<br>其实就是使用偏函数冻结一部分参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">x,y</span>):</span></span><br><span class="line">	<span class="keyword">return</span> x + y</span><br><span class="line"></span><br><span class="line">func2 = partial(func,<span class="number">5</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>itertools模块:<br>groupby分组。参数为序列和函数。函数返回相同值的序列为一组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">first_letter = <span class="keyword">lambda</span> x: x[<span class="number">0</span>]</span><br><span class="line">names = [<span class="string">&#x27;Alan&#x27;</span>, <span class="string">&#x27;Adam&#x27;</span>, <span class="string">&#x27;Wes&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Albert&#x27;</span>, <span class="string">&#x27;Steven&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> letter, names <span class="keyword">in</span> itertools.groupby(names, first_letter):</span><br><span class="line">    <span class="built_in">print</span>(letter, <span class="built_in">list</span>(names)) <span class="comment"># names is a generator</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A [&#x27;Alan&#x27;, &#x27;Adam&#x27;]</span></span><br><span class="line"><span class="comment"># W [&#x27;Wes&#x27;, &#x27;Will&#x27;]</span></span><br><span class="line"><span class="comment"># A [&#x27;Albert&#x27;]</span></span><br><span class="line"><span class="comment"># S [&#x27;Steven&#x27;]</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="第4章-NumPy基础：数组和⽮量计算"><a href="#第4章-NumPy基础：数组和⽮量计算" class="headerlink" title="第4章 NumPy基础：数组和⽮量计算"></a>第4章 NumPy基础：数组和⽮量计算</h1><p>NumPy的部分功能如下：</p>
<ul>
<li>ndarray，⼀个具有⽮量算术运算和复杂⼴播能⼒的快速且节省空间的多维数组。</li>
<li>⽤于对整组数据进⾏快速运算的标准数学函数（⽆需编写循环）。</li>
<li>⽤于读写磁盘数据的⼯具以及⽤于操作内存映射⽂件的⼯具。</li>
<li>线性代数、随机数⽣成以及傅⾥叶变换功能。</li>
<li>⽤于集成由C、C++、Fortran等语⾔编写的代码的A C API。</li>
</ul>
<p>NumPy可以⾼效处理⼤数组的数据。这是因为：</p>
<ul>
<li>NumPy是在⼀个连续的内存块中存储数据，独⽴于其他Python内置对象。NumPy的C语⾔编写的算法库可以操作内存，⽽不必进⾏类型检查或其它前期⼯作。⽐起Python的内置序列，NumPy数组使⽤的内存更少。</li>
<li>NumPy可以在整个数组上执⾏复杂的计算，⽽不需要Python的for循环。</li>
</ul>
<hr>
<h2 id="4-1-NumPy的ndarray：⼀种多维数组对象"><a href="#4-1-NumPy的ndarray：⼀种多维数组对象" class="headerlink" title="4.1 NumPy的ndarray：⼀种多维数组对象"></a>4.1 NumPy的ndarray：⼀种多维数组对象</h2><p>NumPy最重要的⼀个特点就是其N维数组对象（即ndarray）.既然是一个数组对象,所以他也是一个容器,其语法跟标量元素之间的运算⼀样。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成两个数组,每个数组有3个元素</span></span><br><span class="line">data = np.random.randn(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment"># [[-2.10200456  0.02878915  0.38511873]</span></span><br><span class="line"><span class="comment">#  [ 0.55724521 -0.69371297 -0.717718  ]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data*<span class="number">10</span>)</span><br><span class="line"><span class="comment"># [[-21.0200456    0.28789147   3.85118735]</span></span><br><span class="line"><span class="comment">#  [  5.57245214  -6.93712972  -7.17717996]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个元素都与⾃身相加。</span></span><br><span class="line"><span class="built_in">print</span>(data + data)</span><br><span class="line"><span class="comment"># [[-4.20400912  0.05757829  0.77023747]</span></span><br><span class="line"><span class="comment">#  [ 1.11449043 -1.38742594 -1.43543599]]</span></span><br></pre></td></tr></table></figure>

<p><strong>ndarray对象</strong>是⼀个通⽤的同构数据多维容器。<br>每个数组都有⼀个shape和⼀个dtype：</p>
<ul>
<li>shape<br>表示各维度⼤⼩的元组</li>
<li>dtype<br>⽤于说明数组数据类型的对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = np.random.randn(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment"># [[-0.60307723 -0.80704376  1.3647226 ]</span></span><br><span class="line"><span class="comment">#  [-0.16659969  0.63194806  0.97809585]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data.shape)</span><br><span class="line"><span class="comment"># (2, 3)     表示二维数组,每个数组3个元素</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data.dtype)</span><br><span class="line"><span class="comment"># float64    表示数组数据类型为float64</span></span><br></pre></td></tr></table></figure>

<p>创建ndarray</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data1 = [<span class="number">6</span>,<span class="number">7.5</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">100</span>,<span class="number">2</span>]</span><br><span class="line">data2 = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]]</span><br><span class="line">data3 = [[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">80</span>,<span class="number">1.0</span>,<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line">arr1 = np.array(data1)</span><br><span class="line">arr2 = np.array(data2)</span><br><span class="line">arr3 = np.array(data3)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr1)</span><br><span class="line"><span class="comment"># [  6.    7.5   8.    0.  100.    2. ]</span></span><br><span class="line"><span class="comment"># 其实就是[6.0  7.5  8.0  0.0  100.0  2.0]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr2)</span><br><span class="line"><span class="comment"># [[1 2 3 4]</span></span><br><span class="line"><span class="comment">#  [5 6 7 8]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr3)</span><br><span class="line"><span class="comment"># [list([1, 2]) list([80, 1.0, 0])]</span></span><br></pre></td></tr></table></figure>

<p>因为data2是列表的列表，NumPy数组arr2的两个维度的shape<br>是从data2引⼊的。可以⽤属性ndim和shape验证：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data1 = [<span class="number">6</span>,<span class="number">7.5</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">100</span>,<span class="number">2</span>]</span><br><span class="line">data2 = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]]</span><br><span class="line">data3 = [[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">80</span>,<span class="number">1.0</span>,<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line">arr1 = np.array(data1)</span><br><span class="line">arr2 = np.array(data2)</span><br><span class="line">arr3 = np.array(data3)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr1.ndim,arr1.shape)</span><br><span class="line"><span class="comment"># 1 (6,)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 等⻓列表组成的列表转为多维数组</span></span><br><span class="line"><span class="built_in">print</span>(arr2.ndim,arr2.shape)</span><br><span class="line"><span class="comment"># 2 (2, 4)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 非等长</span></span><br><span class="line"><span class="built_in">print</span>(arr3.ndim,arr3.shape)</span><br><span class="line"><span class="comment"># 1 (2,)</span></span><br></pre></td></tr></table></figure>

<p>所以就是说,ndarray.shape表示了这个多维数组的形状:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(2,3)表示2行3列</span><br><span class="line">(10)表示1行10列</span><br><span class="line">(4,3,2)表示三维数组,第一维4个元素,第二维3个元素,第三维2个元素</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data1 = np.random.randn(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">data2 = np.random.randn(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">data3 = np.random.randn(<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data3)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [[[-0.8071717   0.10112021  1.21315047]</span></span><br><span class="line"><span class="comment">#   [ 2.06134452  0.52341324 -0.9417632 ]]]</span></span><br><span class="line"><span class="comment"># --------</span></span><br><span class="line"><span class="comment"># [[[ 0.22009258 -1.38361836  0.99233159]</span></span><br><span class="line"><span class="comment">#   [ 0.80876499  1.16215538  0.15391251]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[-2.17604067  0.38863864  1.08298809]</span></span><br><span class="line"><span class="comment">#   [-0.08271547 -1.49779443  1.56485888]]]</span></span><br><span class="line"><span class="comment"># --------</span></span><br><span class="line"><span class="comment"># [[[ 1.737971    1.46302365 -0.33018833]</span></span><br><span class="line"><span class="comment">#   [ 0.92194819  0.56506825  0.71456561]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 0.57141615 -0.44381919 -1.213822  ]</span></span><br><span class="line"><span class="comment">#   [ 0.132801   -0.7962571  -0.54658224]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[-0.72645018 -0.15283847 -1.83275693]</span></span><br><span class="line"><span class="comment">#   [-0.86466428 -1.49513288 -0.21682686]]]</span></span><br></pre></td></tr></table></figure>

<p>另外创建数组的函数:</p>
<ul>
<li><p>zeros/ones:<br>创建指定⻓度或形状的全0或全1数组。</p>
</li>
<li><p>empty:</p>
<p>创建⼀个没有任何具体值的数组</p>
</li>
<li><p>arange:<br>Python内置函数range的数组版：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.zeros(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]</span></span><br><span class="line"></span><br><span class="line">y = np.zeros((<span class="number">3</span>,<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="comment"># [[0. 0. 0. 0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [0. 0. 0. 0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [0. 0. 0. 0. 0. 0.]]</span></span><br><span class="line"></span><br><span class="line">z = np.empty((<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line"><span class="comment"># [[[7.33371104e+069 6.33874203e-307]</span></span><br><span class="line"><span class="comment">#   [8.87280296e+132 1.80090755e+108]</span></span><br><span class="line"><span class="comment">#   [2.00272360e-307 1.86919785e-306]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[8.06624499e-308 1.24610383e-306]</span></span><br><span class="line"><span class="comment">#   [1.37961709e-306 1.29057883e-306]</span></span><br><span class="line"><span class="comment">#   [1.24610927e-306 6.23057688e-307]]]</span></span><br></pre></td></tr></table></figure>

<p>np.empty返回的是⼀些未初始化的垃圾值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># [0 1 2 3 4 5 6 7 8 9]</span></span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">2</span>,<span class="number">10</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># [2 5 8]</span></span><br></pre></td></tr></table></figure>

<p>创建数组函数:</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>array</td>
<td>将输入数据(列表、元组、数组或其它序列类型)转换为 ndarray.要么推断出 dtype,要么特别指定dtype.默认直接复制输入数据</td>
</tr>
<tr>
<td>asarray</td>
<td>将输入转换为 ndarray,如果输入本身就是一个 narray就不进行复制</td>
</tr>
<tr>
<td>arange</td>
<td>类似于内置的range,但返回的是一个narray而不是列表</td>
</tr>
<tr>
<td>ones,ones_like</td>
<td>根据指定的形状和 dtype创建一个全1数组,one like以另一个数组为参数,并根据其形状和dype创建一个全1数组</td>
</tr>
<tr>
<td>zeros,zeros_like</td>
<td>类似于ones和ones like,只不过产生的是全0数组而已</td>
</tr>
<tr>
<td>empty,empty_like</td>
<td>创建新数组,只分配内存空间但不填充任何值</td>
</tr>
<tr>
<td>full,full_like</td>
<td>用 fill value中的所有值,根据指定的形状和dype创建一个数组,full_like使用另一个数组,用相同的形状和dtype创建</td>
</tr>
<tr>
<td>eye,identity</td>
<td>创建一个正方的NxN单位矩阵(对角线为1,其余为0)</td>
</tr>
</tbody></table>
<p>array()创建是是对原始对象的一份copy创建的，而asarray是当输入是ndarry并不进行复制操作，如果改变创新的数组，则原始数组也会跟着改变。</p>
<hr>
<p>ndarray的数据类型</p>
<p>dtype（数据类型）是⼀个特殊的对象，它含有ndarray<strong>将⼀块内存解释为特定数据类型</strong>所需的信息：<br>简单来说就是==数组元素的类型==.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr1 = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],dtype=np.float64)</span><br><span class="line">arr2 = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],dtype=np.int32)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr1.dtype)  <span class="comment"># float64</span></span><br><span class="line"><span class="built_in">print</span>(arr2.dtype)  <span class="comment"># int32</span></span><br></pre></td></tr></table></figure>

<p>dtype命名规则:<br>⼀个类型名（如float或int），后⾯跟⼀个⽤于表示各元素位⻓的数字。<br>标准的双精度浮点值（即Python中的float对象）需要占⽤8字节（即64位）。因此，该类型在NumPy中就记作float64。</p>
<p>使用astype来转化数组的dtype</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr1 = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(arr1.dtype)  <span class="comment"># int32</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将整形转化为浮点型</span></span><br><span class="line">x = arr1.astype(np.float64)</span><br><span class="line"><span class="built_in">print</span>(x.dtype)     <span class="comment"># float64</span></span><br><span class="line"><span class="built_in">print</span>(x)           <span class="comment"># [1. 2. 3.]</span></span><br></pre></td></tr></table></figure>

<p>注意,如果将浮点型转化为整形,那么就会截取小数部分:<br>不管小数部分是什么值,一律舍去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr1 = np.array([<span class="number">1.1</span>,<span class="number">2.9</span>,<span class="number">3.0</span>,<span class="number">4.5</span>])</span><br><span class="line"><span class="built_in">print</span>(arr1.dtype)  <span class="comment"># float64</span></span><br><span class="line"></span><br><span class="line">x = arr1.astype(np.int32)</span><br><span class="line"><span class="built_in">print</span>(x.dtype)     <span class="comment"># int32</span></span><br><span class="line"><span class="built_in">print</span>(x)           <span class="comment"># [1 2 3 4]</span></span><br></pre></td></tr></table></figure>

<p>字符串类型的数字一样可以转化为数字类型:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串类型的数字.</span></span><br><span class="line"><span class="comment"># 对应的dtype是np.string_</span></span><br><span class="line">numeric_strings = np.array([<span class="string">&#x27;1.25&#x27;</span>, <span class="string">&#x27;-9.6&#x27;</span>, <span class="string">&#x27;42&#x27;</span>], dtype=np.string_)</span><br><span class="line"><span class="comment"># 偷懒写法.真正的完整写法为x = numeric_strings.astype(np.float64)</span></span><br><span class="line">x = numeric_strings.astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="built_in">print</span>(x)        <span class="comment"># [ 1.25 -9.6  42.  ]</span></span><br><span class="line"><span class="built_in">print</span>(x.dtype)  <span class="comment"># float64</span></span><br></pre></td></tr></table></figure>

<p>注意转换的时候可能会发生截取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">numeric_strings = np.array([<span class="string">&#x27;1.2555555555555&#x27;</span>, <span class="string">&#x27;-9.611111111111111&#x27;</span>, <span class="string">&#x27;42.000000000005&#x27;</span>], dtype=np.string_)</span><br><span class="line">x = numeric_strings.astype(<span class="built_in">float</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发生了截取</span></span><br><span class="line"><span class="built_in">print</span>(x)        <span class="comment"># [ 1.25555556 -9.61111111 42.        ]</span></span><br><span class="line"><span class="built_in">print</span>(x.dtype)  <span class="comment"># float64</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">int_array = np.arange(<span class="number">10</span>)</span><br><span class="line">calibers = np.array([<span class="number">.22</span>, <span class="number">.270</span>, <span class="number">.357</span>, <span class="number">.380</span>, <span class="number">.44</span>, <span class="number">.50</span>], dtype=np.float64)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用别人的dtype来修改自己的dtype</span></span><br><span class="line"><span class="built_in">print</span>(int_array.astype(calibers.dtype))</span><br></pre></td></tr></table></figure>



<p>NumPy数组的运算</p>
<p>为什么要使用多维数组?<br>因为这样可以让你<strong>不用编写循环就可以对数据执行批量运算</strong>.</p>
<p>==运算时,把多维数组当成是矢量.==<br>⼤⼩相等的数组之间的任何算术运算都会将<strong>运算应⽤到元素级</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.array([[<span class="number">1.</span>,<span class="number">2.</span>,<span class="number">3.</span>],[<span class="number">4.</span>,<span class="number">5.</span>,<span class="number">6.</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[1. 2. 3.]</span></span><br><span class="line"><span class="comment">#  [4. 5. 6.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr * arr)</span><br><span class="line"><span class="comment"># [[ 1.  4.  9.]</span></span><br><span class="line"><span class="comment">#  [16. 25. 36.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr - arr)</span><br><span class="line"><span class="comment"># [[0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [0. 0. 0.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span> / arr)</span><br><span class="line"><span class="comment"># [[1.         0.5        0.33333333]</span></span><br><span class="line"><span class="comment">#  [0.25       0.2        0.16666667]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr ** <span class="number">.5</span>)</span><br><span class="line"><span class="comment"># [[1.         1.41421356 1.73205081]</span></span><br><span class="line"><span class="comment">#  [2.         2.23606798 2.44948974]]</span></span><br></pre></td></tr></table></figure>

<p><strong>大小相同的数组</strong>之间的⽐较会⽣成布尔值数组：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr1 = np.array([[<span class="number">1.</span>,<span class="number">2.</span>,<span class="number">3.</span>],[<span class="number">4.</span>, <span class="number">5.</span> ,<span class="number">6.</span>  ]])</span><br><span class="line">arr2 = np.array([[<span class="number">0.</span>,<span class="number">4.</span>,<span class="number">3.</span>],[<span class="number">4.0</span>,<span class="number">5.1</span>,<span class="number">6.00</span>]])</span><br><span class="line"></span><br><span class="line">x = (arr1 &gt;= arr2)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># [[ True False  True]</span></span><br><span class="line"><span class="comment">#  [ True False  True]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.dtype)</span><br><span class="line"><span class="comment"># bool</span></span><br></pre></td></tr></table></figure>

<p>不同⼤⼩的数组之间的运算叫做⼴播（broadcasting）</p>
<p>基本的索引和切⽚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)       <span class="comment"># [0 1 2 3 4 5 6 7 8 9]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[<span class="number">2</span>])    <span class="comment"># 2</span></span><br><span class="line"><span class="built_in">print</span>(arr[<span class="number">1</span>:<span class="number">3</span>])  <span class="comment"># [1 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意这里和list不一样.</span></span><br><span class="line"><span class="comment"># list返回[ 0  99  3  4  5  6  7  8  9]</span></span><br><span class="line">arr[<span class="number">1</span>:<span class="number">3</span>] = <span class="number">99</span></span><br><span class="line"><span class="built_in">print</span>(arr)       <span class="comment"># [ 0 99 99  3  4  5  6  7  8  9]</span></span><br></pre></td></tr></table></figure>

<p>当你将⼀个标量值赋值给⼀个切⽚时（如arr[5:8]=99），该值会⾃动<code>⼴播</code>到整个选区。</p>
<p>跟列表最重要的区别在于，==数组切片是原始数组的视图==。<br>这意味着<strong>数据不会被复制</strong>，==视图上的任何修改都会直接反映到源数组上==。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># arr_slice只是arr的视图而已.</span></span><br><span class="line"><span class="comment"># 也就是说arr_slice只是引用了arr</span></span><br><span class="line"><span class="comment"># 任何arr_slice的修改都会反映到arr上</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)  <span class="comment"># [0 1 2 3 4 5 6 7 8 9]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">arr[<span class="number">1</span>:<span class="number">4</span>] = <span class="number">99</span></span><br><span class="line">arr_slice = arr[<span class="number">1</span>:<span class="number">4</span>]</span><br><span class="line"><span class="built_in">print</span>(arr_slice)  <span class="comment"># [99 99 99]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)    <span class="comment"># [ 0 99 99 99  4  5  6  7  8  9]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将arr_slice的索引为1的元素改为12345</span></span><br><span class="line">arr_slice[<span class="number">1</span>] = <span class="number">12345</span></span><br><span class="line"><span class="built_in">print</span>(arr)  <span class="comment"># [    0    99 12345    99     4     5     6     7     8     9]</span></span><br><span class="line"></span><br><span class="line">arr_slice[:] = <span class="number">66</span></span><br><span class="line"><span class="built_in">print</span>(arr)  <span class="comment"># [ 0 66 66 66  4  5  6  7  8  9]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">alist = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># slice是alist复制一部分下来的,二者已经毫不相干了</span></span><br><span class="line"><span class="built_in">slice</span> = alist[<span class="number">1</span>:<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">slice</span>)  <span class="comment"># [2, 3]</span></span><br><span class="line"><span class="built_in">print</span>(alist)  <span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">slice</span> = <span class="number">999</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">slice</span>)  <span class="comment"># 999</span></span><br><span class="line"><span class="built_in">print</span>(alist)  <span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></table></figure>

<p>由于NumPy的设计目的是处理⼤数据，假如NumPy坚持要将数据复制来复制去的话会大量的性能和内存问题。</p>
<p>多维数组的索引问题</p>
<ul>
<li>切片索引:<br>使用视图</li>
<li>布尔索引:<br>创建数据副本</li>
<li>花式索引:<ol>
<li>⼀次传⼊多个索引数组会返回的⼀个⼀维数组</li>
</ol>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr2d = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr2d[<span class="number">2</span>])  <span class="comment"># [7 8 9]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下面两种方法等价</span></span><br><span class="line"><span class="built_in">print</span>(arr2d[<span class="number">0</span>][<span class="number">2</span>])  <span class="comment"># 3</span></span><br><span class="line"><span class="built_in">print</span>(arr2d[<span class="number">0</span>,<span class="number">2</span>])   <span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr2d[:<span class="number">2</span>,<span class="number">1</span>:])</span><br><span class="line"><span class="comment"># [[2 3]</span></span><br><span class="line"><span class="comment">#  [5 6]]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr3d = np.array([[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]], [[<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>], [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]]])</span><br><span class="line"><span class="built_in">print</span>(arr3d.shape)  </span><br><span class="line"><span class="comment"># (2, 2, 3)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr3d)</span><br><span class="line"><span class="comment"># [[[ 1  2  3]</span></span><br><span class="line"><span class="comment">#   [ 4  5  6]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 7  8  9]</span></span><br><span class="line"><span class="comment">#   [10 11 12]]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr3d[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># [[1 2 3]</span></span><br><span class="line"><span class="comment">#  [4 5 6]]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr3d = np.array([[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]], [[<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>], [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr3d)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;******************1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 和list切片一样,这才是真正的复制</span></span><br><span class="line"><span class="comment"># 这样old_values和多维数组就没有关系了</span></span><br><span class="line">old_values = arr3d[<span class="number">0</span>].copy()</span><br><span class="line"><span class="built_in">print</span>(old_values)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;******************2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">arr3d[<span class="number">0</span>] = <span class="number">42</span></span><br><span class="line"><span class="built_in">print</span>(arr3d)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;******************3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">arr3d[<span class="number">0</span>] = old_values</span><br><span class="line"><span class="built_in">print</span>(arr3d)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [[[ 1  2  3]</span></span><br><span class="line"><span class="comment">#   [ 4  5  6]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 7  8  9]</span></span><br><span class="line"><span class="comment">#   [10 11 12]]]</span></span><br><span class="line"><span class="comment"># ******************1</span></span><br><span class="line"><span class="comment"># [[1 2 3]</span></span><br><span class="line"><span class="comment">#  [4 5 6]]</span></span><br><span class="line"><span class="comment"># ******************2</span></span><br><span class="line"><span class="comment"># [[[42 42 42]</span></span><br><span class="line"><span class="comment">#   [42 42 42]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 7  8  9]</span></span><br><span class="line"><span class="comment">#   [10 11 12]]]</span></span><br><span class="line"><span class="comment"># ******************3</span></span><br><span class="line"><span class="comment"># [[[ 1  2  3]</span></span><br><span class="line"><span class="comment">#   [ 4  5  6]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 7  8  9]</span></span><br><span class="line"><span class="comment">#   [10 11 12]]]</span></span><br></pre></td></tr></table></figure>

<p>可以发现,使用索引就能降维(切片不能).<br>也就是说:<code>arr[1,:2]</code>和<code>arr[1:2,:2]</code>是不一样的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr2d = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr2d.shape)   <span class="comment"># (3, 3)</span></span><br><span class="line"></span><br><span class="line">arr1 = arr2d[<span class="number">1</span>,:<span class="number">2</span>]</span><br><span class="line">arr2 = arr2d[<span class="number">1</span>:<span class="number">2</span>,:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr1)  <span class="comment"># [4 5]</span></span><br><span class="line"><span class="built_in">print</span>(arr2)  <span class="comment"># [[4 5]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr1.shape)  <span class="comment"># (2,)</span></span><br><span class="line"><span class="built_in">print</span>(arr2.shape)  <span class="comment"># (1, 2)</span></span><br></pre></td></tr></table></figure>

<p>现在有7个名字,还有一个7行4列的数据,每个名字对应每一行,现在要找出名字为bob对应的行:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">names = np.array([<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>])</span><br><span class="line">data = np.random.randn(<span class="number">7</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(names)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;***************&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(names==<span class="string">&#x27;Bob&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;***************&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找出bob对应的行</span></span><br><span class="line"><span class="built_in">print</span>(data[names==<span class="string">&#x27;Bob&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;***************&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># [&#x27;Bob&#x27; &#x27;Joe&#x27; &#x27;Will&#x27; &#x27;Bob&#x27; &#x27;Will&#x27; &#x27;Joe&#x27; &#x27;Joe&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [[-1.09713394  0.41574381 -1.33751931 -0.93130873]</span></span><br><span class="line"><span class="comment">#  [ 1.12539937 -0.16825646 -1.13447574  0.52805166]</span></span><br><span class="line"><span class="comment">#  [-0.98992142 -1.19969387 -0.53664124 -1.08782551]</span></span><br><span class="line"><span class="comment">#  [-0.33742991 -0.34564667 -0.18650757  0.51191268]</span></span><br><span class="line"><span class="comment">#  [-2.8074128  -1.60146652 -1.1361489  -1.54189387]</span></span><br><span class="line"><span class="comment">#  [-0.88793971  1.28222486 -0.23209788  0.25965213]</span></span><br><span class="line"><span class="comment">#  [-0.37233941  0.07983729 -0.008324   -0.31428477]]</span></span><br><span class="line"><span class="comment"># ***************</span></span><br><span class="line"><span class="comment"># [ True False False  True False False False]</span></span><br><span class="line"><span class="comment"># ***************</span></span><br><span class="line"><span class="comment"># [[-1.09713394  0.41574381 -1.33751931 -0.93130873]</span></span><br><span class="line"><span class="comment">#  [-0.33742991 -0.34564667 -0.18650757  0.51191268]]</span></span><br><span class="line"><span class="comment"># ***************</span></span><br></pre></td></tr></table></figure>

<p>注意:布尔型数组的⻓度必须跟被索引的轴⻓度⼀致<br>(就是这里的7个名字对应7行4列数据)</p>
<p>注意<code>data[names==&#39;Bob&#39;,2:]</code>的意义:<br><strong>选取names==’Bob’的行,再选取2:的列</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">names = np.array([<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>])</span><br><span class="line">data = np.random.randn(<span class="number">7</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[names==<span class="string">&#x27;Bob&#x27;</span>])</span><br><span class="line"><span class="comment"># [[-0.17698359  0.13282278  0.73329761  0.31348624]</span></span><br><span class="line"> <span class="comment"># [-0.70594974 -0.30617791  0.47489702  1.23911999]]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取names==&#x27;Bob&#x27;的行,再选取2:的列</span></span><br><span class="line"><span class="built_in">print</span>(data[names==<span class="string">&#x27;Bob&#x27;</span>,<span class="number">2</span>:])</span><br><span class="line"><span class="comment"># [[0.73329761 0.31348624]</span></span><br><span class="line"><span class="comment">#  [0.47489702 1.23911999]]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[names==<span class="string">&#x27;Bob&#x27;</span>,<span class="number">3</span>])</span><br><span class="line"><span class="comment"># [0.31348624 1.23911999]</span></span><br></pre></td></tr></table></figure>

<p>多维数组的否定:<br>可以使用!=,也可以使用~</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">names = np.array([<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>])</span><br><span class="line">data = np.random.randn(<span class="number">7</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[names!=<span class="string">&#x27;Bob&#x27;</span>])</span><br><span class="line"><span class="comment"># [[ 0.54165578  0.31375648  0.54207654  0.15667595]</span></span><br><span class="line"><span class="comment">#  [ 0.64080727 -2.50505078 -0.14822336 -1.04459888]</span></span><br><span class="line"><span class="comment">#  [ 0.03085972  1.05541171  0.19207644 -0.80538298]</span></span><br><span class="line"><span class="comment">#  [ 0.7813859   1.34868491 -0.42149489  0.47952686]</span></span><br><span class="line"><span class="comment">#  [ 2.23452939 -0.50605417  0.20597698 -0.87535366]]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[~(names==<span class="string">&#x27;Bob&#x27;</span>)])</span><br><span class="line"><span class="comment"># [[ 0.54165578  0.31375648  0.54207654  0.15667595]</span></span><br><span class="line"><span class="comment">#  [ 0.64080727 -2.50505078 -0.14822336 -1.04459888]</span></span><br><span class="line"><span class="comment">#  [ 0.03085972  1.05541171  0.19207644 -0.80538298]</span></span><br><span class="line"><span class="comment">#  [ 0.7813859   1.34868491 -0.42149489  0.47952686]</span></span><br><span class="line"><span class="comment">#  [ 2.23452939 -0.50605417  0.20597698 -0.87535366]]</span></span><br></pre></td></tr></table></figure>

<p>简单来说:</p>
<ul>
<li>&amp;:和</li>
<li>|:或</li>
<li>~:非</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">names = np.array([<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>])</span><br><span class="line">data = np.random.randn(<span class="number">7</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">x = (names==<span class="string">&#x27;Bob&#x27;</span>)</span><br><span class="line">y = (names==<span class="string">&#x27;Joe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[~x])</span><br><span class="line"><span class="comment"># [[ 0.4073387   0.40540836  0.63610871  1.06568761]</span></span><br><span class="line"><span class="comment">#  [-1.05935519 -1.40400291  0.37939374 -0.10043416]</span></span><br><span class="line"><span class="comment">#  [ 1.24084139  0.46000896  0.69128399 -0.84889116]</span></span><br><span class="line"><span class="comment">#  [-0.09564331  0.8738597   1.53244759 -0.25765163]</span></span><br><span class="line"><span class="comment">#  [-0.69661272  0.0305966  -0.65082183 -0.30457331]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[x|y])</span><br><span class="line"><span class="comment"># [[ 0.57919847 -0.66925921  0.17013694 -1.15948502]</span></span><br><span class="line"><span class="comment">#  [ 0.4073387   0.40540836  0.63610871  1.06568761]</span></span><br><span class="line"><span class="comment">#  [ 1.3716326   1.12825945 -0.50435748  2.17636178]</span></span><br><span class="line"><span class="comment">#  [-0.09564331  0.8738597   1.53244759 -0.25765163]</span></span><br><span class="line"><span class="comment">#  [-0.69661272  0.0305966  -0.65082183 -0.30457331]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[x&amp;y])</span><br><span class="line"><span class="comment"># []</span></span><br></pre></td></tr></table></figure>

<p>注意:</p>
<ul>
<li>使用布尔型索引选取数组中的数据，会<strong>创建数据的副本</strong></li>
<li>Python的and和or在布尔型数组中⽆效。要是⽤&amp;与|</li>
</ul>
<p>布尔型数组的使用:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将负值设置为0</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">names = np.array([<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>])</span><br><span class="line">data = np.random.randn(<span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">data[data&lt;<span class="number">0</span>]=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment"># [[1.89720605 0.        ]</span></span><br><span class="line"><span class="comment">#  [1.00057664 0.46105366]</span></span><br><span class="line"><span class="comment">#  [0.         0.        ]]</span></span><br></pre></td></tr></table></figure>

<hr>
<p>深入理解广播:<br>简单来讲,就是所有运算操作,赋值操作,逻辑操作,比较操作等等都会扩散到<code>整个选区</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.empty((<span class="number">4</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="comment"># arr[i]表示一行</span></span><br><span class="line">    <span class="comment"># 将i的赋值扩散到整个arr[i]选区</span></span><br><span class="line">	arr[i] = i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [1. 1. 1.]</span></span><br><span class="line"><span class="comment">#  [2. 2. 2.]</span></span><br><span class="line"><span class="comment">#  [3. 3. 3.]]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.empty((<span class="number">4</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        arr[i,j] = i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [1. 1. 1.]</span></span><br><span class="line"><span class="comment">#  [2. 2. 2.]</span></span><br><span class="line"><span class="comment">#  [3. 3. 3.]]</span></span><br></pre></td></tr></table></figure>

<p>上面两段代码效果是一样的.一个使用了一次循环,另一个使用了两次循环.</p>
<ul>
<li>代码1的i是对一整行操作.只不过是扩散到那一行的全部元素而已</li>
<li>代码2的i是对一个元素的操作,对每个元素都进行了赋值.</li>
</ul>
<hr>
<p>reshape函数:<br>在不改变矩阵的数值的前提下修改矩阵的形状。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.array([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[1 2]</span></span><br><span class="line"><span class="comment">#  [3 4]]</span></span><br><span class="line"><span class="built_in">print</span>(arr.shape)</span><br><span class="line"><span class="comment"># (2, 2)</span></span><br><span class="line"></span><br><span class="line">new1 = np.reshape(arr,(<span class="number">1</span>,<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(new1)</span><br><span class="line"><span class="comment"># [[1 2 3 4]]</span></span><br><span class="line"><span class="built_in">print</span>(new1.shape)</span><br><span class="line"><span class="comment"># (1, 4)</span></span><br><span class="line"></span><br><span class="line">new2 = np.reshape(arr,(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(new2)</span><br><span class="line"><span class="comment"># [1 2 3 4]</span></span><br><span class="line"><span class="built_in">print</span>(new2.shape)</span><br><span class="line"><span class="comment"># (4,)</span></span><br></pre></td></tr></table></figure>

<p>数组新的shape属性应该要与原来的配套，如果等于-1的话，那么Numpy会根据剩下的维度计算出数组的另外一个shape属性值。<br>(简单来说,-1代表我不知道要给行（或者列）设置为几,reshape函数会根据原矩阵的形状自动调整。)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">z = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">          	[<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">          	[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]])</span><br><span class="line"></span><br><span class="line">new1 = z.reshape(-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(new1)</span><br><span class="line"><span class="comment"># [ 1  2  3  4  5  6  7  8  9 10 11 12]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">new2 = z.reshape(<span class="number">1</span>,-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(new2)</span><br><span class="line"><span class="comment"># [[ 1  2  3  4  5  6  7  8  9 10 11 12]]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 列数为6,行数未知,让numpy自己计算</span></span><br><span class="line">new3 = z.reshape(-<span class="number">1</span>,<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(new3)</span><br><span class="line"><span class="comment"># [[ 1  2  3  4  5  6]</span></span><br><span class="line"><span class="comment">#  [ 7  8  9 10 11 12]]</span></span><br></pre></td></tr></table></figure>

<p>既然有了reshape,那么构造多维数组就可以使用:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">1</span>,<span class="number">33</span>).reshape((<span class="number">8</span>,<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[ 1  2  3  4]</span></span><br><span class="line"><span class="comment">#  [ 5  6  7  8]</span></span><br><span class="line"><span class="comment">#  [ 9 10 11 12]</span></span><br><span class="line"><span class="comment">#  [13 14 15 16]</span></span><br><span class="line"><span class="comment">#  [17 18 19 20]</span></span><br><span class="line"><span class="comment">#  [21 22 23 24]</span></span><br><span class="line"><span class="comment">#  [25 26 27 28]</span></span><br><span class="line"><span class="comment">#  [29 30 31 32]]</span></span><br></pre></td></tr></table></figure>



<hr>
<p>花式索引:<br>利⽤整数数组进⾏索引。</p>
<p>==花式索引跟切⽚不⼀样，它总是将数据复制到新数组中。==</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.empty((<span class="number">8</span>,<span class="number">4</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">	arr[i] = i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[0. 0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [1. 1. 1. 1.]</span></span><br><span class="line"><span class="comment">#  [2. 2. 2. 2.]</span></span><br><span class="line"><span class="comment">#  [3. 3. 3. 3.]</span></span><br><span class="line"><span class="comment">#  [4. 4. 4. 4.]</span></span><br><span class="line"><span class="comment">#  [5. 5. 5. 5.]</span></span><br><span class="line"><span class="comment">#  [6. 6. 6. 6.]</span></span><br><span class="line"><span class="comment">#  [7. 7. 7. 7.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">4</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>]])</span><br><span class="line"><span class="comment"># [[4. 4. 4. 4.]</span></span><br><span class="line"><span class="comment">#  [3. 3. 3. 3.]</span></span><br><span class="line"><span class="comment">#  [0. 0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [6. 6. 6. 6.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[-<span class="number">1</span>,-<span class="number">3</span>,-<span class="number">5</span>,-<span class="number">8</span>]])</span><br><span class="line"><span class="comment"># [[7. 7. 7. 7.]</span></span><br><span class="line"><span class="comment">#  [5. 5. 5. 5.]</span></span><br><span class="line"><span class="comment">#  [3. 3. 3. 3.]</span></span><br><span class="line"><span class="comment">#  [0. 0. 0. 0.]]</span></span><br></pre></td></tr></table></figure>

<p>注意<code>arr[1,2]</code>和<code>arr[[1,2]]</code>的区别:</p>
<ul>
<li><code>arr[1,2]</code>表示选取第一维度中索引值为1的数据,选区第二维度中索引值为2的数据</li>
<li><code>arr[[1,2]]</code>表示选取第一维度中索引值为1和2的数据</li>
</ul>
<p>简单来说,arr[1,2]是多维度选取,arr[[1,2]]只选择了一个维度</p>
<p>==⼀次传⼊多个索引数组会有⼀点特别。它返回的是⼀个⼀维数组，其中的元素对应各个索引元组==：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">32</span>).reshape((<span class="number">8</span>,<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[ 0  1  2  3]</span></span><br><span class="line"><span class="comment">#  [ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#  [ 8  9 10 11]</span></span><br><span class="line"><span class="comment">#  [12 13 14 15]</span></span><br><span class="line"><span class="comment">#  [16 17 18 19]</span></span><br><span class="line"><span class="comment">#  [20 21 22 23]</span></span><br><span class="line"><span class="comment">#  [24 25 26 27]</span></span><br><span class="line"><span class="comment">#  [28 29 30 31]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [[ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#  [20 21 22 23]</span></span><br><span class="line"><span class="comment">#  [28 29 30 31]</span></span><br><span class="line"><span class="comment">#  [ 8  9 10 11]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>],[<span class="number">1</span>,]])</span><br><span class="line"><span class="comment"># [ 5 21 29  9]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>],[<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [ 4 23 29 10]</span></span><br></pre></td></tr></table></figure>

<p>也就是说:<br><code>arr[[1,5,7,2],[0,3,1,2]]</code>最终选出的是元素(1,0)、(5,3)、(7,1)和(2,2)。</p>
<p>所以,<code>arr[[1,5,7,2],[1,]]最终选出的是元素(1,1)、(5,1)、(7,1)和(2,1)</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 花式索引跟切⽚不⼀样，它总是将数据复制到新数组中。</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">z = np.arange(<span class="number">20</span>).reshape((<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line"><span class="comment"># [[ 0  1  2  3  4]</span></span><br><span class="line"><span class="comment">#  [ 5  6  7  8  9]</span></span><br><span class="line"><span class="comment">#  [10 11 12 13 14]</span></span><br><span class="line"><span class="comment">#  [15 16 17 18 19]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(z[[<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [[ 5  6  7  8  9]</span></span><br><span class="line"><span class="comment">#  [10 11 12 13 14]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 花式索引是复制数据的</span></span><br><span class="line"><span class="comment"># 所以[1]会拿第二行数据</span></span><br><span class="line"><span class="built_in">print</span>(z[[<span class="number">1</span>,<span class="number">2</span>]]  [<span class="number">1</span>])</span><br><span class="line"><span class="comment"># [10 11 12 13 14]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [[1,2],1]整体属于花式搜索</span></span><br><span class="line"><span class="comment"># 所以[,1]会拿第二列数据</span></span><br><span class="line"><span class="built_in">print</span>(z[[<span class="number">1</span>,<span class="number">2</span>],<span class="number">1</span>])</span><br><span class="line"><span class="comment"># [ 6 11]</span></span><br></pre></td></tr></table></figure>

<p>重复使用花式索引:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">32</span>).reshape((<span class="number">8</span>,<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[ 0  1  2  3]</span></span><br><span class="line"><span class="comment">#  [ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#  [ 8  9 10 11]</span></span><br><span class="line"><span class="comment">#  [12 13 14 15]</span></span><br><span class="line"><span class="comment">#  [16 17 18 19]</span></span><br><span class="line"><span class="comment">#  [20 21 22 23]</span></span><br><span class="line"><span class="comment">#  [24 25 26 27]</span></span><br><span class="line"><span class="comment">#  [28 29 30 31]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 普通花式索引,返回1,5,7,2行</span></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [[ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#  [20 21 22 23]</span></span><br><span class="line"><span class="comment">#  [28 29 30 31]</span></span><br><span class="line"><span class="comment">#  [ 8  9 10 11]]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ⼀次传⼊多个索引数组返回的是⼀个⼀维数组</span></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>],[<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [ 4 23 29 10]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 花式索引返回数据后,使用[:]获取全部行(第一维数据)</span></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>]]   [:])</span><br><span class="line"><span class="comment"># [[ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#  [20 21 22 23]</span></span><br><span class="line"><span class="comment">#  [28 29 30 31]</span></span><br><span class="line"><span class="comment">#  [ 8  9 10 11]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于arr[[1,5,7,2]],先取全部行,然后取第2列</span></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>]]   [:,<span class="number">1</span>])</span><br><span class="line"><span class="comment"># [ 5 21 29  9]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于arr[[1,5,7,2]],获取0,3,1,2行</span></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>]]   [[<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [[ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#  [ 8  9 10 11]</span></span><br><span class="line"><span class="comment">#  [20 21 22 23]</span></span><br><span class="line"><span class="comment">#  [28 29 30 31]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于arr[[1,5,7,2]],获取全部行,然后取0,3,1,2列</span></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>]]   [:,[<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [[ 4  7  5  6]</span></span><br><span class="line"><span class="comment">#  [20 23 21 22]</span></span><br><span class="line"><span class="comment">#  [28 31 29 30]</span></span><br><span class="line"><span class="comment">#  [ 8 11  9 10]]</span></span><br></pre></td></tr></table></figure>



<hr>
<p>数组转置和轴对换:</p>
<ul>
<li>数组转置:<br>返回源数据的视图（不会进⾏任何复制操作）</li>
<li>轴对换:</li>
</ul>
<p>数组转置和内积:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">15</span>).reshape((<span class="number">3</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[ 0  1  2  3  4]</span></span><br><span class="line"><span class="comment">#  [ 5  6  7  8  9]</span></span><br><span class="line"><span class="comment">#  [10 11 12 13 14]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转置</span></span><br><span class="line"><span class="built_in">print</span>(arr.T)</span><br><span class="line"><span class="comment"># [[ 0  5 10]</span></span><br><span class="line"><span class="comment">#  [ 1  6 11]</span></span><br><span class="line"><span class="comment">#  [ 2  7 12]</span></span><br><span class="line"><span class="comment">#  [ 3  8 13]</span></span><br><span class="line"><span class="comment">#  [ 4  9 14]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.dot(arr.T,arr))</span><br><span class="line"><span class="comment"># [[125 140 155 170 185]</span></span><br><span class="line"><span class="comment">#  [140 158 176 194 212]</span></span><br><span class="line"><span class="comment">#  [155 176 197 218 239]</span></span><br><span class="line"><span class="comment">#  [170 194 218 242 266]</span></span><br><span class="line"><span class="comment">#  [185 212 239 266 293]]</span></span><br></pre></td></tr></table></figure>

<p>内积:<br>结果数组中的每个元素都是：数组a的最后一维上的所有元素与数组b的倒数第二位上的所有元素的乘积和： **dot(a, b)[i,j,k,m] = sum(a[i,j,:] * b[k,:,m])**。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">结果的第一行=arr.T的第一行分别乘以arr的第一列</span><br><span class="line">125 = 0*0 + 5*5 + 10*10</span><br><span class="line">140 = 0*1 + 5*6 + 10*11</span><br><span class="line">155 = 0*2 + 5*7 + 10*12</span><br></pre></td></tr></table></figure>

<p>高维数组的转置需要传递一个由轴编号组成的元组,才能进行转置:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">16</span>).reshape((<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[[ 0  1  2  3]</span></span><br><span class="line"><span class="comment">#   [ 4  5  6  7]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 8  9 10 11]</span></span><br><span class="line"><span class="comment">#   [12 13 14 15]]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr.transpose((<span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>)))</span><br><span class="line"><span class="comment"># [[[ 0  1  2  3]</span></span><br><span class="line"><span class="comment">#   [ 8  9 10 11]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#   [12 13 14 15]]]</span></span><br></pre></td></tr></table></figure>

<p>这⾥，第⼀个轴被换成了第⼆个，第⼆个轴被换成了第⼀个，最后⼀个轴不变。</p>
<p>所谓转置,不过就是进行轴对换而已.所以还有一个swapaxes(交换轴)方法,他需要接受一对轴编号：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">16</span>).reshape((<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[[ 0  1  2  3]</span></span><br><span class="line"><span class="comment">#   [ 4  5  6  7]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 8  9 10 11]</span></span><br><span class="line"><span class="comment">#   [12 13 14 15]]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr.swapaxes(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># [[[ 0  4]</span></span><br><span class="line"><span class="comment">#   [ 1  5]</span></span><br><span class="line"><span class="comment">#   [ 2  6]</span></span><br><span class="line"><span class="comment">#   [ 3  7]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[ 8 12]</span></span><br><span class="line"><span class="comment">#   [ 9 13]</span></span><br><span class="line"><span class="comment">#   [10 14]</span></span><br><span class="line"><span class="comment">#   [11 15]]]</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="4-2-通⽤函数：快速的元素级数组函数"><a href="#4-2-通⽤函数：快速的元素级数组函数" class="headerlink" title="4.2 通⽤函数：快速的元素级数组函数"></a>4.2 通⽤函数：快速的<strong>元素级</strong>数组函数</h2><p>通⽤函数可以将其看做简单函数（接受⼀个或多个标量值，并<br>产⽣⼀个或多个标量值）的⽮量化包装器。</p>
<p>一元ufunc:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [0 1 2 3 4 5 6 7 8 9]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.sqrt(arr))</span><br><span class="line"><span class="comment"># [0.         1.         1.41421356 1.73205081 2.         2.23606798</span></span><br><span class="line"><span class="comment">#  2.44948974 2.64575131 2.82842712 3.        ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以自然常数e为底的指数函数</span></span><br><span class="line"><span class="built_in">print</span>(np.exp(arr))</span><br><span class="line"><span class="comment"># [1.00000000e+00 2.71828183e+00 7.38905610e+00 2.00855369e+01</span></span><br><span class="line"><span class="comment">#  5.45981500e+01 1.48413159e+02 4.03428793e+02 1.09663316e+03</span></span><br><span class="line"><span class="comment">#  2.98095799e+03 8.10308393e+03]</span></span><br></pre></td></tr></table></figure>



<p>二元ufunc:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.random.randn(<span class="number">8</span>)</span><br><span class="line">y = np.random.randn(<span class="number">8</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># [ 0.35022148  0.45710385  1.20352152 -0.82159956 -0.21798144 -0.05278152</span></span><br><span class="line"><span class="comment">#   0.44903238  0.31557328]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="comment"># [ 0.49612057  1.3556842   0.59048793 -0.63601289 -0.59404775 -0.38498382</span></span><br><span class="line"><span class="comment">#  -0.51052469 -0.82994331]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># x和y中元素级别最⼤的元素。</span></span><br><span class="line"><span class="built_in">print</span>(np.maximum(x, y))</span><br><span class="line"><span class="comment"># [ 0.49612057  1.3556842   1.20352152 -0.63601289 -0.21798144 -0.05278152</span></span><br><span class="line"><span class="comment">#   0.44903238  0.31557328]</span></span><br></pre></td></tr></table></figure>



<p>ufunc还可以返回多个数组:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.random.randn(<span class="number">7</span>) * <span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [ 1.43744836  0.22309718 -6.94064709 -0.69602561  4.5460506  -0.17366774</span></span><br><span class="line"><span class="comment">#   3.3419101 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># modf:divmod的⽮量化版本，</span></span><br><span class="line"><span class="comment"># 返回浮点数数组的⼩数和整数部分</span></span><br><span class="line">remainder, whole_part = np.modf(arr)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(remainder)</span><br><span class="line"><span class="comment"># [ 0.43744836  0.22309718 -0.94064709 -0.69602561  0.5460506  -0.17366774</span></span><br><span class="line"><span class="comment">#   0.3419101 ]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(whole_part)</span><br><span class="line"><span class="comment"># [ 1.  0. -6. -0.  4. -0.  3.]</span></span><br></pre></td></tr></table></figure>

<p>Ufuncs接受out选项参数，可以让它们在数组的原地进⾏操作：<br>(提供可选的out参数，并将结果放入给定的输出数组中。 out参数必须是 <code>ndarray</code> 并且具有相同数量的元素。 它可以具有不同的数据类型，在这种情况下将执行转换。)<br>eg:<br>ndarray.argmax([axis, out]) 返回给定轴的最大值索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.random.randn(<span class="number">5</span>) * <span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [-1.51314487  1.56401655  4.05014912 -3.04612416  1.38332197]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用np.sqrt(arr),返回新的数组</span></span><br><span class="line">x = np.sqrt(arr)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># [       nan 1.25060647 2.01249823        nan 1.17614708]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 原数组不变</span></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [-1.51314487  1.56401655  4.05014912 -3.04612416  1.38332197]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将np.sqrt(arr)的结果放入arr中</span></span><br><span class="line">np.sqrt(arr, arr)</span><br><span class="line"><span class="comment"># 原数组改变</span></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [       nan 1.25060647 2.01249823        nan 1.17614708]</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="4-3利⽤数组进⾏数据处理"><a href="#4-3利⽤数组进⾏数据处理" class="headerlink" title="4.3利⽤数组进⾏数据处理"></a>4.3利⽤数组进⾏数据处理</h2><p>⽤数组表达式代替循环的做法，通常被称为⽮量化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">points = np.arange(<span class="number">0</span>, <span class="number">5</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(points)</span><br><span class="line"><span class="comment"># [0 1 2 3 4]</span></span><br><span class="line"></span><br><span class="line">xs, ys = np.meshgrid(points, points)</span><br><span class="line"><span class="built_in">print</span>(ys)</span><br><span class="line"><span class="comment"># [[0 0 0 0 0]</span></span><br><span class="line"><span class="comment">#  [1 1 1 1 1]</span></span><br><span class="line"><span class="comment">#  [2 2 2 2 2]</span></span><br><span class="line"><span class="comment">#  [3 3 3 3 3]</span></span><br><span class="line"><span class="comment">#  [4 4 4 4 4]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(xs)</span><br><span class="line"><span class="comment"># [[0 1 2 3 4]</span></span><br><span class="line"><span class="comment">#  [0 1 2 3 4]</span></span><br><span class="line"><span class="comment">#  [0 1 2 3 4]</span></span><br><span class="line"><span class="comment">#  [0 1 2 3 4]</span></span><br><span class="line"><span class="comment">#  [0 1 2 3 4]]</span></span><br><span class="line"></span><br><span class="line">z = np.sqrt(xs ** <span class="number">2</span> + ys ** <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line"><span class="comment"># [[0.         1.         2.         3.         4.        ]</span></span><br><span class="line"><span class="comment">#  [1.         1.41421356 2.23606798 3.16227766 4.12310563]</span></span><br><span class="line"><span class="comment">#  [2.         2.23606798 2.82842712 3.60555128 4.47213595]</span></span><br><span class="line"><span class="comment">#  [3.         3.16227766 3.60555128 4.24264069 5.        ]</span></span><br><span class="line"><span class="comment">#  [4.         4.12310563 4.47213595 5.         5.65685425]]</span></span><br></pre></td></tr></table></figure>

<p>z矩阵上的每一个元素都是sqrt(x^2^+y^2^)的一个解:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.41421356就是ys=1,xs=1的解</span><br><span class="line">2.23606798就是ys=1,xs=2的解</span><br></pre></td></tr></table></figure>

<p>简单来说,首先使用np.meshgrid来构造一个平面点网格(xs,ys)</p>
<p><img src="/images/20190506171815.png" alt="20190506171815"></p>
<p>这个网格被拆分成:xs和ys.<br>然后对于网格的每个点都执行<code>np.sqrt(xs ** 2 + ys ** 2)</code><br>最后就得到一个解的矩阵</p>
<hr>
<p>将条件逻辑表述为数组运算</p>
<p>numpy.where函数是三元表达式x if condition else y的⽮量化版<br>本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">xarr = np.array([<span class="number">1.1</span>, <span class="number">1.2</span>, <span class="number">1.3</span>, <span class="number">1.4</span>, <span class="number">1.5</span>])</span><br><span class="line">yarr = np.array([<span class="number">2.1</span>, <span class="number">2.2</span>, <span class="number">2.3</span>, <span class="number">2.4</span>, <span class="number">2.5</span>])</span><br><span class="line">cond = np.array([<span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">False</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据cond中的值选取xarr和yarr的值：</span></span><br><span class="line"><span class="comment"># 当cond中的值为True时，选取xarr的值，否则从yarr中选取。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 普通python写法:</span></span><br><span class="line"><span class="comment"># result = [(x if c else y)</span></span><br><span class="line"><span class="comment">#           for x, y, c in zip(xarr, yarr, cond)]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># numpy写法</span></span><br><span class="line">result = np.where(cond, xarr, yarr)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># [1.1 2.2 1.3 1.4 2.5]</span></span><br></pre></td></tr></table></figure>

<p>np.where的第⼆个和第三个参数不必是数组，它们都可以是标量值。<br>np.where通常⽤于根据另⼀个数组⽽产⽣⼀个新的数组。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将矩阵的负值改为0,正值不变</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.random.randn(<span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[-0.78980305  0.52319264 -0.25377278  0.18849952]</span></span><br><span class="line"><span class="comment">#  [ 1.03219533 -1.31224948  0.25765788 -0.13075013]</span></span><br><span class="line"><span class="comment">#  [-0.10867121 -0.02572357  1.55566117 -0.32628939]</span></span><br><span class="line"><span class="comment">#  [ 0.79880395 -0.30460497  0.0056869  -0.83580255]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr &gt; <span class="number">0</span>)</span><br><span class="line"><span class="comment"># [[False  True False  True]</span></span><br><span class="line"><span class="comment">#  [ True False  True False]</span></span><br><span class="line"><span class="comment">#  [False False  True False]</span></span><br><span class="line"><span class="comment">#  [ True False  True False]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.where(arr &gt; <span class="number">0</span>, arr, <span class="number">0</span>))</span><br><span class="line"><span class="comment"># [[0.         0.52319264 0.         0.18849952]</span></span><br><span class="line"><span class="comment">#  [1.03219533 0.         0.25765788 0.        ]</span></span><br><span class="line"><span class="comment">#  [0.         0.         1.55566117 0.        ]</span></span><br><span class="line"><span class="comment">#  [0.79880395 0.         0.0056869  0.        ]]</span></span><br></pre></td></tr></table></figure>



<hr>
<p>数学和统计⽅法</p>
<p>mean和sum这类的函数可以接受⼀个axis(轴)选项参数，⽤于计算该轴向上的统计值，最终结果是⼀个少⼀维的数组：</p>
<ul>
<li>axis： 不设置值，对全部元素操作</li>
<li>axis = 0：压缩行，对各列求值，返回 1* n 矩阵</li>
<li>axis =1 ：压缩列，对各行求值，返回 m *1 矩阵</li>
</ul>
<p>(二维数组就两个轴,所以axis=0/1,三维数组的axis可以等于2,四维数组同理,最高为3)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">18</span>).reshape((<span class="number">6</span>,<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[ 0  1  2]</span></span><br><span class="line"><span class="comment">#  [ 3  4  5]</span></span><br><span class="line"><span class="comment">#  [ 6  7  8]</span></span><br><span class="line"><span class="comment">#  [ 9 10 11]</span></span><br><span class="line"><span class="comment">#  [12 13 14]</span></span><br><span class="line"><span class="comment">#  [15 16 17]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取均值</span></span><br><span class="line"><span class="built_in">print</span>(arr.mean())   <span class="comment"># 8.5</span></span><br><span class="line"><span class="comment"># np.mean(arr)等同于arr.mean()</span></span><br><span class="line"><span class="built_in">print</span>(np.mean(arr))  <span class="comment"># 8.5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr.<span class="built_in">sum</span>())       <span class="comment"># 153</span></span><br><span class="line"><span class="built_in">print</span>(arr.<span class="built_in">sum</span>(axis=<span class="number">1</span>)) <span class="comment"># [ 3 12 21 30 39]</span></span><br><span class="line"><span class="built_in">print</span>(arr.<span class="built_in">sum</span>(axis=<span class="number">0</span>)) <span class="comment"># [45 51 57]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr.mean(axis=<span class="number">1</span>))  <span class="comment"># [ 1.  4.  7. 10. 13. 16.]</span></span><br><span class="line"><span class="built_in">print</span>(arr.mean(axis=<span class="number">0</span>))  <span class="comment"># [7.5 8.5 9.5]</span></span><br></pre></td></tr></table></figure>



<p>理解什么是<code>axis(轴)</code>:</p>
<p>轴即维度,轴的个数被称作rank<br>(这里的rank不是线性代数中的rank（秩），它指代的依旧是维数（number of dimensions))</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">123</span>)</span><br><span class="line">X = np.random.randint(<span class="number">0</span>, <span class="number">5</span>, [<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(X.shape)  <span class="comment"># [3, 2, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line"><span class="comment"># [[[5 2]</span></span><br><span class="line"><span class="comment">#   [4 2]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[1 3]</span></span><br><span class="line"><span class="comment">#   [2 3]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[1 1]</span></span><br><span class="line"><span class="comment">#   [0 1]]]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7=5+1+1</span></span><br><span class="line"><span class="comment"># 6=2+3+1</span></span><br><span class="line"><span class="built_in">print</span>(X.<span class="built_in">sum</span>(axis=<span class="number">0</span>))</span><br><span class="line"><span class="comment"># [[7, 6],</span></span><br><span class="line"><span class="comment">#  [6, 6]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 9=5+4</span></span><br><span class="line"><span class="comment"># 4=2+2</span></span><br><span class="line"><span class="built_in">print</span>(X.<span class="built_in">sum</span>(axis=<span class="number">1</span>))</span><br><span class="line"><span class="comment"># [[9, 4],</span></span><br><span class="line"><span class="comment">#  [3, 6],</span></span><br><span class="line"><span class="comment">#  [1, 2]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7=5+2</span></span><br><span class="line"><span class="comment"># 6=4+2</span></span><br><span class="line"><span class="built_in">print</span>(X.<span class="built_in">sum</span>(axis=<span class="number">2</span>))</span><br><span class="line"><span class="comment"># [[7, 6],</span></span><br><span class="line"><span class="comment">#  [4, 5],</span></span><br><span class="line"><span class="comment">#  [2, 1]]</span></span><br></pre></td></tr></table></figure>

<p>这里的X.shape为[3, 2, 2],每一个元素就对应一个轴:</p>
<ul>
<li>axis=0对应3</li>
<li>axis=1对应2</li>
<li>axis=2对应2</li>
</ul>
<p><img src="/images/v2-862f5d097a173cff5b3a0664b4745e94_hd.png" alt="img"></p>
<p><strong>对于多维数组，numpy对轴的编号是先行后列，由外向内！</strong></p>
<p>所以:<code>X.sum(axis=0)</code>就是把第一个轴压缩掉.<br>简单来说,就是==把第一个轴同类的元素全部聚合成一个==</p>
<p>什么是<code>第一个轴同类的元素</code>?<br>就是==在同一个中括号里面的元素==</p>
<hr>
<p>累加cumsum/累积cumprod:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]])</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[0 1 2]</span></span><br><span class="line"><span class="comment">#  [3 4 5]</span></span><br><span class="line"><span class="comment">#  [6 7 8]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr.cumsum(axis=<span class="number">0</span>))</span><br><span class="line"><span class="comment"># [[ 0  1  2]</span></span><br><span class="line"><span class="comment">#  [ 3  5  7]</span></span><br><span class="line"><span class="comment">#  [ 9 12 15]]</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(arr.cumprod(axis=<span class="number">1</span>))</span><br><span class="line"><span class="comment"># [[  0   0   0]</span></span><br><span class="line"><span class="comment">#  [  3  12  60]</span></span><br><span class="line"><span class="comment">#  [  6  42 336]]</span></span><br></pre></td></tr></table></figure>

<p>⽤于布尔型数组的⽅法:<br>在运算中,布尔值会被强制转换为1和0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.random.randn(<span class="number">100</span>)</span><br><span class="line"><span class="comment"># Number of positive values</span></span><br><span class="line"><span class="built_in">print</span>((arr &gt; <span class="number">0</span>).<span class="built_in">sum</span>())  <span class="comment"># 49</span></span><br></pre></td></tr></table></figure>

<p>any和all方法:<br>和python的any和all方法功能一样:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">bools = np.array([<span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(bools.<span class="built_in">any</span>())  <span class="comment"># True</span></span><br><span class="line"><span class="built_in">print</span>(bools.<span class="built_in">all</span>())  <span class="comment"># False</span></span><br></pre></td></tr></table></figure>

<p>这两个⽅法也能⽤于⾮布尔型数组，所有⾮0元素将会被当做True。</p>
<hr>
<p>排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sort()的参数axis默认为-1</span></span><br><span class="line"><span class="comment"># 即对最大轴进行排序</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.random.randn(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[-0.1670582  -0.69387437  0.23216131]</span></span><br><span class="line"><span class="comment">#  [-0.7415621  -0.95199615  0.21348631]</span></span><br><span class="line"><span class="comment">#  [-0.62017205 -0.73696748 -1.43722725]</span></span><br><span class="line"><span class="comment">#  [ 1.16732207 -1.86634413  0.31744036]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 和list的sort一样,无返回值(axis默认为-1)</span></span><br><span class="line"><span class="built_in">print</span>(arr.sort())</span><br><span class="line"><span class="comment"># None</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[-0.69387437 -0.1670582   0.23216131]</span></span><br><span class="line"><span class="comment">#  [-0.95199615 -0.7415621   0.21348631]</span></span><br><span class="line"><span class="comment">#  [-1.43722725 -0.73696748 -0.62017205]</span></span><br><span class="line"><span class="comment">#  [-1.86634413  0.31744036  1.16732207]]</span></span><br></pre></td></tr></table></figure>

<p>将轴编号传给sort(),多维数组就可以在任何⼀个轴向上进⾏排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.array([[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]],</span><br><span class="line"></span><br><span class="line">                [[<span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>],</span><br><span class="line">                 [<span class="number">8</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>]],</span><br><span class="line"></span><br><span class="line">                [[<span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">3</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>]]])</span><br><span class="line"></span><br><span class="line">arr.sort(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[[1 2 3 3]</span></span><br><span class="line"><span class="comment">#   [1 3 3 5]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[2 4 7 4]</span></span><br><span class="line"><span class="comment">#   [1 4 3 5]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[2 5 7 5]</span></span><br><span class="line"><span class="comment">#   [8 5 4 7]]]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.array([[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]],</span><br><span class="line"></span><br><span class="line">                [[<span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>],</span><br><span class="line">                 [<span class="number">8</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>]],</span><br><span class="line"></span><br><span class="line">                [[<span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">3</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>]]])</span><br><span class="line"></span><br><span class="line">arr.sort(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[[1 2 3 4]</span></span><br><span class="line"><span class="comment">#   [1 3 4 5]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[2 4 3 5]</span></span><br><span class="line"><span class="comment">#   [8 4 7 5]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[1 5 3 3]</span></span><br><span class="line"><span class="comment">#   [2 5 7 7]]]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.array([[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]],</span><br><span class="line"></span><br><span class="line">                [[<span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>],</span><br><span class="line">                 [<span class="number">8</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>]],</span><br><span class="line"></span><br><span class="line">                [[<span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">3</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>]]])</span><br><span class="line"></span><br><span class="line">arr.sort(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[[1 2 3 4]</span></span><br><span class="line"><span class="comment">#   [1 3 4 5]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[2 4 5 7]</span></span><br><span class="line"><span class="comment">#   [3 4 5 8]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  [[2 3 5 7]</span></span><br><span class="line"><span class="comment">#   [1 3 5 7]]]</span></span><br></pre></td></tr></table></figure>

<p>上面是对三个轴的排序,解析如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[[[1, 2, 3, 4],</span><br><span class="line">  [1, 3, 4, 5]],</span><br><span class="line"></span><br><span class="line"> [[2, 4, 7, 5],</span><br><span class="line">  [8, 4, 3, 5]],</span><br><span class="line"></span><br><span class="line"> [[2, 5, 7, 3],</span><br><span class="line">  [1, 5, 3, 7]]]</span><br></pre></td></tr></table></figure>

<ol>
<li><p>第一个轴有三个元素:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> [[1, 2, 3, 4],</span><br><span class="line">  [1, 3, 4, 5],</span><br><span class="line">和</span><br><span class="line"> [[2, 4, 7, 5],</span><br><span class="line">  [8, 4, 3, 5]],</span><br><span class="line">和</span><br><span class="line"> [[2, 5, 7, 3],</span><br><span class="line">  [1, 5, 3, 7]]</span><br></pre></td></tr></table></figure>

<p>那么这三个元素要排序</p>
</li>
<li><p>所以就是将(1,2,2),(2,4,5),(3,7,7),(3,4,3),(1,8,1),(3,4,5),(4,3,3),(5,5,7)共8组排好.</p>
</li>
<li><p>所以这八组就是(1,2,2),(2,4,5),(3,7,7),(3,3,5),(1,1,8),(3,4,5),(3,3,4),(5,5,7)</p>
</li>
<li><p>对应的矩阵就是:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[[[1 2 3 3]</span><br><span class="line">  [1 3 3 5]]</span><br><span class="line"></span><br><span class="line"> [[2 4 7 4]</span><br><span class="line">  [1 4 3 5]]</span><br><span class="line"></span><br><span class="line"> [[2 5 7 5]</span><br><span class="line">  [8 5 4 7]]]</span><br></pre></td></tr></table></figure></li>
</ol>
<p>总结:<br>对于轴的问题,紧抓两个概念:</p>
<ul>
<li>同类元素</li>
<li>==多个同类元素最终要变成一个元素==</li>
</ul>
<hr>
<p>唯⼀化以及其它的集合逻辑</p>
<p>unique:python里的set的多维数组版</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 唯一化</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">names = np.array([<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(np.unique(names))</span><br><span class="line"><span class="comment"># [&#x27;Bob&#x27; &#x27;Joe&#x27; &#x27;Will&#x27;]</span></span><br><span class="line"></span><br><span class="line">ints = np.array([<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(np.unique(ints))</span><br><span class="line"><span class="comment"># [1 2 3 4]</span></span><br></pre></td></tr></table></figure>

<p>in1d:python里的in的多维数组版</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">values = np.array([<span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"><span class="built_in">print</span>(np.in1d(values, [<span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>]))</span><br><span class="line"><span class="comment"># [ True False False  True  True False  True]</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="4-4⽤于数组的⽂件输⼊输出"><a href="#4-4⽤于数组的⽂件输⼊输出" class="headerlink" title="4.4⽤于数组的⽂件输⼊输出"></a>4.4⽤于数组的⽂件输⼊输出</h2><p>NumPy能够读写磁盘上的⽂本数据或⼆进制数据。</p>
<p>np.save和np.load是读写磁盘数组数据的两个主要函数。<br>默认情况下，数组是以未压缩的原始⼆进制格式保存在扩展名为.npy的⽂件中的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 写入</span></span><br><span class="line"><span class="comment"># 如果⽂件路径末尾没有扩展名.npy</span></span><br><span class="line">np.save(<span class="string">&#x27;some_array&#x27;</span>, arr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取</span></span><br><span class="line">arr = np.load(<span class="string">&#x27;some_array.npy&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br></pre></td></tr></table></figure>

<p>numpy支持将多个数组存储到同一文件中,使用关键字参数标志不同数组:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr1 = np.arange(<span class="number">20</span>).reshape((<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">arr2 = np.arange(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将多个数组存储到同一文件中</span></span><br><span class="line"><span class="comment"># 使用关键字参数标志不同数组</span></span><br><span class="line">np.savez(<span class="string">&#x27;array_archive.npz&#x27;</span>, a=arr1, b=arr2)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># arch类似于一个字典</span></span><br><span class="line"><span class="comment"># 对各个数组进行延迟加载</span></span><br><span class="line">arch = np.load(<span class="string">&#x27;array_archive.npz&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arch[<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(arch[<span class="string">&#x27;b&#x27;</span>])</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="4-5线性代数"><a href="#4-5线性代数" class="headerlink" title="4.5线性代数"></a>4.5线性代数</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 前面说过的矩阵内积</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.array([[<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>], [<span class="number">4.</span>, <span class="number">5.</span>, <span class="number">6.</span>]])</span><br><span class="line">y = np.array([[<span class="number">6.</span>, <span class="number">23.</span>], [-<span class="number">1</span>, <span class="number">7</span>], [<span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># [[1. 2. 3.]</span></span><br><span class="line"><span class="comment">#  [4. 5. 6.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="comment"># [[ 6. 23.]</span></span><br><span class="line"><span class="comment">#  [-1.  7.]</span></span><br><span class="line"><span class="comment">#  [ 8.  9.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.dot(y))</span><br><span class="line"><span class="comment"># [[ 28.  64.]</span></span><br><span class="line"><span class="comment">#  [ 67. 181.]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># x.dot(y)等价于</span></span><br><span class="line"><span class="built_in">print</span>(np.dot(x,y))</span><br><span class="line"><span class="comment"># [[ 28.  64.]</span></span><br><span class="line"><span class="comment">#  [ 67. 181.]]</span></span><br></pre></td></tr></table></figure>

<p>@符:<br>进⾏矩阵乘法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.array([[<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>], [<span class="number">4.</span>, <span class="number">5.</span>, <span class="number">6.</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x @ np.ones(<span class="number">3</span>))</span><br><span class="line"><span class="comment"># [ 6. 15.]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> numpy.linalg <span class="keyword">import</span> inv, qr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">X = np.random.randn(<span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># X和它的转置X.T的点积</span></span><br><span class="line">mat = X.T.dot(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># inv:方阵的逆</span></span><br><span class="line"><span class="built_in">print</span>(inv(mat))</span><br><span class="line"><span class="comment"># [[ 4.53196293 -1.22236952 -2.6589505 ]</span></span><br><span class="line"><span class="comment">#  [-1.22236952  0.98196249  0.52036233]</span></span><br><span class="line"><span class="comment">#  [-2.6589505   0.52036233  2.19274825]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(mat.dot(inv(mat)))</span><br><span class="line"><span class="comment"># [[1.00000000e+00 6.61023090e-17 2.25066451e-16]</span></span><br><span class="line"><span class="comment">#  [3.71522059e-16 1.00000000e+00 4.00154639e-16]</span></span><br><span class="line"><span class="comment">#  [1.85802669e-15 7.98912193e-17 1.00000000e+00]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># QR分解</span></span><br><span class="line">q, r = qr(mat)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="comment"># [[-1.7824303  -1.5471616  -2.09238743]</span></span><br><span class="line"><span class="comment">#  [ 0.         -1.15383991  0.46558606]</span></span><br><span class="line"><span class="comment">#  [ 0.          0.          0.28690018]]</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="4-6伪随机数⽣成"><a href="#4-6伪随机数⽣成" class="headerlink" title="4.6伪随机数⽣成"></a>4.6伪随机数⽣成</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># normal:得到⼀个标准正态分布数组</span></span><br><span class="line">arr = np.random.normal(size=(<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[ 0.01038301  1.22216728 -0.77523556]</span></span><br><span class="line"><span class="comment">#  [-1.56709083 -0.07124537 -0.73354664]]</span></span><br></pre></td></tr></table></figure>

<p>numpy的伪随机数一样是使用随机种子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">1234</span>)</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="4-7随机漫步"><a href="#4-7随机漫步" class="headerlink" title="4.7随机漫步:"></a>4.7随机漫步:</h2><p>python实现:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">position = <span class="number">0</span></span><br><span class="line">walk = [position]</span><br><span class="line">steps = <span class="number">1000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(steps):</span><br><span class="line">    step = <span class="number">1</span> <span class="keyword">if</span> random.randint(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">    position += step</span><br><span class="line">    walk.append(position)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(walk)</span><br></pre></td></tr></table></figure>

<p>numpy实现:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">nsteps = <span class="number">1000</span></span><br><span class="line">draws = np.random.randint(<span class="number">0</span>, <span class="number">2</span>, size=nsteps)</span><br><span class="line">steps = np.where(draws &gt; <span class="number">0</span>, <span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line">walk = steps.cumsum()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(walk)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求最小最大值</span></span><br><span class="line"><span class="built_in">print</span>(walk.<span class="built_in">min</span>())</span><br><span class="line"><span class="built_in">print</span>(walk.<span class="built_in">max</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求要几次随机漫步才能距离0点10步远</span></span><br><span class="line"><span class="comment"># argmax返回的是该布尔型数组第⼀个最⼤值的索引（True就是最⼤值）</span></span><br><span class="line"><span class="built_in">print</span>((np.<span class="built_in">abs</span>(walk) &gt;= <span class="number">10</span>).argmax())</span><br></pre></td></tr></table></figure>

<p>产生多个随机漫步过程:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nwalks = <span class="number">5000</span></span><br><span class="line">nsteps = <span class="number">1000</span></span><br><span class="line"><span class="comment"># 只要给numpy.random的函数传⼊⼀个⼆元元组就可以产⽣⼀个⼆维数组，</span></span><br><span class="line"><span class="comment"># 然后我们就可以⼀次性计算5000个随机漫步过程</span></span><br><span class="line">draws = np.random.randint(<span class="number">0</span>, <span class="number">2</span>, size=(nwalks, nsteps))</span><br><span class="line">steps = np.where(draws &gt; <span class="number">0</span>, <span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line"><span class="comment"># axis =1 ：压缩列，对各行求值</span></span><br><span class="line">walks = steps.cumsum(axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(walks)</span><br><span class="line"><span class="comment"># [[  1   2   3 ...   0  -1  -2]</span></span><br><span class="line"><span class="comment">#  [  1   0  -1 ...  54  53  54]</span></span><br><span class="line"><span class="comment">#  [ -1   0   1 ...  10   9  10]</span></span><br><span class="line"><span class="comment">#  ...</span></span><br><span class="line"><span class="comment">#  [ -1   0  -1 ... -22 -23 -22]</span></span><br><span class="line"><span class="comment">#  [ -1   0   1 ...  46  47  46]</span></span><br><span class="line"><span class="comment">#  [  1   2   3 ... -16 -17 -18]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算所有随机漫步过程的最⼤值和最⼩值：</span></span><br><span class="line"><span class="built_in">print</span>(walks.<span class="built_in">max</span>())</span><br><span class="line"><span class="built_in">print</span>(walks.<span class="built_in">min</span>())</span><br></pre></td></tr></table></figure>

<p>计算30或－30的最⼩穿越时间。这⾥稍微复杂些，因为不是5000个过程都到达了30。我们可以⽤any⽅法来对此进⾏检查：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每个随机漫步是否抵达30</span></span><br><span class="line">hits30 = (np.<span class="built_in">abs</span>(walks) &gt;= <span class="number">30</span>).<span class="built_in">any</span>(axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(hits30)</span><br><span class="line"><span class="comment"># [False  True  True ... False  True  True]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 达到30或-30的随机漫步过程的数量(总共5000)</span></span><br><span class="line"><span class="built_in">print</span>(hits30.<span class="built_in">sum</span>())  <span class="comment"># 3434</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cleanned_walks:所有到达30的随机漫步的完整数据</span></span><br><span class="line"><span class="comment"># 比起walks,cleanned_walks去除了未到达30的数据,并且将负数改为正数</span></span><br><span class="line">cleanned_walks = np.<span class="built_in">abs</span>(walks[hits30])</span><br><span class="line"><span class="built_in">print</span>(cleanned_walks)</span><br><span class="line"></span><br><span class="line"><span class="comment"># y:cleanned_walks每个元素都和30比较,</span></span><br><span class="line"><span class="comment"># 得到的第一个True就是第一次达到30的元素</span></span><br><span class="line">y = (cleanned_walks &gt;= <span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="comment"># [[False False False ... False False False]</span></span><br><span class="line"><span class="comment">#  [False False False ... False False False]</span></span><br><span class="line"><span class="comment">#  [False False False ... False False False]</span></span><br><span class="line"><span class="comment">#  ...</span></span><br><span class="line"><span class="comment">#  [False False False ...  True  True  True]</span></span><br><span class="line"><span class="comment">#  [False False False ...  True  True  True]</span></span><br><span class="line"><span class="comment">#  [False False False ... False False False]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># crossing_times:每个随机漫步过程的第一次到达30的索引</span></span><br><span class="line">crossing_times = y.argmax(axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(crossing_times)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全部随机漫步第一次到达30的索引 的平均值</span></span><br><span class="line"><span class="built_in">print</span>(crossing_times.mean())</span><br><span class="line"><span class="comment"># 495.9609770628537</span></span><br></pre></td></tr></table></figure>

<p>所以,完整的代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nwalks = <span class="number">5000</span></span><br><span class="line">nsteps = <span class="number">1000</span></span><br><span class="line"><span class="comment"># 只要给numpy.random的函数传⼊⼀个⼆元元组就可以产⽣⼀个⼆维数组，</span></span><br><span class="line"><span class="comment"># 然后我们就可以⼀次性计算5000个随机漫步过程</span></span><br><span class="line">draws = np.random.randint(<span class="number">0</span>, <span class="number">2</span>, size=(nwalks, nsteps))</span><br><span class="line">steps = np.where(draws &gt; <span class="number">0</span>, <span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line"><span class="comment"># walks:所有随机漫步的完整原始数据</span></span><br><span class="line">walks = steps.cumsum(axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hits30:每个随机漫步是否抵达30</span></span><br><span class="line">hits30 = (np.<span class="built_in">abs</span>(walks) &gt;= <span class="number">30</span>).<span class="built_in">any</span>(axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(hits30)</span><br><span class="line"><span class="comment"># [False  True  True ... False  True  True]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 达到30或-30的随机漫步过程的数量(总共5000)</span></span><br><span class="line"><span class="built_in">print</span>(hits30.<span class="built_in">sum</span>())  <span class="comment"># 3434</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># cleanned_walks:所有到达30的随机漫步的完整数据</span></span><br><span class="line"><span class="comment"># 比起walks,cleanned_walks去除了未到达30的数据,并且将负数改为正数</span></span><br><span class="line">cleanned_walks = np.<span class="built_in">abs</span>(walks[hits30])</span><br><span class="line"><span class="built_in">print</span>(cleanned_walks)</span><br><span class="line"></span><br><span class="line"><span class="comment"># y:cleanned_walks每个元素都和30比较,</span></span><br><span class="line"><span class="comment"># 得到的第一个True就是第一次达到30的元素</span></span><br><span class="line">y = (cleanned_walks &gt;= <span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="comment"># [[False False False ... False False False]</span></span><br><span class="line"><span class="comment">#  [False False False ... False False False]</span></span><br><span class="line"><span class="comment">#  [False False False ... False False False]</span></span><br><span class="line"><span class="comment">#  ...</span></span><br><span class="line"><span class="comment">#  [False False False ...  True  True  True]</span></span><br><span class="line"><span class="comment">#  [False False False ...  True  True  True]</span></span><br><span class="line"><span class="comment">#  [False False False ... False False False]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># crossing_times:每个随机漫步过程的第一次到达30的索引</span></span><br><span class="line">crossing_times = y.argmax(axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(crossing_times)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全部随机漫步第一次到达30的索引 的平均值</span></span><br><span class="line"><span class="built_in">print</span>(crossing_times.mean())</span><br><span class="line"><span class="comment"># 495.9609770628537</span></span><br></pre></td></tr></table></figure>

</div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>