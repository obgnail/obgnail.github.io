<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="MVC:一种设计模式.就是把代码解耦,分割成很多部件"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>千锋教育1_全部流程与模型 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Django/" rel="tag">Django</a></div><div class="post-time">2021-08-29</div></div></div><div class="container post-header"><h1>千锋教育1_全部流程与模型</h1></div><div class="container post-content"><p>MVC:一种设计模式.就是把代码解耦,分割成很多部件</p>
<ol>
<li>M:模型(model):是应用程序中用于处理应用程序数据逻辑的部分.<br>通常模型对象负责在数据库中存取数据</li>
<li>V:视图(View):是应用程序中处理数据显示的部分.<br>通常视图是依据模型数据创建的.</li>
<li>C:控制器(Controller):是应用程序中处理用户交互的部分.<br>通常控制器负责从视图读取数据,控制用户输入,并向模型发生数据</li>
</ol>
<p><img src="/images/1555162736965.png" alt="1555162736965"></p>
<p>示例:<br>用户(就是上面的电脑)发送一个HTTP请求给服务器,背后的逻辑是:</p>
<ol>
<li>控制器接受用户的request</li>
<li>控制器让model去数据库里拿数据,然后将数据发给控制器.</li>
<li>然后控制器将拿到的数据发送给视图.</li>
<li>最后视图将拿到的数据显示给用户</li>
</ol>
<p>Django将MVC模式修改成MTV模式:</p>
<ol>
<li>Model:模型:负责业务对象与数据库对象(ORM)<br>和MVC的Model差不多,还是负责管理数据的.</li>
<li>Template:模板:负责如何把页面展示给用户.<br>相当于MVC的View,负责展示页面</li>
<li>View:视图:负责业务逻辑,并在适当的时候调用Model和Template.<br>相当于MVC的Controller</li>
</ol>
<p>注意:Django还有一个url分发器,作用是将一个个的url页面请求分发给不同的view处理,view再调用相应的Model和VTemplate</p>
<p><img src="/images/bcff7751-20171215145650232.png" alt="20171215145650232"></p>
<p>示例:<br>用户发送一个request请求</p>
<ol>
<li>url分发器根据url将不同的请求分给不同的view.</li>
<li>view告诉模型将数据库的数据拿出来给View</li>
<li>view再将从模型拿到的数据给模板,让模板展示给用户.</li>
</ol>
<hr>
<p>项目说明:</p>
<ol>
<li>manage.py:一个命令行工具,可以使我们使用多种方式对Django项目进行交互</li>
<li>_<em>init</em>_.py:空文件,他告诉python这个目录应该被看作一个python包</li>
<li>setting.py:项目的配置文件</li>
<li>urls.py:项目的url声明(就是url分发器)</li>
<li>wsgi.py:项目与wsgi兼容的web服务器入口.</li>
</ol>
<hr>
<p>基本操作:</p>
<ol>
<li><p>设计表结构</p>
</li>
<li><p>配置数据库:<br>因为Django默认数据为SQLite,我们可以将其修改为MySQL.在setting.py的DATABASES选项配置:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment">#  使用的数据库类型</span></span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.sqlite3&#x27;</span>,</span><br><span class="line">        <span class="comment"># 使用数据库的名</span></span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: os.path.join(BASE_DIR, <span class="string">&#x27;db.sqlite3&#x27;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>修改步骤如下:</p>
<ol>
<li><p>在_<em>init</em>_.py写入:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure></li>
<li><p>首先在MySQL里创建一个数据库:(数据库名自选)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database djangoDB;</span><br></pre></td></tr></table></figure></li>
<li><p>将setting.py的DATABASES选项配置改为:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&#x27;djangoDB&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;USER&#x27;</span>:<span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;PASSWORD&#x27;</span>:<span class="string">&#x27;5KVp2y7,k96o&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;HOST&#x27;</span>:<span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;POST&#x27;</span>:<span class="string">&#x27;3306&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>创建应用:<br>在一个项目中可以创建多种应用.每个应用运行一种业务处理.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 注意在manage.py中运行</span><br><span class="line">python manage.py startapp myapp</span><br></pre></td></tr></table></figure>

<p>admin.py:站点配置</p>
<p>models.py:模型:<br>view.py:视图</p>
</li>
</ol>
<p>   注意在创建应用之后需要激活应用:</p>
<p>   在setting.py中,将myapp应用加入到installed_apps中</p>
<ol start="4">
<li><p>定义模型:<br>模型其实就是一个类.这个类继承model.Model</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grades</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">	gname = models.CharField(max_length=<span class="number">20</span>)</span><br><span class="line">	gdate = models.DateTimeField()</span><br><span class="line">	ggirlnum = models.IntegerField()</span><br><span class="line">	gboynum = models.IntegerField()</span><br><span class="line">	isDelete = models.BooleanField()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;gname&#125;</span>-<span class="subst">&#123;gdate&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">	sname =models.CharField(max_length=<span class="number">20</span>)</span><br><span class="line">	sgender = models.BooleanField(default=<span class="literal">True</span>)</span><br><span class="line">	sage = models.IntegerField()</span><br><span class="line">	scontend = models.CharField(max_length=<span class="number">20</span>)</span><br><span class="line">	<span class="comment"># 定义外键</span></span><br><span class="line">	sgreade = models.ForeignKey(<span class="string">&#x27;Grades&#x27;</span>)</span><br><span class="line">	isDelete = models.BooleanField(default=<span class="literal">False</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;sname&#125;</span>-<span class="subst">&#123;sdate&#125;</span>&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li><p>在数据库中生成数据表:</p>
<ol>
<li><p>生成迁移文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br></pre></td></tr></table></figure>

<p>这时就会在migrations目录下生成迁移文件.<br>(此时数据库中还没有生成数据表)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 在数据库中键入</span><br><span class="line">show tables;</span><br><span class="line">/*</span><br><span class="line">+--------------------+</span><br><span class="line">| Tables_in_djangodb |</span><br><span class="line">+--------------------+</span><br><span class="line">| django_migrations  |</span><br><span class="line">+--------------------+</span><br><span class="line">*/</span><br></pre></td></tr></table></figure></li>
<li><p>执行迁移</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 在数据库中键入</span><br><span class="line">show tables;</span><br><span class="line">/*</span><br><span class="line">+----------------------------+</span><br><span class="line">| Tables_in_djangodb         |</span><br><span class="line">+----------------------------+</span><br><span class="line">| auth_group                 |</span><br><span class="line">| auth_group_permissions     |</span><br><span class="line">| auth_permission            |</span><br><span class="line">| auth_user                  |</span><br><span class="line">| auth_user_groups           |</span><br><span class="line">| auth_user_user_permissions |</span><br><span class="line">| django_admin_log           |</span><br><span class="line">| django_content_type        |</span><br><span class="line">| django_migrations          |</span><br><span class="line">| django_session             |</span><br><span class="line">| myapp_grades               |</span><br><span class="line">| myapp_students             |</span><br><span class="line">+----------------------------+</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">desc myapp_grades;</span><br><span class="line">/*</span><br><span class="line">+----------+-------------+------+-----+---------+----------------+</span><br><span class="line">| Field    | Type        | Null | Key | Default | Extra          |</span><br><span class="line">+----------+-------------+------+-----+---------+----------------+</span><br><span class="line">| id       | int(11)     | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| gname    | varchar(20) | NO   |     | NULL    |                |</span><br><span class="line">| gdate    | datetime(6) | NO   |     | NULL    |                |</span><br><span class="line">| ggirlnum | int(11)     | NO   |     | NULL    |                |</span><br><span class="line">| gboynum  | int(11)     | NO   |     | NULL    |                |</span><br><span class="line">| isDelete | tinyint(1)  | NO   |     | NULL    |                |</span><br><span class="line">+----------+-------------+------+-----+---------+----------------+</span><br><span class="line">*/</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>数据操作:</p>
<ol>
<li><p>进入到python shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py shell</span><br></pre></td></tr></table></figure></li>
<li><p>引入包:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> myapp.models <span class="keyword">import</span> Grades,Students</span><br><span class="line"><span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> *</span><br></pre></td></tr></table></figure></li>
<li><p>查询所有数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Grades.objects.<span class="built_in">all</span>()</span><br><span class="line"><span class="comment"># &lt;QuerySet []&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>添加数据:<br>本质:创建一个模型类的对象实例.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">grade = Grades()</span><br><span class="line">grade.gdate =datetime(year=<span class="number">2017</span>,month=<span class="number">7</span>,day = <span class="number">7</span>)</span><br><span class="line">grade.gname = <span class="string">&#x27;hyl&#x27;</span></span><br><span class="line">grade.ggirlnum = <span class="number">3</span></span><br><span class="line">grade.gboynum = <span class="number">70</span></span><br><span class="line">grade.isDelete = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">grade.save()</span><br></pre></td></tr></table></figure></li>
<li><p>查询某个对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Grades.objects.get(<span class="built_in">id</span>=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># &lt;Grades: Grades object&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改数据:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = Grades.objects.get(<span class="built_in">id</span>=<span class="number">1</span>)</span><br><span class="line">x.gname = <span class="string">&#x27;hyl&#x27;</span></span><br><span class="line">x.save()</span><br></pre></td></tr></table></figure></li>
<li><p>删除数据:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Grades.objects.get(<span class="built_in">id</span>=<span class="number">1</span>).delete()</span><br></pre></td></tr></table></figure></li>
<li><p>连接关联对象:<br>使用模式创建外键的方式:<strong>把另一个表的实例对象作为这个表实例对象的属性</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s1 = Students()</span><br><span class="line">g1 = Grades()</span><br><span class="line"><span class="comment"># 把另一个表的实例对象作为这个表实例对象的属性</span></span><br><span class="line">s1.sgreade = g1</span><br></pre></td></tr></table></figure></li>
<li><p>获取关联对象:<br>属性:<strong>关联的类名(小写)_set</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一对多,一实体具有一个自带的属性</span></span><br><span class="line"><span class="comment"># 这个属性名为:多实体表名_set</span></span><br><span class="line">g1 = Grades()</span><br><span class="line">g1.students_set.<span class="built_in">all</span>()</span><br></pre></td></tr></table></figure></li>
<li><p>便捷的添加表数据的方式:<br>关联的类名(小写)_set.create</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用班级表的实例对象来创建学生数据</span></span><br><span class="line">g1.students_set.create(sname=<span class="string">&#x27;hyl&#x27;</span>,sgender=<span class="literal">True</span>,scontend=<span class="string">&#x27;my name is hyl&#x27;</span>,sage=<span class="number">45</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>启动服务器:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver ip:port</span><br></pre></td></tr></table></figure>

<p>ip可以不写,不写的话代码本机IP,端口号默认8000</p>
<p>说明:这是一个纯python写的轻量级web服务器,仅仅在开发测试中使用</p>
</li>
<li><p>Admin站点管理:</p>
<ol>
<li><p>概述:</p>
<ol>
<li>内容发布:负责添加,修改,删除内容.<br>(这是真正意义就修改数据库中数据,只是提供一个可视化界面而已)</li>
<li>公告访问</li>
</ol>
</li>
<li><p>配置Admin应用:<br>admin其实本身就是一个应用.要使用这个应用就需要在setting.py中配置.(当然默认已经配置好了)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment"># 默认配置好了</span></span><br><span class="line">    <span class="string">&#x27;django.contrib.admin&#x27;</span>,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><p>创建管理员用户:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br></pre></td></tr></table></figure>

<p>然后进入127.0.0.1:8000/admin即可</p>
</li>
<li><p>汉化:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LANGUAGE_CODE = &#x27;zh-hans&#x27;</span><br><span class="line">TIME_ZONE = &#x27;Asia/shanghai&#x27;</span><br></pre></td></tr></table></figure></li>
<li><p>管理数据表:<br><strong>修改admin文件</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># myapp/admin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先导入</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Grades,Students</span><br><span class="line"><span class="comment"># 后注册</span></span><br><span class="line">admin.site.register(Grades)</span><br><span class="line">admin.site.register(Students)</span><br></pre></td></tr></table></figure>

<p><img src="/images/1555206902506.png" alt="1555206902506"></p>
</li>
<li><p>自定义管理页面<br>使用管理页面类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Register your models here.</span></span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先导入表格类</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Grades,Students</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GradesAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">	<span class="comment"># 列表页属性</span></span><br><span class="line">	list_display = [<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;gname&#x27;</span>,<span class="string">&#x27;gdate&#x27;</span>,<span class="string">&#x27;ggirlnum&#x27;</span>,<span class="string">&#x27;gboynum&#x27;</span>,<span class="string">&#x27;isDelete&#x27;</span>]</span><br><span class="line">	list_filter = [<span class="string">&#x27;gname&#x27;</span>]</span><br><span class="line">	search_fields = [<span class="string">&#x27;gname&#x27;</span>]</span><br><span class="line">	list_per_page = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 添加,修改页面属性</span></span><br><span class="line">	<span class="comment"># fileds和fieldsets不能同时使用</span></span><br><span class="line">	<span class="comment"># fields = [&#x27;ggirlnum&#x27;,&#x27;gboynum&#x27;,&#x27;gname&#x27;,&#x27;gdate&#x27;,&#x27;isDelete&#x27;]</span></span><br><span class="line">	fieldsets = [</span><br><span class="line">	(<span class="string">&#x27;num&#x27;</span>,&#123;<span class="string">&#x27;fields&#x27;</span>:[<span class="string">&#x27;ggirlnum&#x27;</span>,<span class="string">&#x27;gboynum&#x27;</span>]&#125;),</span><br><span class="line">	(<span class="string">&#x27;base&#x27;</span>,&#123;<span class="string">&#x27;fields&#x27;</span>:[<span class="string">&#x27;gname&#x27;</span>,<span class="string">&#x27;gdate&#x27;</span>,<span class="string">&#x27;isDelete&#x27;</span>]&#125;),</span><br><span class="line">	]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 后注册表格类(要导入GradesAdmin类作为参数)</span></span><br><span class="line">admin.site.register(Grades,GradesAdmin)</span><br><span class="line">admin.site.register(Students)</span><br></pre></td></tr></table></figure>

<ol>
<li><p>列表页属性</p>
<ul>
<li><p>list_display:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list_display = [<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;gname&#x27;</span>,<span class="string">&#x27;gdate&#x27;</span>,<span class="string">&#x27;ggirlnum&#x27;</span>,<span class="string">&#x27;gboynum&#x27;</span>,<span class="string">&#x27;isDelete&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>显示需要的字段<img src="/images/1555207674255.png" alt="1555207674255"></p>
</li>
<li><p>list_filter:<br>过滤字段(就是添加一个过滤器)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list_filter = [<span class="string">&#x27;gname&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="/images/1555207870256.png" alt="1555207870256"></p>
</li>
<li><p>search_fields:<br>添加一个搜索字段</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search_fields = [<span class="string">&#x27;gname&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="/images/1555208017557.png" alt="1555208017557"></p>
</li>
<li><p>list_per_page:<br>分页</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每5条一页</span></span><br><span class="line">list_per_page = <span class="number">5</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>添加,修改页面属性<br><img src="/images/1555208204058.png" alt="1555208204058"></p>
<ul>
<li><p>fields:<br>规定属性的顺序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fields = [<span class="string">&#x27;ggirlnum&#x27;</span>,<span class="string">&#x27;gboynum&#x27;</span>,<span class="string">&#x27;gname&#x27;</span>,<span class="string">&#x27;gdate&#x27;</span>,<span class="string">&#x27;isDelete&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="/images/1555208654399.png" alt="1555208654399"></p>
</li>
<li><p>fieldsets:<br>给属性分组<br>注意<strong>fieldsets属性不能和fields属性同时使用</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意下面图片的字段顺序和这里的字段顺序是一致的</span></span><br><span class="line">fieldsets = [</span><br><span class="line">	(<span class="string">&#x27;num&#x27;</span>,&#123;<span class="string">&#x27;fields&#x27;</span>:[<span class="string">&#x27;ggirlnum&#x27;</span>,<span class="string">&#x27;gboynum&#x27;</span>]&#125;),</span><br><span class="line">	(<span class="string">&#x27;base&#x27;</span>,&#123;<span class="string">&#x27;fields&#x27;</span>:[<span class="string">&#x27;gname&#x27;</span>,<span class="string">&#x27;gdate&#x27;</span>,<span class="string">&#x27;isDelete&#x27;</span>]&#125;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p><img src="/images/1555210066809.png" alt="1555210066809"><br>解释:为什么fieldsets和fields不能同时使用?因为fieldsets本身就已经对字段排序了.</p>
</li>
</ul>
</li>
</ol>
</li>
<li><p>关联对象:<br>需求:在创建一个班级时可以直接添加几个学生<br>这时还是要创建一个类StudentsInfo:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新建一个类</span></span><br><span class="line"><span class="comment"># 注意继承TabularInline</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentsInfo</span>(<span class="params">admin.TabularInline</span>):</span></span><br><span class="line">    <span class="comment"># 要调用的表</span></span><br><span class="line">	model = Students</span><br><span class="line">    <span class="comment"># 要添加几个数据</span></span><br><span class="line">	extra = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentsInfo</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">	<span class="comment"># 将新建的类放在inlines里面</span></span><br><span class="line">	inlines = [StudentsInfo]</span><br><span class="line">	list_display = ...</span><br></pre></td></tr></table></figure>

<p>当新建一张Grade表的时候,下面就会提供一个Students让你填写:</p>
<p><img src="/images/1555213155603.png" alt="1555213155603"><br>其实StudentsInfo类不一定要继承admin.TabularInline,也可以继承admin.StackedInline,只是显示不同而已<br><img src="/images/1555213433907.png" alt="1555213433907"></p>
</li>
<li><p>布尔值显示问题:<br>我们对于性别sgender使用了布尔值,但是在终端显示的是0,1.现在想要让他显示’男’和’女’<br><strong>在类里定义方法,然后传入list_display</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="comment"># 定义一个方法</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">gender</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">if</span> self.sgender:</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&#x27;女&#x27;</span></span><br><span class="line">    <span class="comment"># 将方法gender代替掉原来的&#x27;sgender&#x27;</span></span><br><span class="line">	list_display = [<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;sname&#x27;</span>,<span class="string">&#x27;sage&#x27;</span>,gender,<span class="string">&#x27;scontend&#x27;</span>,<span class="string">&#x27;sgreade&#x27;</span>,<span class="string">&#x27;isDelete&#x27;</span>]</span><br><span class="line">	list_per_page = <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/1555213896317.png" alt="1555213896317"></p>
<p>修改字段名就是<strong>修改字段的short_description属性</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gender</span>(<span class="params">self</span>):</span></span><br><span class="line">	<span class="keyword">if</span> self.sgender:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;女&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sage</span>(<span class="params">self</span>):</span></span><br><span class="line">	<span class="keyword">return</span> self</span><br><span class="line">	</span><br><span class="line"><span class="comment"># 修改字段的字段名</span></span><br><span class="line">   <span class="comment"># 修改字段的short_description属性</span></span><br><span class="line">gender.short_description = <span class="string">&#x27;性别&#x27;</span></span><br><span class="line">sage.short_description = <span class="string">&#x27;年龄&#x27;</span></span><br><span class="line">   <span class="comment"># 替换字段</span></span><br><span class="line">   list_display = [<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;sname&#x27;</span>,sage,gender,<span class="string">&#x27;scontend&#x27;</span>,<span class="string">&#x27;sgreade&#x27;</span>,<span class="string">&#x27;isDelete&#x27;</span>]</span><br></pre></td></tr></table></figure></li>
<li><p>执行动作的位置问题<br><img src="/images/1555214524065.png" alt="1555214524065"><br>就是将这个框移动到下面去:<br>修改actions_on_top/actions_on_bottom属性:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="comment"># 两个都是True则上下都有</span></span><br><span class="line">	actions_on_top = <span class="literal">False</span></span><br><span class="line">	actions_on_bottom = <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<p><img src="/images/1555214669455.png" alt="1555214669455"></p>
</li>
</ol>
</li>
<li><p>使用装饰器完成注册admin.<br>我们上面将数据表注册到admin使用的方式是:<br>新建一个类StudentAdmin,然后通过修改这个类的属性来修改数据表的显示问题,最后将这个类使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin.site.register(Grades,GradesAdmin)</span><br></pre></td></tr></table></figure>

<p>来完成注册.</p>
<p>现在我们通过装饰器来完成注册:<br>其实方法很简单,就是将<code>admin.site.register(Grades,GradesAdmin)</code>换成装饰器:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用装饰器,传入表格类作为参数</span></span><br><span class="line"><span class="meta">@admin.register(<span class="params">Students</span>)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">	actions_on_top = <span class="literal">False</span></span><br><span class="line">	actions_on_bottom = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">gender</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">if</span> self.sgender:</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&#x27;女&#x27;</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">sage</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 修改字段的字段名</span></span><br><span class="line">	gender.short_description = <span class="string">&#x27;性别&#x27;</span></span><br><span class="line">	sage.short_description = <span class="string">&#x27;年龄&#x27;</span></span><br><span class="line"></span><br><span class="line">	list_display = [<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;sname&#x27;</span>,sage,gender,<span class="string">&#x27;scontend&#x27;</span>,<span class="string">&#x27;sgreade&#x27;</span>,<span class="string">&#x27;isDelete&#x27;</span>]</span><br><span class="line">	list_per_page = <span class="number">2</span></span><br></pre></td></tr></table></figure></li>
<li><p>视图的基本使用:</p>
<ul>
<li><p>概述:在Django中,视图对web请求进行回应</p>
</li>
<li><p>视图其实<strong>就是一个函数</strong>,在view.py中定义<br>url分发器来找到对应url,然后让这个url调用对应的视图.所以有多少个页面就有多少个视图.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">	<span class="keyword">return</span> HttpResponse(<span class="string">&#x27;hello world&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>配置url:</p>
<ol>
<li><p>修改project目录下的urls.py文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># project/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url,include</span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    url(<span class="string">r&#x27;^&#x27;</span>,include(<span class="string">&#x27;myapp.urls&#x27;</span>))</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><p>在myApp应用目录下创建一个urls.py文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># myapp/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^$&#x27;</span>, views.index),</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>流程说明:<br><img src="/images/bcff7751-20171215145650232.png" alt="20171215145650232"></p>
<ol>
<li>url控制器就是project目录下的urls.py.</li>
<li>当然我们键入<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/%E6%97%B6,%E9%A6%96%E5%85%88%E7%BB%8F%E8%BF%87url%E6%8E%A7%E5%88%B6%E5%99%A8,%E5%8C%B9%E9%85%8D%E5%88%B0%60url(r&#39;^&#39;,include(&#39;myapp.urls&#39;))%60">http://127.0.0.1:8000/时,首先经过url控制器,匹配到`url(r&#39;^&#39;,include(&#39;myapp.urls&#39;))`</a></li>
<li>然后include视图函数定位到app.urls文件</li>
<li>进入app.urls后被<code>url(r&#39;^$&#39;, views.index)</code>匹配</li>
<li>调用view.index函数</li>
</ol>
</li>
<li><p>为什么要用两级的urls控制器?<br>project/urls.py是总的urls控制器,是不可或缺的.而<strong>myapp/urls.py是一个app应用的借口</strong>,只要调用了这个接口就可以使用这个app应用了,这有利于代码的重用.</p>
<p>具体是如何重用的?<br><strong>两级urls控制器是url的二级目录</strong><br>eg:当我们输入<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/%E6%97%B6%E8%B0%83%E7%94%A8%E6%80%BB%E7%9A%84urls%E6%8E%A7%E5%88%B6%E5%99%A8,%E5%8C%B9%E9%85%8D%E5%88%B0%60url(r&#39;^&#39;,include(&#39;myapp.urls&#39;))%60,%E7%84%B6%E5%90%8E%E8%BD%AC%E5%88%B0app.urls,%E5%8C%B9%E9%85%8D%E5%88%B0%60url">http://127.0.0.1:8000/时调用总的urls控制器,匹配到`url(r&#39;^&#39;,include(&#39;myapp.urls&#39;))`,然后转到app.urls,匹配到`url</a>(r’^$’, views.index)`,最后去调用view.index<br>如果我们输入<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/2%E6%80%8E%E4%B9%88%E5%8A%9E?%E8%BF%99%E6%97%B6%E6%88%91%E4%BB%AC%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%9C%A8app.urls%E5%A2%9E%E5%8A%A0%E4%B8%80%E4%B8%AAurl.%E7%94%A8%E6%9D%A5%E5%88%86%E7%B1%BB%E8%BF%99%E4%B8%AA%E9%93%BE%E6%8E%A5">http://127.0.0.1:8000/2怎么办?这时我们就可以在app.urls增加一个url.用来分类这个链接</a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># project/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url,include</span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    url(<span class="string">r&#x27;^&#x27;</span>,include(<span class="string">&#x27;myapp.urls&#x27;</span>))</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># myapp/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^$&#x27;</span>, views.index),</span><br><span class="line">    <span class="comment"># 注意是(\d+),要用分组</span></span><br><span class="line">    <span class="comment"># 这个分组会传递给view.detail作为参数</span></span><br><span class="line">    url(<span class="string">r&#x27;^(\d+)/$&#x27;</span>,views.detail)</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># myapp.views.py</span></span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">	<span class="keyword">return</span> HttpResponse(<span class="string">&#x27;hello world&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span>(<span class="params">request,num</span>):</span></span><br><span class="line">	<span class="keyword">return</span> HttpResponse(<span class="string">f&#x27;detail <span class="subst">&#123;num&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol>
<li>当我们输入<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/2%E6%97%B6,%E9%A6%96%E5%85%88%E5%88%B0%E6%80%BB%E7%9A%84urls%E6%8E%A7%E5%88%B6%E5%99%A8%E4%B8%AD">http://127.0.0.1:8000/2时,首先到总的urls控制器中</a>,</li>
<li>其中的<code>url(r&#39;^&#39;,include(&#39;myapp.urls&#39;))</code>匹配成功<code>http://127.0.0.1:8000/</code>,然后调用对应的视图函数<code>include(&#39;myapp.urls&#39;)</code>,</li>
<li><code>include(&#39;myapp.urls&#39;)</code>调用app.urls,其中的<code>url(r&#39;^(\d+)/$&#39;,views.detail)</code>成功匹配到<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/2%E4%B8%AD%E7%9A%84%60/2%60,%E8%B0%83%E7%94%A8%E8%A7%86%E5%9B%BE%E5%87%BD%E6%95%B0views.detail">http://127.0.0.1:8000/2中的`/2`,调用视图函数views.detail</a></li>
<li>views.detail获取到<code>/2</code>,将其赋给num变量,返回 detail 2<br><img src="/images/1555289161053.png" alt="1555289161053"></li>
</ol>
</li>
<li><p>总结:<br>也就是说,project/urls.py是用来匹配<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/%E7%9A%84,%E8%80%8Capp.urls%E6%98%AF%E7%94%A8%E6%9D%A5%E5%8C%B9%E9%85%8D%E5%90%8E%E9%9D%A2%E7%9A%84/2%E7%9A%84">http://127.0.0.1:8000/的,而app.urls是用来匹配后面的/2的</a>.</p>
<p>==两级urls控制器是url的二级目录,用来层层细化url,最终找到对应的视图函数==</p>
</li>
</ul>
</li>
<li><p>模板的基本使用:</p>
<ul>
<li><p>概述:<br>模板是HTML页面,可以根据视图中传递过来的数据进行填充.</p>
</li>
<li><p>创建模板:<br>在manage.py目录下创建一个对应模板目录templates.<strong>目录templates下面就存放每个app对应的模板文件</strong></p>
</li>
<li><p>配置模板目录:<br>修改setting.py文件的TEMPLATES选项.把templates的目录层级告诉DIRS变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TEMPLATES = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;BACKEND&#x27;</span>:...</span><br><span class="line">        <span class="string">&#x27;DIRS&#x27;</span>: [os.path.join(BASE_DIR,<span class="string">&#x27;templates&#x27;</span>)],</span><br><span class="line">        ...	</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>基本使用:<br>目标:输入<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/grade%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%ADgrede%E8%A1%A8%E7%9A%84%E5%86%85%E5%AE%B9.%E8%BE%93%E5%85%A5http://127.0.0.1:8000/student">http://127.0.0.1:8000/grade返回数据库中grede表的内容.输入http://127.0.0.1:8000/student</a> 返回数据库中student表的内容.</p>
<ol>
<li><p>定义模板:<br>找templates/myapp/目录下创建一个grade.html文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- templates/myapp/grades.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&#x27;cn&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>班级信息<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>同理创建student.html</p>
</li>
<li><p>模板语法:</p>
<ul>
<li><code>&#123;&#123;输出值,可以是变量,一个可以是对象属性&#125;&#125;</code></li>
<li><code>&#123;%执行代码段%&#125;</code></li>
</ul>
<p>所以前面templates/myapp/grades.html修改为</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!-- templates/myapp/grades.html --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&#x27;cn&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>班级信息<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>班级信息列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!-- 每个班级,因此需要循环 --&gt;</span></span></span><br><span class="line"><span class="xml">	</span><span class="template-tag">&#123;%<span class="name"><span class="name">for</span></span> grade <span class="keyword">in</span> grades%&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="comment">&lt;!-- 双括号下面可以是变量也可以是属性 --&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span></span><span class="template-variable">&#123;&#123;grade.gname&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">	</span><span class="template-tag">&#123;%<span class="name"><span class="name">endfor</span></span>%&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">	</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>解释:</p>
<p>12行-17行其实是一个循环.表示遍历grades(这个grades会由views.py传入),每个grade创建一个&lt;li&gt;,&lt;li&gt;里面创建一个&lt;a&gt;,用grade.gname来填充数据.</p>
</li>
<li><p>修改myapp/urls.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^$&#x27;</span>, views.index),</span><br><span class="line">    url(<span class="string">r&#x27;^(\d+)/$&#x27;</span>,views.detail),</span><br><span class="line">	<span class="comment"># 匹配这个url</span></span><br><span class="line">    url(<span class="string">r&#x27;^grades/$&#x27;</span>,views.grades)</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><p>创建视图函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># myapp/views.py</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Grades</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">grades</span>(<span class="params">request</span>):</span></span><br><span class="line">	<span class="comment"># grades函数的使命:去数据库里取出数据,将数据传递给模板</span></span><br><span class="line">	<span class="comment"># (模板再渲染页面,将渲染好的页面返回给浏览器)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 首先取出数据</span></span><br><span class="line">	gradeslist = Grades.objects.<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment"># render的使用接口:</span></span><br><span class="line">	<span class="comment"># 将某个数据数据传给myapp/grades.html这个模板,</span></span><br><span class="line">	<span class="comment"># 是什么数据?实际上是一个字典</span></span><br><span class="line">	<span class="comment"># 该字典以myapp/grades.html里使用的变量作为键,以数据表的数据作为值</span></span><br><span class="line">	<span class="keyword">return</span> render(request,<span class="string">&#x27;myapp/grades.html&#x27;</span>,&#123;<span class="string">&#x27;grades&#x27;</span>:gradeslist&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>结果如下:<br><img src="/images/1555293072933.png" alt="1555293072933"></p>
</li>
</ol>
</li>
</ul>
</li>
<li><p>模板的进阶使用:<br>现在我们已经创建一个班级信息列表了,现在我们需要制作下面功能,点击grade1,然后跳转到grade1的全部数据<br>(简单来说就是:点击班级显示对应班级的学生)</p>
<ol>
<li><p>首先我们将grade.html修改为:</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">...</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>班级信息列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">		</span><span class="template-tag">&#123;%<span class="name"><span class="name">for</span></span> grade <span class="keyword">in</span> grades%&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">            # a标签的href修改为grade.id</span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;</span></span></span><span class="template-variable">&#123;&#123;grade.id&quot;&gt;&#123;&#123;grade.gname&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">&lt;/a&gt;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="xml">		&lt;/li&gt;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="xml">		</span></span></span><span class="template-tag">&#123;%<span class="name"><span class="name">endfor</span></span>%&#125;</span><span class="xml"><span class="tag"><span class="string"></span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="xml">	&lt;/ul&gt;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="xml">	</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="xml">&lt;/body&gt;</span></span></span></span><br></pre></td></tr></table></figure>

<p>这样,当我们点击的时候就会出现:</p>
<p><img src="/images/1555331897150.png" alt="1555331897150"><br>注意此时url已经变成了<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/grades/2,%E6%89%80%E4%BB%A5%E6%88%91%E4%BB%AC%E5%8F%AA%E9%9C%80%E5%86%8D%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AAurl%E5%88%86%E5%8F%91%E5%99%A8,%E8%A7%86%E5%9B%BE%E5%8D%B3%E5%8F%AF">http://127.0.0.1:8000/grades/2,所以我们只需再制作一个url分发器,视图即可</a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^$&#x27;</span>, views.index),</span><br><span class="line">    url(<span class="string">r&#x27;^(\d+)/$&#x27;</span>,views.detail),</span><br><span class="line"></span><br><span class="line">    url(<span class="string">r&#x27;^grades/$&#x27;</span>,views.grades),</span><br><span class="line">    url(<span class="string">r&#x27;^students/$&#x27;</span>,views.students),</span><br><span class="line">    <span class="comment"># 添加新的url</span></span><br><span class="line">    url(<span class="string">r&#x27;^grades/(\d+)$&#x27;</span>,views.detail_grades)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app/views.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意这里的视图函数多了一个num参数(从url分发器里拿到的)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail_grades</span>(<span class="params">request,num</span>):</span></span><br><span class="line">	grade = Grades.objects.get(<span class="built_in">id</span>=num)</span><br><span class="line">	studentslist = grade.students_set.<span class="built_in">all</span>()</span><br><span class="line">    <span class="comment"># 重要:注意这里还是调用了student.html这个模板(并没有新建模板)</span></span><br><span class="line">	<span class="keyword">return</span> render(request,<span class="string">&#x27;myapp/students.html&#x27;</span>,&#123;<span class="string">&#x27;students&#x27;</span>:studentslist&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<hr>
<p>简要流程:</p>
<ol>
<li>创建工程:<br>django-admin startproject myproject</li>
<li>创建项目:<br>python manage.py startapp myapp</li>
<li>激活项目:<br>修改setting.py中的INSTALLED_APPS</li>
<li>配置数据库:<ol>
<li>修改__init__.py文件</li>
<li>修改setting.py中的DATABASES</li>
</ol>
</li>
<li>创建模型类:<br>在项目目录下的models.py文件中</li>
<li>生成迁移文件:<br>python manage.py makemigrations</li>
<li>执行迁移:<br>python manage.py migrate</li>
<li>配置站点</li>
<li>创建template目录/项目模板目录</li>
<li>在setting.py中配合模板路径</li>
<li>在project下修改urls.py</li>
<li>在项目目录下创建urls.py</li>
</ol>
<hr>
<p>当我们获取一个Django项目时,如果才能在我们的电脑里运行?</p>
<ol>
<li>在setting.py里修改数据库名,数据库密码</li>
<li>删除迁移文件</li>
<li>在数据库中创建对应的数据库</li>
<li>执行生成迁移文件</li>
<li>执行迁移</li>
</ol>
<hr>
<p>模型</p>
<ol>
<li><p>Django对各种数据库都有很好的支持,而且提供了统一的API接口</p>
</li>
<li><p>ORM:</p>
<ol>
<li><p>O:对象,R:关系,M:映射<br><img src="/images/ORM.jpg" alt="ORM"></p>
</li>
<li><p>任务:</p>
<ul>
<li>根据对象的类型生成表结构</li>
<li>将对象,列表的操作转换为sql语句</li>
<li>将sql语句查询到的结果转换为对象和列表</li>
</ul>
</li>
<li><p>优点:极大的减轻了开发人员的工作量,<strong>不需要面对因数据库的变更和修改代码</strong>.</p>
</li>
</ol>
</li>
<li><p>定义模型:<br>模型,属性,表,字段的关系: </p>
<ul>
<li>模型类在数据库中对应一张表</li>
<li>在模型类中定义的属性对应该模型对照表中得到一个字段.</li>
</ul>
</li>
<li><p>定义属性:</p>
<ul>
<li>django会为表添加自动增长的主键列,每个模型只能有一个主键列.<br>但是如果使用选项设置某属性为主键列后,则就不能生成默认的主键列</li>
<li>属性命名规则:<br>不能用python的关键字.<br>不能使用连续的下划线.</li>
<li><strong>所有的字段类型都被定义在django.db.models.fields目录下</strong></li>
<li>==强烈建议对于重要的数据做逻辑删除,而不是物理删除==<br>实现方法是定义isDelete属性,类型为BooleanField,默认值为False</li>
</ul>
</li>
<li><p>字段类型:</p>
<ul>
<li><p>AutoField:<br>实际上默认的主键列的字段类型就是AutoField.他是一个会根据实际ID自动增长的IntegerField,<strong>通常不用这个字段类型</strong>.</p>
</li>
<li><p>CharField(max_length=字符长度):<br>字符串类型.默认的表单样式是TextInput(就是在站点管理的时候显示的是textinput格式)</p>
</li>
<li><p>TextField:<br>大文本字段.一般超过4000字节的时候使用.默认的表单控件是Textarea</p>
</li>
<li><p>IntegerField:<br>整数字段</p>
</li>
<li><p>DecimalField(max_digits=None,decimal_places=None):<br>使用python的Decimal实例表示的<strong>十进制浮点数</strong>.<br>DecimalFiled.max_digits:位数总数.<br>DecimalField.decimal_places:小数点后的数字位数.</p>
</li>
<li><p>floatField:<br>用python的float实例来表示的浮点数.</p>
</li>
<li><p>BooleanField:<br>布尔字段,默认表单控件是CheckboxInput</p>
</li>
<li><p>NullBooleanField:<br>支持Null,true,false三种值.</p>
</li>
<li><p>DateField([auto_now =False,auto_now_add =False]):<br>使用python的datetime.date实例表示的日期.默认对应的表单控件时候一个TextInput<br>DateField.auto_now:<strong>每次保存对象时,自动设置该字段为当前时间,一般用于<code>最后一次修改</code>的时间戳</strong>(就是说,当修改一行的时候,该行的DateField字段就会指定更改时间)<br>DateField.auto_now_add:当对象第一次被创建时自动设置当前时间,用于创建的时间.戳,他总是使用当前日期</p>
</li>
</ul>
</li>
</ol>
<blockquote>
<p> 注意:auto_now_add和auto_now是互斥的.他们不会同时出现在同一个字段.(废话,一个是创建时间,一个是修改时间.)</p>
</blockquote>
<ul>
<li><p>TimeField([auto_now =False,auto_now_add =False]):<br>使用python的datetime.time实例表示的时间,参数同DateField</p>
</li>
<li><p>DateTimeField([auto_now =False,auto_now_add =False]):<br>使用python的datetime.<br>datetime实例表示的日期和时间,参数同DateField</p>
</li>
<li><p>FileField:<br>一个上传文件的字段.</p>
</li>
<li><p>ImageField:<br>继承了FileField的所有属性和方法,但对上传的对象进行校验,确保这是一个有效的Image.</p>
</li>
</ul>
<ol start="6">
<li><p>字段选项:</p>
<ul>
<li><p>概述:<br>通过字段选项,可以实现对字段的约束.字段选项必须使用关键字参数.</p>
</li>
<li><p>null:<br>将空值存储到数据库中,默认为False</p>
</li>
<li><p>blanke:<br>如果为True,该字段允许空白.默认为False</p>
</li>
</ul>
</li>
</ol>
<blockquote>
<p> 注意null是数据库范畴的概念,blank是表单验证范畴的.</p>
</blockquote>
<ul>
<li><p>db_column:</p>
<p>字段的名称.如果未指定,这使用属性的名称.</p>
<p>eg:当我们定义一个字段时若写到:<br><code>sage = models.IntegerField(db_column=&#39;age&#39;)</code><br>则在数据库中回忆age来命名该字段,但是models.py中该字段的名称还是sage.</p>
</li>
<li><p>db_index:<br>若为True,则会在表中以此字段创建索引.</p>
</li>
<li><p>default:<br>默认值</p>
</li>
<li><p>primary_key:<br>若为True,设置主键字段</p>
</li>
<li><p>unique:<br>唯一约束.</p>
</li>
</ul>
<ol start="7">
<li><p>关系:</p>
<ul>
<li>分类:<ol>
<li>Foreignkey:一对多,将字段定义在==多==的端中</li>
<li>ManyToManyField:多余多,将字段定义在==两端==中(本来按照数据库的完整性约束应该再手动建一张表的,但是Django已经帮我们建好了)</li>
<li>OneToOneField:一对一,将字段定义在任意一端中.</li>
</ol>
</li>
<li>用一访问多:<br>格式:<code>对象.模型类小写_set</code><br>示例:<code>grade.students_set</code></li>
<li>用一访问一:<br>格式:<code>对象.模型类小写</code><br>示例:<code>grade.students</code></li>
<li>访问id:<br>格式:<code>对象.属性_id</code><br>示例:<code>student.sgrade_id</code></li>
</ul>
</li>
<li><p>元选项:<br>在模型类==里面==定义一个Meta类,用于设置元信息.</p>
<ul>
<li>db_table:<br>修改默认的数据表名(默认为:<code>项目名_类名</code>).</li>
<li>ordering:<br>返回结果时对数据自动排序<br>(字段名前面+号表示升序(可省略)<code>ordering=[&#39;id&#39;]</code>,<br>-号表示降序<code>ordering=[&#39;-id&#39;]</code>)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">	sname =models.CharField(max_length=<span class="number">20</span>)</span><br><span class="line">	sgender = models.BooleanField(default=<span class="literal">True</span>)</span><br><span class="line">	sage = models.IntegerField()</span><br><span class="line">	scontend = models.CharField(max_length=<span class="number">20</span>)</span><br><span class="line">	sgreade = models.ForeignKey(<span class="string">&#x27;Grades&#x27;</span>)</span><br><span class="line">	isDelete = models.BooleanField(default=<span class="literal">False</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        <span class="comment"># 修改默认的数据表名</span></span><br><span class="line">		db_table=<span class="string">&#x27;students&#x27;</span></span><br><span class="line">        <span class="comment"># 返回结果时对数据自动排序</span></span><br><span class="line">		ordering=[<span class="string">&#x27;id&#x27;</span>]</span><br></pre></td></tr></table></figure></li>
<li><p>模型成员:</p>
<ul>
<li><p>类属性:</p>
<ol>
<li><p>object:<br>是<code>Manager类型</code>的一个对象,作用是与数据库进行交互.</p>
</li>
<li><p>当定义模型类时没有指定管理器,则Django为模型创建一个名为objects的管理器.</p>
</li>
<li><p>自定义模型管理器.(会覆盖掉原来的objects模型管理器)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">	<span class="comment"># 自定义模型管理器</span></span><br><span class="line">	stuObj = models.Manager()</span><br><span class="line"></span><br><span class="line">	sname = ...</span><br></pre></td></tr></table></figure>
<p>此时就不能再使用students.objects了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 报错</span></span><br><span class="line">students.objects.<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 正确运行</span></span><br><span class="line">student.stuObj.<span class="built_in">all</span>()</span><br></pre></td></tr></table></figure>

<p>到目前为止,我们修改了模型管理器,但是没有什么鸟用,只是修改了名称而已. </p>
</li>
<li><p>自定义管理器Manager类:</p>
<ul>
<li><p>==模型管理器是Django的模型与数据库进行交互的接口.==<br>一个模型可以有多个模型管理器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">	<span class="comment"># 多个模型管理器</span></span><br><span class="line">	stuObj1 = models.Manager()</span><br><span class="line">    stuObj2 = models.Manager()</span><br><span class="line"></span><br><span class="line">	sname = ...</span><br></pre></td></tr></table></figure></li>
<li><p><strong>自定义</strong>的模型管理器的作用:</p>
<ol>
<li><p>可以管理器类中添加额外的方法.<br>比如说添加一个新方法让我们能更方便的在数据库中添加数据.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">	<span class="comment"># 定义一个类方法,让我们能更方便的创建对象</span></span><br><span class="line"><span class="meta">	@classmethod</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">createStudent</span>(<span class="params">cls,name,age,gender,contend,greade,isDelete=Flase</span>):</span></span><br><span class="line">		stu = cls(sname=name,sage=age,sgender=gender,scontend=contend,sgreade=greade,isDelete=isDelete)</span><br><span class="line">		<span class="keyword">return</span> stu</span><br><span class="line">		</span><br><span class="line">	stuObj = StudentsManager()</span><br><span class="line">	sname = ...</span><br></pre></td></tr></table></figure></li>
<li><p>修改管理器返回的原始查询集.<br>比如说,我们可以通过改写get_queryset()方法,让student.objects.all()不返回isDelete为True的数据.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 继承models.Manager</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentsManager</span>(<span class="params">models.Manager</span>):</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">super</span>(StudentManager,self).get_queryset().<span class="built_in">filter</span>(isDelete=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">	<span class="comment"># 自定义模型管理器,使用自定义的模型管理器</span></span><br><span class="line">	stuObj = StudentsManager()</span><br><span class="line">    sname = ...</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
<li><p>创建对象:</p>
<ol>
<li><p>目的:<br>向数据库中添加数据</p>
</li>
<li><p>当创建对象时,Django不会对数据库进行读写操作,,当调用save方法时才会与数据库交互,将对象保存到数据库中.</p>
</li>
<li><p>注意:__init__方法已经在父类models.Model中使用,在自定义的模型中无法使用.<br>只能为模型表对象实例挨个添加属性,然后save()</p>
</li>
<li><p>第三点的解决方法有两种:</p>
<ul>
<li><p>在模型类中增加一个类方法.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">	<span class="comment"># 定义一个类方法,让我们能更方便的创建对象</span></span><br><span class="line"><span class="meta">	@classmethod</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">createrStudent</span>(<span class="params">cls,name,age,gender,contend,greade,isDelete=Flase</span>):</span></span><br><span class="line">		stu = cls(sname=name,sage=age,sgender=gender,scontend=contend,sgreade=greade,isDelete=isDelete)</span><br><span class="line">		<span class="keyword">return</span> stu</span><br><span class="line">		</span><br><span class="line">	stuObj = StudentsManager()</span><br><span class="line">	sname = ...</span><br></pre></td></tr></table></figure></li>
<li><p>在自定义管理器中添加一个方法.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentsManager</span>(<span class="params">models.Manager</span>):</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">super</span>(StudentManager,self).get_queryset().<span class="built_in">filter</span>(isDelete=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment"># 定义这个方法后,就可以使用stu = Students.objects.createrStudent(...)</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">createrStudent</span>(<span class="params">self,name,age,gender,contend,greade,isDelete=Flase</span>):</span></span><br><span class="line">		stu = cls(sname=name,sage=age,sgender=gender,scontend=contend,sgreade=greade,isDelete=isDelete)</span><br><span class="line">		<span class="keyword">return</span> stu</span><br></pre></td></tr></table></figure>

<p>但是如果使用上面的方法,那么这个管理器就只能适用于Students,所以我们可以如下使用:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentsManager</span>(<span class="params">models.Manager</span>):</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">super</span>(StudentManager,self).get_queryset().<span class="built_in">filter</span>(isDelete=<span class="literal">False</span>)</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">createrStudent</span>(<span class="params">self,name,age,gender,contend,greade,isDelete=Flase</span>):</span></span><br><span class="line">        <span class="comment"># 使用self.model(),表示使用该管理器对应的模型创建一个空的实例对象</span></span><br><span class="line">		stu = self.model()</span><br><span class="line">		stu.sage = age</span><br><span class="line">		stu.sname = name</span><br><span class="line">		stu.sgender = gender</span><br><span class="line">		stu.scontend = contend</span><br><span class="line">		stu.sgreade = greade</span><br><span class="line">		stu.isDelete = isDelete</span><br><span class="line">		<span class="keyword">return</span> stu</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
<li><p>模型查询:</p>
<ul>
<li><p>概述:</p>
<ol>
<li>查询集:表示从数据库中获取的对象的集合<br>(简单来说就是查询数据库里所有的数据)</li>
<li>查询集可以有多个过滤器</li>
<li>过滤器就是一个函数,基于所给的参数限制查询的结果.</li>
<li><strong>从SQL的角度来说,查询集和select语句等价</strong><br>过滤函数就是where条件</li>
</ol>
</li>
<li><p>查询集:</p>
<ol>
<li><p>在管理器中调用过滤方法返回查询集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentsManager</span>(<span class="params">models.Manager</span>):</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">super</span>(StudentManager,self).get_queryset().<span class="built_in">filter</span>(isDelete=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>查询集经过过滤器筛选后返回新的查询集.<br>所以我们可以写成链式调用.</p>
</li>
<li><p>惰性执行:<br><strong>创建查询集不会带来任何数据库的访问,直到调用数据时,才会访问数据库.</strong></p>
</li>
<li><p>直接访问数据的情况:</p>
<ul>
<li>迭代</li>
<li>序列化</li>
<li>与if合用</li>
</ul>
</li>
<li><p>返回查询集的方法称为过滤器:</p>
<ul>
<li><p>all():<br>返回查询集中的所有值</p>
</li>
<li><p>filter():<br>返回符合条件的值</p>
<p>filter(键1=值1,键2=值2):<br><code>且</code>的关系,就是说,要同时符合两种</p>
</li>
<li><p>exclude:<br>过滤到符合条件的数据.</p>
</li>
<li><p>order_by():<br>和MySQL一样,用于排序</p>
</li>
<li><p>values():<br>其实<strong>数据库的一条数据就是一个字典</strong>,多个字典组成一个列表.values()就是将这个列表返回.</p>
<p>values()和all()的区别:<br>我们之前说过all()返回的是一个QuerySet,QuerySet就是一个类似于列表的对象.<br>values()返回的是一个真正的列表,列表元素是字典(一个字典就是一条数据)</p>
</li>
</ul>
</li>
<li><p>返回单个数据:</p>
<ul>
<li><p>get():<br>返回<strong>一个</strong>满足条件的对象 </p>
<p>注意:<br>   如果没有符合条件的对象,模型类会引发DoseNotExist异常.<br>   如果找到多条数据,会引发MutlipleObjectsReturned异常.</p>
</li>
<li><p>count():<br>   返回当前查询集的对象个数</p>
</li>
<li><p>find():<br>返回查询集中的第一个对象</p>
</li>
<li><p>last():<br>返回查询集中的最后一个对象</p>
</li>
<li><p>exists():<br>判断查询集中是否有数据.</p>
</li>
</ul>
</li>
<li><p>限制查询集:<br>查询集返回列表,可以使用下标的方法进行限制.等同于sql中的limit语句.<br>注意:<strong>下标不能是负数</strong></p>
</li>
<li><p>查询集的缓存:</p>
<ul>
<li>概述:<br>每个查询集都包含一个缓存,来最小化的对数据库访问.<br>在新建的查询集中,缓存首次为空,第一次对查询集求值,会发生数据缓存,Django会见查询出来的数据做一个缓存(保存到内存中),并返回查询结构.以后的查询直接使用查询集的缓存.</li>
</ul>
</li>
<li><p>字段查询:</p>
<ul>
<li><p>概述:<br>实现了sql的where语句,作为方法filter(),exclude(),get()的参数</p>
</li>
<li><p>语法:<br><strong>属性名称__比较运算符=值</strong>.</p>
</li>
<li><p>外键:<br><strong>属性名_id</strong></p>
</li>
<li><p>转义:</p>
<p>like语句中使用%是为了匹配占位.如果要匹配数据中的%就要使用<code>where like \%</code><br>但是在查询集是使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 找出sname字段存在%的数据</span></span><br><span class="line"><span class="comment"># 不需要转义</span></span><br><span class="line"> <span class="built_in">filter</span>(sname__contains=<span class="string">&#x27;%&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>比较运算符:</p>
<ul>
<li><p>exact:</p>
<p>判断,大小写敏感.<br>filter(isDelete=False)</p>
</li>
<li><p>contains:<br>是否包含,大小写敏感.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">studentList = Students.objects.<span class="built_in">filter</span>(sname__contains=<span class="string">&#x27;孙&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>startswith,endswith:<br>和python普通的的startswith一样,以value开头/结尾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">studentList = Students.objects.<span class="built_in">filter</span>(sname__startswith=<span class="string">&#x27;孙&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>上面四个函数在前面加一个i表示不区分大小写.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iexact</span><br><span class="line">icontains</span><br><span class="line">istartswith</span><br><span class="line">iendswith</span><br></pre></td></tr></table></figure></li>
<li><p>isnull,isnotnull:<br>是否为空</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">filter</span>(sname__isnull=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>in:<br>是否包含</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找id在2,4,6,8的学生</span></span><br><span class="line">studentList = Students.objects.fileter(id__in=[<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>])</span><br></pre></td></tr></table></figure></li>
<li><p>gt,gte,lt,lte:<br>大小于等于</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找年龄大于30的学生</span></span><br><span class="line">studentList = Students.objects.<span class="built_in">filter</span>(sage__gt=<span class="number">30</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>year,month,day,week_day,hour,minute,second:<br>日期时间相关:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">studentList = Students.objects.<span class="built_in">filter</span>(lastTime__year=<span class="number">20</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>跨关联关系:<br>处理join查询.<br>语法:<strong>模型类名__属性名__比较运算符</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 班级里面有名字叫何应良的学生 的班级有哪些?</span></span><br><span class="line">gradeList = Gredes.objects.fileter(students__sname__contains=<span class="string">&#x27;何应良&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>查询快捷:<br>使用pk代表数据表中的主键</p>
</li>
</ul>
</li>
<li><p>聚合函数:</p>
<ul>
<li><p>使用aggregate()函数返回聚合函数的值<br>Avg,Count,Max,Min,Sum</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先引入</span></span><br><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Max</span><br><span class="line">maxAge = Students.objects.aggregate(Max(<span class="string">&#x27;sage&#x27;</span>))</span><br></pre></td></tr></table></figure></li>
<li><p>F对象:</p>
<p><strong>可以使用模型的A属性与B属性进行比较</strong>(就是一条数据里的两个值比较)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> F</span><br><span class="line"><span class="comment"># 字段girlnum的值比boynum字段的值要大</span></span><br><span class="line">Grades.objects.<span class="built_in">filter</span>(girlnum__gt=F(<span class="string">&#x27;boynum&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>支持F对象的算术运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> F</span><br><span class="line"><span class="comment"># 字段girlnum的值比 boynum字段的值加上20 还要大</span></span><br><span class="line">Grades.objects.<span class="built_in">filter</span>(girlnum__gt=F(<span class="string">&#x27;boynum&#x27;</span>)+<span class="number">20</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>Q对象:<br>概述:<br>过滤器的方法中的关键字参数,条件为AND模式.<br>就是说filter(键1=值1,键2=值2):<br>是<code>且</code>的关系,就是说,要同时符合两种条件</p>
<p>现在要进行OR查询,就要使用Q对象.<br>所以说:Q对象用于解决或的问题.Q()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> F</span><br><span class="line">       </span><br><span class="line"><span class="comment"># id小于3或者年龄大于50的数据</span></span><br><span class="line">Students.<span class="built_in">object</span>.<span class="built_in">filter</span>(Q(id__lte=<span class="number">3</span>) | Q(age__gt = <span class="number">50</span>))</span><br></pre></td></tr></table></figure>

<p>上面就是使用两个Q对象,然后使用|连接,<br>如果只有一个Q对象,那就是用于匹配的,可以直接省去:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Students.<span class="built_in">object</span>.<span class="built_in">filter</span>(Q(id__lte=<span class="number">3</span>))</span><br><span class="line"><span class="comment"># 等同于</span></span><br><span class="line">Students.<span class="built_in">object</span>.<span class="built_in">filter</span>(id__lte=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>取反:在Q前面加一个波浪线<code>~</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Students.<span class="built_in">object</span>.<span class="built_in">filter</span>(~Q(id__lte=<span class="number">3</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>