<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;ProxyPool&quot;&gt;&lt;a href=&quot;#ProxyPool&quot; class=&quot;headerlink&quot; title=&quot;ProxyPool&quot;&gt;&lt;/a&gt;ProxyPool&lt;/h1&gt;&lt;p&gt;此代理池在获取IP的时候使用了pop方法一次性使用，如果是想多次可用可以移步优化后的代理池：&lt;a href=&quot;https://github.com/Python3WebSpider/ProxyPool&quot;&gt;https://github.com/Python3WebSpider/ProxyPool&lt;/a&gt;，推荐使用。"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>README | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Python-Crawler/" rel="tag">Python Crawler</a></div><div class="post-time">2018-09-14</div></div></div><div class="container post-header"><h1>README</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ProxyPool"><span class="toc-number">1.</span> <span class="toc-text">ProxyPool</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">1.1.</span> <span class="toc-text">安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Python"><span class="toc-number">1.1.1.</span> <span class="toc-text">安装Python</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Redis"><span class="toc-number">1.1.2.</span> <span class="toc-text">安装Redis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86%E6%B1%A0"><span class="toc-number">1.1.3.</span> <span class="toc-text">配置代理池</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">安装依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E4%BB%A3%E7%90%86%E6%B1%A0%E5%92%8CAPI"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">打开代理池和API</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%BB%A3%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">获取代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%84%E6%A8%A1%E5%9D%97%E5%8A%9F%E8%83%BD"><span class="toc-number">1.3.</span> <span class="toc-text">各模块功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%8F%82%E8%80%83"><span class="toc-number">1.4.</span> <span class="toc-text">项目参考</span></a></li></ol></li></ol></details></div><div class="container post-content"><h1 id="ProxyPool"><a href="#ProxyPool" class="headerlink" title="ProxyPool"></a>ProxyPool</h1><p>此代理池在获取IP的时候使用了pop方法一次性使用，如果是想多次可用可以移步优化后的代理池：<a target="_blank" rel="noopener" href="https://github.com/Python3WebSpider/ProxyPool">https://github.com/Python3WebSpider/ProxyPool</a>，推荐使用。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="安装Python"><a href="#安装Python" class="headerlink" title="安装Python"></a>安装Python</h3><p>至少Python3.5以上</p>
<h3 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h3><p>安装好之后将Redis服务开启</p>
<h3 id="配置代理池"><a href="#配置代理池" class="headerlink" title="配置代理池"></a>配置代理池</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd proxypool</span><br></pre></td></tr></table></figure>

<p>进入proxypool目录，修改settings.py文件</p>
<p>PASSWORD为Redis密码，如果为空，则设置为None</p>
<h4 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install -r requirements.txt</span><br></pre></td></tr></table></figure>

<h4 id="打开代理池和API"><a href="#打开代理池和API" class="headerlink" title="打开代理池和API"></a>打开代理池和API</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 run.py</span><br></pre></td></tr></table></figure>

<h2 id="获取代理"><a href="#获取代理" class="headerlink" title="获取代理"></a>获取代理</h2><p>利用requests获取方法如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">PROXY_POOL_URL = &#x27;http://localhost:5000/get&#x27;</span><br><span class="line"></span><br><span class="line">def get_proxy():</span><br><span class="line">    try:</span><br><span class="line">        response = requests.get(PROXY_POOL_URL)</span><br><span class="line">        if response.status_code == 200:</span><br><span class="line">            return response.text</span><br><span class="line">    except ConnectionError:</span><br><span class="line">        return None</span><br></pre></td></tr></table></figure>

<h2 id="各模块功能"><a href="#各模块功能" class="headerlink" title="各模块功能"></a>各模块功能</h2><ul>
<li><p>getter.py</p>
<blockquote>
<p>爬虫模块</p>
</blockquote>
<ul>
<li><p>class proxypool.getter.FreeProxyGetter</p>
<blockquote>
<p>爬虫类，用于抓取代理源网站的代理，用户可复写和补充抓取规则。</p>
</blockquote>
</li>
</ul>
</li>
<li><p>schedule.py</p>
<blockquote>
<p>调度器模块</p>
</blockquote>
<ul>
<li><p>class proxypool.schedule.ValidityTester</p>
<blockquote>
<p>异步检测类，可以对给定的代理的可用性进行异步检测。</p>
</blockquote>
</li>
<li><p>class proxypool.schedule.PoolAdder</p>
<blockquote>
<p>代理添加器，用来触发爬虫模块，对代理池内的代理进行补充，代理池代理数达到阈值时停止工作。</p>
</blockquote>
</li>
<li><p>class proxypool.schedule.Schedule</p>
<blockquote>
<p>代理池启动类，运行RUN函数时，会创建两个进程，负责对代理池内容的增加和更新。</p>
</blockquote>
</li>
</ul>
</li>
<li><p>db.py</p>
<blockquote>
<p>Redis数据库连接模块</p>
</blockquote>
<ul>
<li><p>class proxypool.db.RedisClient</p>
<blockquote>
<p>数据库操作类，维持与Redis的连接和对数据库的增删查该，</p>
</blockquote>
</li>
</ul>
</li>
<li><p>error.py</p>
<blockquote>
<p>异常模块</p>
</blockquote>
<ul>
<li><p>class proxypool.error.ResourceDepletionError</p>
<blockquote>
<p>资源枯竭异常，如果从所有抓取网站都抓不到可用的代理资源，</p>
<p>则抛出此异常。</p>
</blockquote>
</li>
<li><p>class proxypool.error.PoolEmptyError</p>
<blockquote>
<p>代理池空异常，如果代理池长时间为空，则抛出此异常。</p>
</blockquote>
</li>
</ul>
</li>
<li><p>api.py</p>
<blockquote>
<p>API模块，启动一个Web服务器，使用Flask实现，对外提供代理的获取功能。</p>
</blockquote>
</li>
<li><p>utils.py</p>
<blockquote>
<p>工具箱</p>
</blockquote>
</li>
<li><p>setting.py</p>
<blockquote>
<p>设置</p>
</blockquote>
</li>
</ul>
<h2 id="项目参考"><a href="#项目参考" class="headerlink" title="项目参考"></a>项目参考</h2><p><a target="_blank" rel="noopener" href="https://github.com/WiseDoge/ProxyPool">https://github.com/WiseDoge/ProxyPool</a></p>
</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>