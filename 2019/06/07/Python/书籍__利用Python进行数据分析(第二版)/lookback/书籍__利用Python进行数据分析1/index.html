<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;第1-3章&quot;&gt;&lt;a href=&quot;#第1-3章&quot; class=&quot;headerlink&quot; title=&quot;第1-3章&quot;&gt;&lt;/a&gt;第1-3章&lt;/h1&gt;&lt;p&gt;使用zip将两个序列配对组合成字典:"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>利用Python进行数据分析1 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-none-link" href="/tags/Python/" rel="tag">Python</a></div><div class="post-time">2019-06-07</div></div></div><div class="container post-header"><h1>利用Python进行数据分析1</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC1-3%E7%AB%A0"><span class="toc-number">1.</span> <span class="toc-text">第1-3章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0"><span class="toc-number">2.</span> <span class="toc-text">第四章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0"><span class="toc-number">3.</span> <span class="toc-text">第五章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0"><span class="toc-number">4.</span> <span class="toc-text">第六章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC7%E7%AB%A0-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E5%92%8C%E5%87%86%E5%A4%87"><span class="toc-number">5.</span> <span class="toc-text">第7章 数据清洗和准备</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC8%E7%AB%A0-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%EF%BC%9A%E8%81%9A%E5%90%88%E3%80%81%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91"><span class="toc-number">6.</span> <span class="toc-text">第8章 数据规整：聚合、合并和重塑</span></a></li></ol></details></div><div class="container post-content"><h1 id="第1-3章"><a href="#第1-3章" class="headerlink" title="第1-3章"></a>第1-3章</h1><p>使用zip将两个序列配对组合成字典:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">seq1 = [<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;baz&#x27;</span>]</span><br><span class="line">seq2 = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>]</span><br><span class="line"></span><br><span class="line">x = <span class="built_in">dict</span>(<span class="built_in">zip</span>(seq1,seq2))</span><br><span class="line"><span class="built_in">print</span>(x) <span class="comment"># &#123;&#x27;foo&#x27;: &#x27;one&#x27;, &#x27;bar&#x27;: &#x27;two&#x27;, &#x27;baz&#x27;: &#x27;three&#x27;&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="第四章"><a href="#第四章" class="headerlink" title="第四章"></a>第四章</h1><p>数组切片是原始数组的视图。这意味着<strong>数据不会被复制</strong>，视图上的任何修改都会直接反映到源数组上。<br>由于NumPy的设计目的是处理⼤数据，假如NumPy坚持要将数据复制来复制去的话会大量的性能和内存问题。</p>
<hr>
<p>多维数组的索引问题</p>
<ul>
<li><p>切片索引:<br>使用视图</p>
</li>
<li><p>布尔索引:<br>创建数据副本</p>
</li>
<li><p>花式索引:</p>
<p>创建数据副本</p>
</li>
<li><p>数组转置:<br>返回源数据的视图</p>
<p>所谓的花式索引就是==利⽤整数数组进⾏索引==.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.empty((<span class="number">8</span>,<span class="number">4</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    arr[i] = i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[0. 0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [1. 1. 1. 1.]</span></span><br><span class="line"><span class="comment">#  [2. 2. 2. 2.]</span></span><br><span class="line"><span class="comment">#  [3. 3. 3. 3.]</span></span><br><span class="line"><span class="comment">#  [4. 4. 4. 4.]</span></span><br><span class="line"><span class="comment">#  [5. 5. 5. 5.]</span></span><br><span class="line"><span class="comment">#  [6. 6. 6. 6.]</span></span><br><span class="line"><span class="comment">#  [7. 7. 7. 7.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">4</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>]])</span><br><span class="line"><span class="comment"># [[4. 4. 4. 4.]</span></span><br><span class="line"><span class="comment">#  [3. 3. 3. 3.]</span></span><br><span class="line"><span class="comment">#  [0. 0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [6. 6. 6. 6.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[-<span class="number">1</span>,-<span class="number">3</span>,-<span class="number">5</span>,-<span class="number">8</span>]])</span><br><span class="line"><span class="comment"># [[7. 7. 7. 7.]</span></span><br><span class="line"><span class="comment">#  [5. 5. 5. 5.]</span></span><br><span class="line"><span class="comment">#  [3. 3. 3. 3.]</span></span><br><span class="line"><span class="comment">#  [0. 0. 0. 0.]]</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>注意<code>arr[1,2]</code>和<code>arr[[1,2]]</code>的区别:</p>
<ul>
<li><code>arr[1,2]</code>表示<strong>选取第一维度中索引值为1的数据,选区第二维度中索引值为2的数据</strong></li>
<li><code>arr[[1,2]]</code>表示选取第一维度中索引值为1和2的数据</li>
</ul>
<p>简单来说,arr[1,2]是多维度选取,arr[[1,2]]只选择了一个维度</p>
<p>==⼀次传⼊多个索引数组会有⼀点特别。它返回的是⼀个⼀维数组，其中的元素对应各个索引元组==：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">32</span>).reshape((<span class="number">8</span>,<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[ 0  1  2  3]</span></span><br><span class="line"><span class="comment">#  [ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#  [ 8  9 10 11]</span></span><br><span class="line"><span class="comment">#  [12 13 14 15]</span></span><br><span class="line"><span class="comment">#  [16 17 18 19]</span></span><br><span class="line"><span class="comment">#  [20 21 22 23]</span></span><br><span class="line"><span class="comment">#  [24 25 26 27]</span></span><br><span class="line"><span class="comment">#  [28 29 30 31]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [[ 4  5  6  7]</span></span><br><span class="line"><span class="comment">#  [20 21 22 23]</span></span><br><span class="line"><span class="comment">#  [28 29 30 31]</span></span><br><span class="line"><span class="comment">#  [ 8  9 10 11]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>],[<span class="number">1</span>,]])</span><br><span class="line"><span class="comment"># [ 5 21 29  9]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[[<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>],[<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [ 4 23 29 10]</span></span><br></pre></td></tr></table></figure>

<p>也就是说:<br><code>arr[[1,5,7,2],[0,3,1,2]]</code>最终选出的是元素(1,0)、(5,3)、(7,1)和(2,2)。</p>
<p>所以,<code>arr[[1,5,7,2],[1,]]最终选出的是元素(1,1)、(5,1)、(7,1)和(2,1)</code>。</p>
<p>注意<code>z[[1,2]]  [1]</code>和<code>z[[1,2],1]</code>的区别:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 花式索引跟切⽚不⼀样，它总是将数据复制到新数组中。</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">z = np.arange(<span class="number">20</span>).reshape((<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line"><span class="comment"># [[ 0  1  2  3  4]</span></span><br><span class="line"><span class="comment">#  [ 5  6  7  8  9]</span></span><br><span class="line"><span class="comment">#  [10 11 12 13 14]</span></span><br><span class="line"><span class="comment">#  [15 16 17 18 19]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(z[[<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="comment"># [[ 5  6  7  8  9]</span></span><br><span class="line"><span class="comment">#  [10 11 12 13 14]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 花式索引是复制数据的</span></span><br><span class="line"><span class="comment"># 所以[1]会拿第二行数据</span></span><br><span class="line"><span class="built_in">print</span>(z[[<span class="number">1</span>,<span class="number">2</span>]]  [<span class="number">1</span>])</span><br><span class="line"><span class="comment"># [10 11 12 13 14]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [[1,2],1]整体属于花式搜索</span></span><br><span class="line"><span class="comment"># 所以[,1]会拿第二列数据</span></span><br><span class="line"><span class="built_in">print</span>(z[[<span class="number">1</span>,<span class="number">2</span>],<span class="number">1</span>])</span><br><span class="line"><span class="comment"># [ 6 11]</span></span><br></pre></td></tr></table></figure>

<p><code>z[[1,2],1]</code>是取完第一维度和取第二维度的值,<code>z[[1,2]]  [1]</code>是取完第一维度后生成一个narray,对这个narray取第一维度的值</p>
<hr>
<p><code>X.sum(axis=0)</code>就是把第一个轴压缩掉.<br>简单来说,就是==把第一个轴同类的元素全部聚合成一个==</p>
<h1 id="第五章"><a href="#第五章" class="headerlink" title="第五章"></a>第五章</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改index</span></span><br><span class="line">obj2 = Series([<span class="number">4</span>, <span class="number">7</span>, -<span class="number">5</span>, <span class="number">3</span>], index=[<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj2)</span><br><span class="line"><span class="comment"># d    4</span></span><br><span class="line"><span class="comment"># b    7</span></span><br><span class="line"><span class="comment"># a   -5</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2.index)</span><br><span class="line"><span class="comment"># Index([&#x27;d&#x27;, &#x27;b&#x27;, &#x27;a&#x27;, &#x27;c&#x27;], dtype=&#x27;object&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2[<span class="string">&#x27;a&#x27;</span>])  <span class="comment"># -5</span></span><br><span class="line"><span class="built_in">print</span>(obj2.get(<span class="string">&#x27;a&#x27;</span>))  <span class="comment"># -5</span></span><br><span class="line"><span class="built_in">print</span>(obj2.get(<span class="string">&#x27;XXX&#x27;</span>,<span class="string">&#x27;hyl&#x27;</span>))  <span class="comment"># hyl</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2[[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]])</span><br><span class="line"><span class="comment"># a   -5</span></span><br><span class="line"><span class="comment"># d    4</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br></pre></td></tr></table></figure>

<p><code>[&#39;a&#39;,&#39;d&#39;,&#39;c&#39;]</code>被称为<code>索引列表</code></p>
<p>Series其实很像py里的<strong>字典</strong>.</p>
<p>如果只传⼊⼀个字典，则结果Series中的索引就是原字典的键（有序排列）</p>
<hr>
<p>Series对象本身及其索引都有⼀个name属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">states = [<span class="string">&#x27;California&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>]</span><br><span class="line">obj4 = Series(sdata, index=states)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Series的name属性</span></span><br><span class="line">obj4.name = <span class="string">&#x27;population&#x27;</span></span><br><span class="line"><span class="comment"># Series.index的name属性</span></span><br><span class="line">obj4.index.name = <span class="string">&#x27;state&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj4)</span><br><span class="line"><span class="comment"># state</span></span><br><span class="line"><span class="comment"># California        NaN</span></span><br><span class="line"><span class="comment"># Ohio          35000.0</span></span><br><span class="line"><span class="comment"># Oregon        16000.0</span></span><br><span class="line"><span class="comment"># Texas         71000.0</span></span><br><span class="line"><span class="comment"># Name: population, dtype: float64</span></span><br></pre></td></tr></table></figure>



<p>DataFrame可以被看做由Series组成的字典.<br>也就是说,==DataFrame类似于一个字典,这个字典的键列名,字典的值就是Series对象==.</p>
<hr>
<p>⽤标签的切⽚包含上限</p>
<p>dataframe:标签选的是列,切片选的是行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</span><br><span class="line">                    index=[<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Colorado&#x27;</span>, <span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>],</span><br><span class="line">                    columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2     3</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标签选的是列</span></span><br><span class="line"><span class="built_in">print</span>(data[<span class="string">&#x27;one&#x27;</span>])</span><br><span class="line"><span class="comment"># Ohio         0</span></span><br><span class="line"><span class="comment"># Colorado     4</span></span><br><span class="line"><span class="comment"># Utah         8</span></span><br><span class="line"><span class="comment"># New York    12</span></span><br><span class="line"><span class="comment"># Name: one, dtype: int32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切片选取的是行</span></span><br><span class="line"><span class="built_in">print</span>(data[:<span class="number">2</span>])</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2     3</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br></pre></td></tr></table></figure>

<p>⽤loc和iloc进⾏选取</p>
<p>⾏的标签索引:</p>
<ul>
<li>loc:轴标签</li>
<li>iloc:整数索引</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</span><br><span class="line">                    index=[<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Colorado&#x27;</span>, <span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>],</span><br><span class="line">                    columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2     3</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取单行多列</span></span><br><span class="line"><span class="built_in">print</span>(data.loc[<span class="string">&#x27;Colorado&#x27;</span>, [<span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>]])</span><br><span class="line"><span class="comment"># two      5</span></span><br><span class="line"><span class="comment"># three    6</span></span><br><span class="line"><span class="comment"># Name: Colorado, dtype: int32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取多行多列</span></span><br><span class="line"><span class="built_in">print</span>(data.loc[[<span class="string">&#x27;Colorado&#x27;</span>,<span class="string">&#x27;Ohio&#x27;</span>], [<span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>]])</span><br><span class="line"><span class="comment">#           two  three</span></span><br><span class="line"><span class="comment"># Colorado    5      6</span></span><br><span class="line"><span class="comment"># Ohio        1      2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取索引值为2的行,索引值为3,0,1的列</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[<span class="number">2</span>, [<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="comment"># four    11</span></span><br><span class="line"><span class="comment"># one      8</span></span><br><span class="line"><span class="comment"># two      9</span></span><br><span class="line"><span class="comment"># Name: Utah, dtype: int32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取索引值为2的行</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[<span class="number">2</span>])</span><br><span class="line"><span class="comment"># one       8</span></span><br><span class="line"><span class="comment"># two       9</span></span><br><span class="line"><span class="comment"># three    10</span></span><br><span class="line"><span class="comment"># four     11</span></span><br><span class="line"><span class="comment"># Name: Utah, dtype: int32</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取索引值为1,2的行,索引值为3,0,1的列</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="comment">#           four  one  two</span></span><br><span class="line"><span class="comment"># Colorado     7    4    5</span></span><br><span class="line"><span class="comment"># Utah        11    8    9</span></span><br></pre></td></tr></table></figure>



<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">people = [<span class="string">&#x27;hyl&#x27;</span>,<span class="string">&#x27;dsz&#x27;</span>,<span class="string">&#x27;gzr&#x27;</span>,<span class="string">&#x27;czj&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ser = pd.Series(people,index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(ser)</span><br><span class="line"><span class="comment"># 1    hyl</span></span><br><span class="line"><span class="comment"># 2    dsz</span></span><br><span class="line"><span class="comment"># 3    gzr</span></span><br><span class="line"><span class="comment"># 4    czj</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 产生歧义,是选择标签索引的1还是位置索引的1</span></span><br><span class="line"><span class="comment"># 事实上选择的是标签的1</span></span><br><span class="line"><span class="built_in">print</span>(ser[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># hyl</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为了避免歧义,当标签索引是整数时,索引为-1不可用,会发生KeyError</span></span><br><span class="line"><span class="comment"># print(ser[-1])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ser2 = pd.Series(np.arange(<span class="number">1</span>,<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(ser2)</span><br><span class="line"><span class="comment"># 0    1</span></span><br><span class="line"><span class="comment"># 1    2</span></span><br><span class="line"><span class="comment"># 2    3</span></span><br><span class="line"><span class="comment"># 3    4</span></span><br><span class="line"><span class="comment"># dtype: int32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为了避免歧义,当没有标签索引时,索引为-1不可用,会发生KeyError</span></span><br><span class="line"><span class="comment"># print(ser2[-1])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当标签明确不为整数时,索引为-1可用</span></span><br><span class="line">ser3 = pd.Series(np.arange(<span class="number">3.</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(ser3[-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 2.0</span></span><br></pre></td></tr></table></figure>

<p>为了进⾏统⼀，==如果标签索引含有整数，数据选取总会使⽤标签。==</p>
<hr>
<p>如果你希望匹配⾏且在列上⼴播，则必须使⽤<strong>算术运算⽅法</strong>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)),</span><br><span class="line">                     columns=<span class="built_in">list</span>(<span class="string">&#x27;bde&#x27;</span>),</span><br><span class="line">                     index=[<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>])</span><br><span class="line"></span><br><span class="line">series3 = frame[<span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#           b     d     e</span></span><br><span class="line"><span class="comment"># Utah    0.0   1.0   2.0</span></span><br><span class="line"><span class="comment"># Ohio    3.0   4.0   5.0</span></span><br><span class="line"><span class="comment"># Texas   6.0   7.0   8.0</span></span><br><span class="line"><span class="comment"># Oregon  9.0  10.0  11.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(series3)</span><br><span class="line"><span class="comment"># Utah       1.0</span></span><br><span class="line"><span class="comment"># Ohio       4.0</span></span><br><span class="line"><span class="comment"># Texas      7.0</span></span><br><span class="line"><span class="comment"># Oregon    10.0</span></span><br><span class="line"><span class="comment"># Name: d, dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># axis=&#x27;index&#x27;或者axis=0</span></span><br><span class="line"><span class="built_in">print</span>(frame.sub(series3, axis=<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"><span class="comment">#           b    d    e</span></span><br><span class="line"><span class="comment"># Utah   -1.0  0.0  1.0</span></span><br><span class="line"><span class="comment"># Ohio   -1.0  0.0  1.0</span></span><br><span class="line"><span class="comment"># Texas  -1.0  0.0  1.0</span></span><br><span class="line"><span class="comment"># Oregon -1.0  0.0  1.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.sub(series3, axis=<span class="number">1</span>))</span><br><span class="line"><span class="comment">#         Ohio  Oregon  Texas  Utah   b   d   e</span></span><br><span class="line"><span class="comment"># Utah     NaN     NaN    NaN   NaN NaN NaN NaN</span></span><br><span class="line"><span class="comment"># Ohio     NaN     NaN    NaN   NaN NaN NaN NaN</span></span><br><span class="line"><span class="comment"># Texas    NaN     NaN    NaN   NaN NaN NaN NaN</span></span><br><span class="line"><span class="comment"># Oregon   NaN     NaN    NaN   NaN NaN NaN NaN</span></span><br></pre></td></tr></table></figure>

<hr>
<p>applymap函数是DataFrame的元素级应用函数,<br>map函数就是Series的元素级应用函数</p>
<hr>
<h1 id="第六章"><a href="#第六章" class="headerlink" title="第六章"></a>第六章</h1><p>在读取CSV的时候,注意,如果没有使用header参数,那么第一行就会被视为列标签</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># se2.csv没有标题行</span></span><br><span class="line"><span class="built_in">print</span>(pd.read_csv(<span class="string">&#x27;ex2.csv&#x27;</span>))</span><br><span class="line"><span class="comment">#    a  b  c  d  hello</span></span><br><span class="line"><span class="comment"># 0  e  f  g  h  world</span></span><br><span class="line"><span class="comment"># 1  i  j  k  l    foo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为其自动添加默认的列名</span></span><br><span class="line"><span class="built_in">print</span>(pd.read_csv(<span class="string">&#x27;ex2.csv&#x27;</span>,header=<span class="literal">None</span>))</span><br><span class="line"><span class="comment">#    0  1  2  3      4</span></span><br><span class="line"><span class="comment"># 0  a  b  c  d  hello</span></span><br><span class="line"><span class="comment"># 1  e  f  g  h  world</span></span><br><span class="line"><span class="comment"># 2  i  j  k  l    foo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加自定义列名</span></span><br><span class="line">names = (<span class="string">&#x27;c1 c2 c3 c4 c5&#x27;</span>).split()</span><br><span class="line"><span class="built_in">print</span>(pd.read_csv(<span class="string">&#x27;ex2.csv&#x27;</span>,names=names))</span><br><span class="line"><span class="comment">#   c1 c2 c3 c4     c5</span></span><br><span class="line"><span class="comment"># 0  a  b  c  d  hello</span></span><br><span class="line"><span class="comment"># 1  e  f  g  h  world</span></span><br><span class="line"><span class="comment"># 2  i  j  k  l    foo</span></span><br></pre></td></tr></table></figure>

<hr>
<h1 id="第7章-数据清洗和准备"><a href="#第7章-数据清洗和准备" class="headerlink" title="第7章 数据清洗和准备"></a>第7章 数据清洗和准备</h1><p>map, applymap apply的区别:</p>
<ul>
<li>map:<br>Series元素级函数映射</li>
<li>applymap:<br>DataFrame元素级函数映射</li>
<li>apply:<br>DataFrame轴级函数映射</li>
</ul>
<hr>
<h1 id="第8章-数据规整：聚合、合并和重塑"><a href="#第8章-数据规整：聚合、合并和重塑" class="headerlink" title="第8章 数据规整：聚合、合并和重塑"></a>第8章 数据规整：聚合、合并和重塑</h1><p>不能通过传入字典的方式作为index来创建多层索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不能通过传入字典的方式作为index来创建多层索引</span></span><br><span class="line">data = pd.Series(np.random.randn(<span class="number">9</span>),</span><br><span class="line">                 index=&#123;<span class="string">&#x27;a&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],<span class="string">&#x27;b&#x27;</span>:[<span class="number">1</span>,<span class="number">3</span>],<span class="string">&#x27;c&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>],<span class="string">&#x27;d&#x27;</span>:[<span class="number">2</span>,<span class="number">3</span>]&#125;)</span><br><span class="line"><span class="comment"># ValueError: Length of passed values is 9, index implies 4</span></span><br></pre></td></tr></table></figure>

<p>在进⾏列－列连接时，DataFrame对象中的索引会被丢弃。</p>
</div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>