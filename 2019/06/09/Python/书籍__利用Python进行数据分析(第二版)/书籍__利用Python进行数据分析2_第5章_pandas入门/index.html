<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;第5章-pandas入门&quot;&gt;&lt;a href=&quot;#第5章-pandas入门&quot; class=&quot;headerlink&quot; title=&quot;第5章 pandas入门&quot;&gt;&lt;/a&gt;第5章 pandas入门&lt;/h1&gt;&lt;p&gt;pandas与NumPy最大的不同:"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>利用Python进行数据分析2_第5章_pandas入门 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-none-link" href="/tags/Python/" rel="tag">Python</a></div><div class="post-time">2019-06-09</div></div></div><div class="container post-header"><h1>利用Python进行数据分析2_第5章_pandas入门</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC5%E7%AB%A0-pandas%E5%85%A5%E9%97%A8"><span class="toc-number">1.</span> <span class="toc-text">第5章 pandas入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-pandas%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">5.1 pandas的数据结构介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD"><span class="toc-number">1.2.</span> <span class="toc-text">5.2 基本功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3%E6%B1%87%E6%80%BB%E5%92%8C%E8%AE%A1%E7%AE%97%E6%8F%8F%E8%BF%B0%E7%BB%9F%E8%AE%A1"><span class="toc-number">1.3.</span> <span class="toc-text">5.3汇总和计算描述统计</span></a></li></ol></li></ol></details></div><div class="container post-content"><h1 id="第5章-pandas入门"><a href="#第5章-pandas入门" class="headerlink" title="第5章 pandas入门"></a>第5章 pandas入门</h1><p>pandas与NumPy最大的不同:</p>
<ul>
<li>pandas是专⻔为处理表格和混杂数据设计的。</li>
<li>NumPy更适合处理统⼀的数值数组数据。</li>
</ul>
<p>常用的导入约定:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br></pre></td></tr></table></figure>



<h2 id="5-1-pandas的数据结构介绍"><a href="#5-1-pandas的数据结构介绍" class="headerlink" title="5.1 pandas的数据结构介绍"></a>5.1 pandas的数据结构介绍</h2><p>Series:<br>类似于<strong>⼀维数组</strong>的对象，它由⼀组数据（各种NumPy数据类型）以及⼀组与之相关的数据标签（即索引）组成。仅由⼀组数据即可产⽣最简单的Series：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">obj = Series([<span class="number">5</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">1.2</span>,-<span class="number">9</span>])</span><br><span class="line"><span class="comment"># 索引在左边，值在右边</span></span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># 0    5.0</span></span><br><span class="line"><span class="comment"># 1    6.0</span></span><br><span class="line"><span class="comment"># 2    0.0</span></span><br><span class="line"><span class="comment"># 3    1.2</span></span><br><span class="line"><span class="comment"># 4   -9.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># values属性获取数组表示形式</span></span><br><span class="line"><span class="built_in">print</span>(obj.values)</span><br><span class="line"><span class="comment"># [ 5.   6.   0.   1.2 -9. ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># index属性获取数组的索引对象</span></span><br><span class="line"><span class="built_in">print</span>(obj.index)</span><br><span class="line"><span class="comment"># RangeIndex(start=0, stop=5, step=1)</span></span><br></pre></td></tr></table></figure>

<p>修改index值:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改index</span></span><br><span class="line">obj2 = Series([<span class="number">4</span>, <span class="number">7</span>, -<span class="number">5</span>, <span class="number">3</span>], index=[<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj2)</span><br><span class="line"><span class="comment"># d    4</span></span><br><span class="line"><span class="comment"># b    7</span></span><br><span class="line"><span class="comment"># a   -5</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2.index)</span><br><span class="line"><span class="comment"># Index([&#x27;d&#x27;, &#x27;b&#x27;, &#x27;a&#x27;, &#x27;c&#x27;], dtype=&#x27;object&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2[<span class="string">&#x27;a&#x27;</span>])  <span class="comment"># -5</span></span><br><span class="line"><span class="built_in">print</span>(obj2.get(<span class="string">&#x27;a&#x27;</span>))  <span class="comment"># -5</span></span><br><span class="line"><span class="built_in">print</span>(obj2.get(<span class="string">&#x27;XXX&#x27;</span>,<span class="string">&#x27;hyl&#x27;</span>))  <span class="comment"># hyl</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2[[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]])</span><br><span class="line"><span class="comment"># a   -5</span></span><br><span class="line"><span class="comment"># d    4</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br></pre></td></tr></table></figure>

<p><code>[&#39;a&#39;,&#39;d&#39;,&#39;c&#39;]</code>被称为<code>索引列表</code></p>
<p>当get使用索引列表时:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(obj2.get([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]))</span><br><span class="line"><span class="comment"># a   -5</span></span><br><span class="line"><span class="comment"># d    4</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 找不到时返回NaN</span></span><br><span class="line"><span class="comment"># 注意:未来版本找不到时会返回KeyError</span></span><br><span class="line"><span class="built_in">print</span>(obj2.get([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;XX&#x27;</span>]))</span><br><span class="line"><span class="comment"># a    -5.0</span></span><br><span class="line"><span class="comment"># d     4.0</span></span><br><span class="line"><span class="comment"># XX    NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2.get([<span class="string">&#x27;YY&#x27;</span>,<span class="string">&#x27;ZZ&#x27;</span>,<span class="string">&#x27;XX&#x27;</span>]))</span><br><span class="line"><span class="comment"># None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># default参数不起效</span></span><br><span class="line"><span class="built_in">print</span>(obj2.get([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;XXX&#x27;</span>],<span class="string">&#x27;没有&#x27;</span>))</span><br><span class="line"><span class="comment"># a     -5.0</span></span><br><span class="line"><span class="comment"># d      4.0</span></span><br><span class="line"><span class="comment"># XXX    NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>Series能使用使⽤NumPy函数或类似NumPy的运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改index</span></span><br><span class="line">obj2 = Series([<span class="number">4</span>, <span class="number">7</span>, -<span class="number">5</span>, <span class="number">3</span>], index=[<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj2)</span><br><span class="line"><span class="comment"># d    4</span></span><br><span class="line"><span class="comment"># b    7</span></span><br><span class="line"><span class="comment"># a   -5</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2[obj2&gt;<span class="number">0</span>])</span><br><span class="line"><span class="comment"># d    4</span></span><br><span class="line"><span class="comment"># b    7</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2*<span class="number">2</span>)</span><br><span class="line"><span class="comment"># d     8</span></span><br><span class="line"><span class="comment"># b    14</span></span><br><span class="line"><span class="comment"># a   -10</span></span><br><span class="line"><span class="comment"># c     6</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.exp(obj2))</span><br><span class="line"><span class="comment"># d      54.598150</span></span><br><span class="line"><span class="comment"># b    1096.633158</span></span><br><span class="line"><span class="comment"># a       0.006738</span></span><br><span class="line"><span class="comment"># c      20.085537</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>Series其实很像py里的<strong>字典</strong>.</p>
<p>如果只传⼊⼀个字典，则结果Series中的索引就是原字典的键<br>（有序排列）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改index</span></span><br><span class="line">obj2 = Series([<span class="number">4</span>, <span class="number">7</span>, -<span class="number">5</span>, <span class="number">3</span>], index=[<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj2)</span><br><span class="line"><span class="comment"># d    4</span></span><br><span class="line"><span class="comment"># b    7</span></span><br><span class="line"><span class="comment"># a   -5</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检测索引是否在obj2里</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;a&#x27;</span> <span class="keyword">in</span> obj2)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 传入字典创建Series对象</span></span><br><span class="line">aDict = &#123;<span class="string">&#x27;hyl&#x27;</span>:<span class="number">300</span>,<span class="string">&#x27;dsz&#x27;</span>:<span class="number">500</span>,<span class="string">&#x27;czj&#x27;</span>:<span class="number">400</span>&#125;</span><br><span class="line">obj3 = Series(aDict)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj3)</span><br><span class="line"><span class="comment"># hyl    300</span></span><br><span class="line"><span class="comment"># dsz    500</span></span><br><span class="line"><span class="comment"># czj    400</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">states = [<span class="string">&#x27;California&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>]</span><br><span class="line">obj4 = Series(sdata, index=states)</span><br><span class="line"><span class="built_in">print</span>(obj4)</span><br><span class="line"><span class="comment"># California        NaN</span></span><br><span class="line"><span class="comment"># Ohio          35000.0</span></span><br><span class="line"><span class="comment"># Oregon        16000.0</span></span><br><span class="line"><span class="comment"># Texas         71000.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>可以传⼊排好序的字典的键以改变顺序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">states = [<span class="string">&#x27;California&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>]</span><br><span class="line">obj4 = Series(sdata, index=states)</span><br><span class="line"><span class="built_in">print</span>(obj4)</span><br><span class="line"><span class="comment"># California        NaN</span></span><br><span class="line"><span class="comment"># Ohio          35000.0</span></span><br><span class="line"><span class="comment"># Oregon        16000.0</span></span><br><span class="line"><span class="comment"># Texas         71000.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>在这个例⼦中，sdata中跟states索引相匹配的那3个值会被找出来并放到相应的位置上，但由于<code>California</code>所对应的sdata值找不到，所以其结果就为NaN.因为<code>Utah</code>不在states中，它被从结果中除去。</p>
<p>使用isnull和notnull判断是否为空:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">states = [<span class="string">&#x27;California&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>]</span><br><span class="line">obj4 = Series(sdata, index=states)</span><br><span class="line"><span class="built_in">print</span>(obj4)</span><br><span class="line"><span class="comment"># California        NaN</span></span><br><span class="line"><span class="comment"># Ohio          35000.0</span></span><br><span class="line"><span class="comment"># Oregon        16000.0</span></span><br><span class="line"><span class="comment"># Texas         71000.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pd.isnull(obj4))</span><br><span class="line"><span class="comment"># California     True</span></span><br><span class="line"><span class="comment"># Ohio          False</span></span><br><span class="line"><span class="comment"># Oregon        False</span></span><br><span class="line"><span class="comment"># Texas         False</span></span><br><span class="line"><span class="comment"># dtype: bool</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pd.notnull(obj4))</span><br><span class="line"><span class="comment"># California    False</span></span><br><span class="line"><span class="comment"># Ohio           True</span></span><br><span class="line"><span class="comment"># Oregon         True</span></span><br><span class="line"><span class="comment"># Texas          True</span></span><br><span class="line"><span class="comment"># dtype: bool</span></span><br></pre></td></tr></table></figure>

<p>Series也有类似方法<code>obj4.isnull()</code>,<code>obj4.notnull()</code></p>
<p>Series最重要的⼀个功能是，它会根据运算的索引标签⾃动对⻬数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">obj3 = pd.Series(sdata)</span><br><span class="line"></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">states = [<span class="string">&#x27;California&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>]</span><br><span class="line">obj4 = Series(sdata, index=states)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj3)</span><br><span class="line"><span class="comment"># Ohio      35000</span></span><br><span class="line"><span class="comment"># Texas     71000</span></span><br><span class="line"><span class="comment"># Oregon    16000</span></span><br><span class="line"><span class="comment"># Utah       5000</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj4)</span><br><span class="line"><span class="comment"># California        NaN</span></span><br><span class="line"><span class="comment"># Ohio          35000.0</span></span><br><span class="line"><span class="comment"># Oregon        16000.0</span></span><br><span class="line"><span class="comment"># Texas         71000.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj3 + obj4)</span><br><span class="line"><span class="comment"># California         NaN</span></span><br><span class="line"><span class="comment"># Ohio           70000.0</span></span><br><span class="line"><span class="comment"># Oregon         32000.0</span></span><br><span class="line"><span class="comment"># Texas         142000.0</span></span><br><span class="line"><span class="comment"># Utah               NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>我们发现,只要obj3和obj4同时都拥有某个索引的情况下才会自动对齐计算,否则返回NaN.<br>==可以认为是类似数据库inner join的操作==。</p>
<p>Series对象本身及其索引都有⼀个name属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">states = [<span class="string">&#x27;California&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>]</span><br><span class="line">obj4 = Series(sdata, index=states)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Series的name属性</span></span><br><span class="line">obj4.name = <span class="string">&#x27;population&#x27;</span></span><br><span class="line"><span class="comment"># Series.index的name属性</span></span><br><span class="line">obj4.index.name = <span class="string">&#x27;state&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj4)</span><br><span class="line"><span class="comment"># state</span></span><br><span class="line"><span class="comment"># California        NaN</span></span><br><span class="line"><span class="comment"># Ohio          35000.0</span></span><br><span class="line"><span class="comment"># Oregon        16000.0</span></span><br><span class="line"><span class="comment"># Texas         71000.0</span></span><br><span class="line"><span class="comment"># Name: population, dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>Series的索引可以通过赋值的⽅式就地修改：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">obj = Series([<span class="number">5</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">1.2</span>,-<span class="number">9</span>])</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># 0    5.0</span></span><br><span class="line"><span class="comment"># 1    6.0</span></span><br><span class="line"><span class="comment"># 2    0.0</span></span><br><span class="line"><span class="comment"># 3    1.2</span></span><br><span class="line"><span class="comment"># 4   -9.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line">obj.index = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># a    5.0</span></span><br><span class="line"><span class="comment"># b    6.0</span></span><br><span class="line"><span class="comment"># c    0.0</span></span><br><span class="line"><span class="comment"># d    1.2</span></span><br><span class="line"><span class="comment"># e   -9.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<hr>
<p>DataFrame<br>DataFrame是⼀个<strong>表格型</strong>的数据结构，它含有⼀组有序的列，<strong>每列</strong>可以是不同的值类型（数值、字符串、布尔值等）。</p>
<p>DataFrame既有⾏索引也有列索引，==DataFrame可以被看做由Series组成的字典==（共⽤同⼀个索引）。<br>所以说,DataFrame是以⼆维结构保存数据的.</p>
<p>创建DataFrame:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line"><span class="comment"># 传入等长列表</span></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],</span><br><span class="line">        <span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line">frame = DataFrame(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 就像Series一样,所有的行都会自动添加索引</span></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#     state  year  pop</span></span><br><span class="line"><span class="comment"># 0    Ohio  2000  1.5</span></span><br><span class="line"><span class="comment"># 1    Ohio  2001  1.7</span></span><br><span class="line"><span class="comment"># 2    Ohio  2002  3.6</span></span><br><span class="line"><span class="comment"># 3  Nevada  2001  2.4</span></span><br><span class="line"><span class="comment"># 4  Nevada  2002  2.9</span></span><br><span class="line"><span class="comment"># 5  Nevada  2003  3.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># head⽅法会选取前五⾏：</span></span><br><span class="line"><span class="built_in">print</span>(frame.head())</span><br><span class="line"><span class="comment">#     state  year  pop</span></span><br><span class="line"><span class="comment"># 0    Ohio  2000  1.5</span></span><br><span class="line"><span class="comment"># 1    Ohio  2001  1.7</span></span><br><span class="line"><span class="comment"># 2    Ohio  2002  3.6</span></span><br><span class="line"><span class="comment"># 3  Nevada  2001  2.4</span></span><br><span class="line"><span class="comment"># 4  Nevada  2002  2.9</span></span><br></pre></td></tr></table></figure>

<p>就像Series指定index,就会按照index的顺序排列.<br>如果指定了列序列，则DataFrame的列就会按照指定顺序进⾏排列：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">states = [<span class="string">&#x27;California&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>]</span><br><span class="line">obj4 = Series(sdata, index=states)</span><br><span class="line"><span class="built_in">print</span>(obj4)</span><br><span class="line"><span class="comment"># California        NaN</span></span><br><span class="line"><span class="comment"># Ohio          35000.0</span></span><br><span class="line"><span class="comment"># Oregon        16000.0</span></span><br><span class="line"><span class="comment"># Texas         71000.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],</span><br><span class="line">        <span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line"></span><br><span class="line">frame = DataFrame(data, columns=[<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;state&#x27;</span>,<span class="string">&#x27;debt&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#    year   state debt</span></span><br><span class="line"><span class="comment"># 0  2000    Ohio  NaN</span></span><br><span class="line"><span class="comment"># 1  2001    Ohio  NaN</span></span><br><span class="line"><span class="comment"># 2  2002    Ohio  NaN</span></span><br><span class="line"><span class="comment"># 3  2001  Nevada  NaN</span></span><br><span class="line"><span class="comment"># 4  2002  Nevada  NaN</span></span><br><span class="line"><span class="comment"># 5  2003  Nevada  NaN</span></span><br></pre></td></tr></table></figure>

<p>上面代码,砍掉了字段pop,所以frame就没有了这个字段.同时添加了新的debt字段,这个传入的列在数据中找不到,就会在结果中产生缺失值NaN</p>
<p>上面使用columns指定了列名,还可以使用index指定行名:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],</span><br><span class="line">        <span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line"></span><br><span class="line">frame2 = pd.DataFrame(data, </span><br><span class="line">                      columns=[<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;state&#x27;</span>, <span class="string">&#x27;pop&#x27;</span>, <span class="string">&#x27;debt&#x27;</span>],</span><br><span class="line">                      index=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>,<span class="string">&#x27;five&#x27;</span>, <span class="string">&#x27;six&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state  pop debt</span></span><br><span class="line"><span class="comment"># one    2000    Ohio  1.5  NaN</span></span><br><span class="line"><span class="comment"># two    2001    Ohio  1.7  NaN</span></span><br><span class="line"><span class="comment"># three  2002    Ohio  3.6  NaN</span></span><br><span class="line"><span class="comment"># four   2001  Nevada  2.4  NaN</span></span><br><span class="line"><span class="comment"># five   2002  Nevada  2.9  NaN</span></span><br><span class="line"><span class="comment"># six    2003  Nevada  3.2  NaN</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame2.columns)</span><br><span class="line"><span class="comment"># Index([&#x27;year&#x27;, &#x27;state&#x27;, &#x27;pop&#x27;, &#x27;debt&#x27;], dtype=&#x27;object&#x27;)</span></span><br></pre></td></tr></table></figure>



<p>刚刚说过:DataFrame可以被看做由Series组成的字典.<br>也就是说,==DataFrame类似于一个字典,这个字典的键列名,字典的值就是Series对象==.<br>所以我们可以根据列名获取DataFrame的Series对象:</p>
<ul>
<li>frame[‘year’]方式</li>
<li>frame.year点号方式</li>
<li>frame.get(‘year’)方式</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],</span><br><span class="line">        <span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line"></span><br><span class="line">frame = DataFrame(data, columns=[<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;state&#x27;</span>,<span class="string">&#x27;debt&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.year)</span><br><span class="line"><span class="comment"># 0    2000</span></span><br><span class="line"><span class="comment"># 1    2001</span></span><br><span class="line"><span class="comment"># 2    2002</span></span><br><span class="line"><span class="comment"># 3    2001</span></span><br><span class="line"><span class="comment"># 4    2002</span></span><br><span class="line"><span class="comment"># 5    2003</span></span><br><span class="line"><span class="comment"># Name: year, dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.get(<span class="string">&#x27;state&#x27;</span>))</span><br><span class="line"><span class="comment"># 0      Ohio</span></span><br><span class="line"><span class="comment"># 1      Ohio</span></span><br><span class="line"><span class="comment"># 2      Ohio</span></span><br><span class="line"><span class="comment"># 3    Nevada</span></span><br><span class="line"><span class="comment"># 4    Nevada</span></span><br><span class="line"><span class="comment"># 5    Nevada</span></span><br><span class="line"><span class="comment"># Name: state, dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame[<span class="string">&#x27;year&#x27;</span>])</span><br><span class="line"><span class="comment"># 0    2000</span></span><br><span class="line"><span class="comment"># 1    2001</span></span><br><span class="line"><span class="comment"># 2    2002</span></span><br><span class="line"><span class="comment"># 3    2001</span></span><br><span class="line"><span class="comment"># 4    2002</span></span><br><span class="line"><span class="comment"># 5    2003</span></span><br><span class="line"><span class="comment"># Name: year, dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 同理能使用frame.state[:2],frame.get(&#x27;state&#x27;)[:2]</span></span><br><span class="line"><span class="built_in">print</span>(frame[<span class="string">&#x27;year&#x27;</span>][:<span class="number">2</span>])</span><br><span class="line"><span class="comment"># 0    2000</span></span><br><span class="line"><span class="comment"># 1    2001</span></span><br><span class="line"><span class="comment"># Name: year, dtype: int64</span></span><br></pre></td></tr></table></figure>

<p>上面的方法是获取列,那么如何获取行呢?<br>使用loc属性:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],</span><br><span class="line">        <span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line"></span><br><span class="line">frame2 = pd.DataFrame(data, </span><br><span class="line">                      columns=[<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;state&#x27;</span>, <span class="string">&#x27;pop&#x27;</span>, <span class="string">&#x27;debt&#x27;</span>],</span><br><span class="line">                      index=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>,<span class="string">&#x27;five&#x27;</span>, <span class="string">&#x27;six&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state  pop debt</span></span><br><span class="line"><span class="comment"># one    2000    Ohio  1.5  NaN</span></span><br><span class="line"><span class="comment"># two    2001    Ohio  1.7  NaN</span></span><br><span class="line"><span class="comment"># three  2002    Ohio  3.6  NaN</span></span><br><span class="line"><span class="comment"># four   2001  Nevada  2.4  NaN</span></span><br><span class="line"><span class="comment"># five   2002  Nevada  2.9  NaN</span></span><br><span class="line"><span class="comment"># six    2003  Nevada  3.2  NaN</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame2.loc[<span class="string">&#x27;three&#x27;</span>])</span><br><span class="line"><span class="comment"># year     2002</span></span><br><span class="line"><span class="comment"># state    Ohio</span></span><br><span class="line"><span class="comment"># pop       3.6</span></span><br><span class="line"><span class="comment"># debt      NaN</span></span><br><span class="line"><span class="comment"># Name: three, dtype: object</span></span><br></pre></td></tr></table></figure>

<p>注意，返回的Series拥有原DataFrame相同的索引，且其name属性也已经被相应地设置好了。</p>
<p>也就是说,如果想用索引,不能像py的列表一样直接使用<code>frame[&#39;year&#39;][2]</code>,这里的<code>2</code>是DataFrame的<code>行索引</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],</span><br><span class="line">        <span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line"></span><br><span class="line">frame2 = pd.DataFrame(data, </span><br><span class="line">                      columns=[<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;state&#x27;</span>, <span class="string">&#x27;pop&#x27;</span>, <span class="string">&#x27;debt&#x27;</span>],</span><br><span class="line">                      index=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>,<span class="string">&#x27;five&#x27;</span>, <span class="string">&#x27;six&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state  pop debt</span></span><br><span class="line"><span class="comment"># one    2000    Ohio  1.5  NaN</span></span><br><span class="line"><span class="comment"># two    2001    Ohio  1.7  NaN</span></span><br><span class="line"><span class="comment"># three  2002    Ohio  3.6  NaN</span></span><br><span class="line"><span class="comment"># four   2001  Nevada  2.4  NaN</span></span><br><span class="line"><span class="comment"># five   2002  Nevada  2.9  NaN</span></span><br><span class="line"><span class="comment"># six    2003  Nevada  3.2  NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先列后行</span></span><br><span class="line"><span class="built_in">print</span>(frame2[<span class="string">&#x27;year&#x27;</span>][<span class="string">&#x27;one&#x27;</span>])         <span class="comment"># 2000</span></span><br><span class="line"><span class="built_in">print</span>(frame2.get(<span class="string">&#x27;year&#x27;</span>)[<span class="string">&#x27;five&#x27;</span>])    <span class="comment"># 2002</span></span><br><span class="line"><span class="built_in">print</span>(frame2.year.loc[<span class="string">&#x27;six&#x27;</span>])        <span class="comment"># 2003</span></span><br><span class="line"><span class="built_in">print</span>(frame2.year.six)               <span class="comment"># 2003</span></span><br><span class="line"><span class="built_in">print</span>(frame2.get(<span class="string">&#x27;year&#x27;</span>).get(<span class="string">&#x27;five&#x27;</span>))<span class="comment"># 2002</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先行后列</span></span><br><span class="line"><span class="built_in">print</span>(frame2.loc[<span class="string">&#x27;six&#x27;</span>].year)        <span class="comment"># 2003</span></span><br><span class="line"><span class="built_in">print</span>(frame2.loc[<span class="string">&#x27;six&#x27;</span>][<span class="string">&#x27;year&#x27;</span>])     <span class="comment"># 2003</span></span><br><span class="line"><span class="built_in">print</span>(frame2.loc[<span class="string">&#x27;six&#x27;</span>].get(<span class="string">&#x27;year&#x27;</span>)) <span class="comment"># 2003</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先行后列必须使用.loc[&#x27;six&#x27;],其他的不行,下面都会出错</span></span><br><span class="line"><span class="comment"># print(frame2.six.year)               </span></span><br><span class="line"><span class="comment"># print(frame2[&#x27;one&#x27;][&#x27;year&#x27;])         </span></span><br><span class="line"><span class="comment"># print(frame2.get(&#x27;five&#x27;).get(&#x27;year&#x27;))</span></span><br></pre></td></tr></table></figure>

<p>总结获取行和列的方法:</p>
<ul>
<li>获取列:<ol>
<li>frame.year</li>
<li>frame.get(‘year’)</li>
<li>frame[‘year’]</li>
</ol>
</li>
<li>获取行:<ol>
<li>frame.loc[‘six’]</li>
<li>frame[‘six’]</li>
<li>frame.get(‘six’)</li>
<li>frame.six</li>
</ol>
</li>
</ul>
<p>可以先获取行再获取列,也可以先获取列再获取行.<br>==如果先获取行再获取列,那么获取行时必须使用<code>frame.loc[&#39;six&#39;]</code>==</p>
<p>DateFrame的值都是可读可写:<br>我们可以修改列,修改行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],</span><br><span class="line">        <span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line"></span><br><span class="line">frame2 = pd.DataFrame(data, </span><br><span class="line">                      columns=[<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;state&#x27;</span>, <span class="string">&#x27;pop&#x27;</span>, <span class="string">&#x27;debt&#x27;</span>],</span><br><span class="line">                      index=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>,<span class="string">&#x27;five&#x27;</span>, <span class="string">&#x27;six&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state  pop debt</span></span><br><span class="line"><span class="comment"># one    2000    Ohio  1.5  NaN</span></span><br><span class="line"><span class="comment"># two    2001    Ohio  1.7  NaN</span></span><br><span class="line"><span class="comment"># three  2002    Ohio  3.6  NaN</span></span><br><span class="line"><span class="comment"># four   2001  Nevada  2.4  NaN</span></span><br><span class="line"><span class="comment"># five   2002  Nevada  2.9  NaN</span></span><br><span class="line"><span class="comment"># six    2003  Nevada  3.2  NaN</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改列</span></span><br><span class="line">frame2[<span class="string">&#x27;debt&#x27;</span>] = <span class="number">16.5</span></span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state  pop  debt</span></span><br><span class="line"><span class="comment"># one    2000    Ohio  1.5  16.5</span></span><br><span class="line"><span class="comment"># two    2001    Ohio  1.7  16.5</span></span><br><span class="line"><span class="comment"># three  2002    Ohio  3.6  16.5</span></span><br><span class="line"><span class="comment"># four   2001  Nevada  2.4  16.5</span></span><br><span class="line"><span class="comment"># five   2002  Nevada  2.9  16.5</span></span><br><span class="line"><span class="comment"># six    2003  Nevada  3.2  16.5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">frame2[<span class="string">&#x27;debt&#x27;</span>] = np.arange(<span class="number">6.</span>)</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state  pop  debt</span></span><br><span class="line"><span class="comment"># one    2000    Ohio  1.5   0.0</span></span><br><span class="line"><span class="comment"># two    2001    Ohio  1.7   1.0</span></span><br><span class="line"><span class="comment"># three  2002    Ohio  3.6   2.0</span></span><br><span class="line"><span class="comment"># four   2001  Nevada  2.4   3.0</span></span><br><span class="line"><span class="comment"># five   2002  Nevada  2.9   4.0</span></span><br><span class="line"><span class="comment"># six    2003  Nevada  3.2   5.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改行</span></span><br><span class="line">aDict = &#123;<span class="string">&#x27;year&#x27;</span>:<span class="number">9999</span>,<span class="string">&#x27;state&#x27;</span>:<span class="string">&#x27;9999&#x27;</span>,<span class="string">&#x27;pop&#x27;</span>:<span class="number">9999</span>,<span class="string">&#x27;debt&#x27;</span>:<span class="number">9999</span>&#125;</span><br><span class="line">row = pd.Series(aDict)</span><br><span class="line">frame2.loc[<span class="string">&#x27;one&#x27;</span>] = row</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state     pop    debt</span></span><br><span class="line"><span class="comment"># one    9999    9999  9999.0  9999.0</span></span><br><span class="line"><span class="comment"># two    2001    Ohio     1.7     1.0</span></span><br><span class="line"><span class="comment"># three  2002    Ohio     3.6     2.0</span></span><br><span class="line"><span class="comment"># four   2001  Nevada     2.4     3.0</span></span><br><span class="line"><span class="comment"># five   2002  Nevada     2.9     4.0</span></span><br><span class="line"><span class="comment"># six    2003  Nevada     3.2     5.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用index精确匹配某行.</span></span><br><span class="line"><span class="comment"># 如果长度和DataFrame的⻓度不一致,那么所有的空行都将被填上缺失值</span></span><br><span class="line">val = pd.Series([-<span class="number">1.2</span>, -<span class="number">1.5</span>, -<span class="number">1.7</span>], index=[<span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;four&#x27;</span>, <span class="string">&#x27;five&#x27;</span>])</span><br><span class="line">frame2[<span class="string">&#x27;debt&#x27;</span>] = val</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state     pop  debt</span></span><br><span class="line"><span class="comment"># one    9999    9999  9999.0   NaN</span></span><br><span class="line"><span class="comment"># two    2001    Ohio     1.7  -1.2</span></span><br><span class="line"><span class="comment"># three  2002    Ohio     3.6   NaN</span></span><br><span class="line"><span class="comment"># four   2001  Nevada     2.4  -1.5</span></span><br><span class="line"><span class="comment"># five   2002  Nevada     2.9  -1.7</span></span><br><span class="line"><span class="comment"># six    2003  Nevada     3.2   NaN</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为不存在的列赋值会创建出一个新列</span></span><br><span class="line">frame2[<span class="string">&#x27;eastern&#x27;</span>] = (frame2.state == <span class="string">&#x27;Ohio&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state     pop  debt  eastern</span></span><br><span class="line"><span class="comment"># one    9999    9999  9999.0   NaN    False</span></span><br><span class="line"><span class="comment"># two    2001    Ohio     1.7  -1.2     True</span></span><br><span class="line"><span class="comment"># three  2002    Ohio     3.6   NaN     True</span></span><br><span class="line"><span class="comment"># four   2001  Nevada     2.4  -1.5    False</span></span><br><span class="line"><span class="comment"># five   2002  Nevada     2.9  -1.7    False</span></span><br><span class="line"><span class="comment"># six    2003  Nevada     3.2   NaN    False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用del方法删除列</span></span><br><span class="line"><span class="keyword">del</span> frame2[<span class="string">&#x27;eastern&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state     pop  debt</span></span><br><span class="line"><span class="comment"># one    9999    9999  9999.0   NaN</span></span><br><span class="line"><span class="comment"># two    2001    Ohio     1.7  -1.2</span></span><br><span class="line"><span class="comment"># three  2002    Ohio     3.6   NaN</span></span><br><span class="line"><span class="comment"># four   2001  Nevada     2.4  -1.5</span></span><br><span class="line"><span class="comment"># five   2002  Nevada     2.9  -1.7</span></span><br><span class="line"><span class="comment"># six    2003  Nevada     3.2   NaN</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改行索引</span></span><br><span class="line">frame2.index = [<span class="string">&#x27;(1)&#x27;</span>, <span class="string">&#x27;(2)&#x27;</span>, <span class="string">&#x27;(3)&#x27;</span>, <span class="string">&#x27;(4)&#x27;</span>,<span class="string">&#x27;(5)&#x27;</span>, <span class="string">&#x27;(6)&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#      year   state     pop  debt</span></span><br><span class="line"><span class="comment"># (1)  9999    9999  9999.0   NaN</span></span><br><span class="line"><span class="comment"># (2)  2001    Ohio     1.7  -1.2</span></span><br><span class="line"><span class="comment"># (3)  2002    Ohio     3.6   NaN</span></span><br><span class="line"><span class="comment"># (4)  2001  Nevada     2.4  -1.5</span></span><br><span class="line"><span class="comment"># (5)  2002  Nevada     2.9  -1.7</span></span><br><span class="line"><span class="comment"># (6)  2003  Nevada     3.2   NaN</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改列索引</span></span><br><span class="line">frame2.columns = [<span class="string">&#x27;(year)&#x27;</span>, <span class="string">&#x27;(state)&#x27;</span>, <span class="string">&#x27;(pop)&#x27;</span>, <span class="string">&#x27;(debt)&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#      (year) (state)   (pop)  (debt)</span></span><br><span class="line"><span class="comment"># (1)    9999    9999  9999.0     NaN</span></span><br><span class="line"><span class="comment"># (2)    2001    Ohio     1.7    -1.2</span></span><br><span class="line"><span class="comment"># (3)    2002    Ohio     3.6     NaN</span></span><br><span class="line"><span class="comment"># (4)    2001  Nevada     2.4    -1.5</span></span><br><span class="line"><span class="comment"># (5)    2002  Nevada     2.9    -1.7</span></span><br><span class="line"><span class="comment"># (6)    2003  Nevada     3.2     NaN</span></span><br></pre></td></tr></table></figure>

<p>注意:</p>
<ul>
<li>eastern是新建的列,所以不能再⽤frame2.eastern创建新的列。</li>
<li>通过索引⽅式返回的列是相应数据的<strong>视图</strong>，并不是副本。因此，对返回的Series所做的任何就地修改全都会反映到源DataFrame上。通过Series的copy⽅法即可指定复制列。</li>
</ul>
<p>如果嵌套字典传给DataFrame，pandas就会被解释为：<br><strong>外层字典的键作为列，内层键则作为⾏索引</strong><br>(缺失值就会被填充为NaN)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop = &#123;<span class="string">&#x27;col1&#x27;</span>: &#123;<span class="string">&#x27;row1&#x27;</span>: <span class="number">2.4</span>, <span class="string">&#x27;row2&#x27;</span>: <span class="number">2</span>&#125;,</span><br><span class="line">       <span class="string">&#x27;col2&#x27;</span>: &#123;<span class="string">&#x27;row1&#x27;</span>: <span class="number">1.7</span>, <span class="string">&#x27;row2&#x27;</span>: <span class="number">3.6</span>,<span class="string">&#x27;row3&#x27;</span>: <span class="number">1.5</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">frame3 = pd.DataFrame(pop)</span><br><span class="line"><span class="built_in">print</span>(frame3)</span><br><span class="line"><span class="comment">#       col1  col2</span></span><br><span class="line"><span class="comment"># row1   2.4   1.7</span></span><br><span class="line"><span class="comment"># row2   2.0   3.6</span></span><br><span class="line"><span class="comment"># row3   NaN   1.5</span></span><br></pre></td></tr></table></figure>

<p>转置DateFrame:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(frame3.T)</span><br><span class="line"><span class="comment">#       row1  row2  row3</span></span><br><span class="line"><span class="comment"># col1   2.4   2.0   NaN</span></span><br><span class="line"><span class="comment"># col2   1.7   3.6   1.5</span></span><br></pre></td></tr></table></figure>



<p>DataFrame构造函数所能接受的各种数据</p>
<p><img src="/images/6874701.png" alt="6874701"></p>
<p>就像Series的indx属性具有那么属性一样.<br>DataFrame本身和index,columns属性也有name属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">pop = &#123;<span class="string">&#x27;Nevada&#x27;</span>:            &#123;<span class="number">2001</span>: <span class="number">2.4</span>, <span class="number">2002</span>: <span class="number">2.9</span>&#125;,</span><br><span class="line">         <span class="string">&#x27;Ohio&#x27;</span>: &#123;<span class="number">2000</span>: <span class="number">1.5</span>, <span class="number">2001</span>: <span class="number">1.7</span>, <span class="number">2002</span>: <span class="number">3.6</span>&#125;&#125;</span><br><span class="line">frame3 = pd.DataFrame(pop)</span><br><span class="line"><span class="built_in">print</span>(frame3)</span><br><span class="line"><span class="comment">#       Nevada  Ohio</span></span><br><span class="line"><span class="comment"># 2000     NaN   1.5</span></span><br><span class="line"><span class="comment"># 2001     2.4   1.7</span></span><br><span class="line"><span class="comment"># 2002     2.9   3.6</span></span><br><span class="line"></span><br><span class="line">frame3.index.name = <span class="string">&#x27;year&#x27;</span></span><br><span class="line">frame3.columns.name = <span class="string">&#x27;state&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(frame3)</span><br><span class="line"><span class="comment"># state  Nevada  Ohio</span></span><br><span class="line"><span class="comment"># year               </span></span><br><span class="line"><span class="comment"># 2000      NaN   1.5</span></span><br><span class="line"><span class="comment"># 2001      2.4   1.7</span></span><br><span class="line"><span class="comment"># 2002      2.9   3.6</span></span><br></pre></td></tr></table></figure>



<p>跟Series⼀样，values属性也会以⼆维ndarray的形式返回DataFrame中的数据：<br>如果DataFrame各列的数据类型不同，则值数组的dtype就会选⽤能兼容所有列的数据类型：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],</span><br><span class="line">        <span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line"></span><br><span class="line">frame2 = pd.DataFrame(data, </span><br><span class="line">                      columns=[<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;state&#x27;</span>, <span class="string">&#x27;pop&#x27;</span>, <span class="string">&#x27;debt&#x27;</span>],</span><br><span class="line">                      index=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>,<span class="string">&#x27;five&#x27;</span>, <span class="string">&#x27;six&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#        year   state  pop debt</span></span><br><span class="line"><span class="comment"># one    2000    Ohio  1.5  NaN</span></span><br><span class="line"><span class="comment"># two    2001    Ohio  1.7  NaN</span></span><br><span class="line"><span class="comment"># three  2002    Ohio  3.6  NaN</span></span><br><span class="line"><span class="comment"># four   2001  Nevada  2.4  NaN</span></span><br><span class="line"><span class="comment"># five   2002  Nevada  2.9  NaN</span></span><br><span class="line"><span class="comment"># six    2003  Nevada  3.2  NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回二维ndarray</span></span><br><span class="line"><span class="built_in">print</span>(frame2.values)</span><br><span class="line"><span class="comment"># [[2000 &#x27;Ohio&#x27; 1.5 nan]</span></span><br><span class="line"><span class="comment">#  [2001 &#x27;Ohio&#x27; 1.7 nan]</span></span><br><span class="line"><span class="comment">#  [2002 &#x27;Ohio&#x27; 3.6 nan]</span></span><br><span class="line"><span class="comment">#  [2001 &#x27;Nevada&#x27; 2.4 nan]</span></span><br><span class="line"><span class="comment">#  [2002 &#x27;Nevada&#x27; 2.9 nan]</span></span><br><span class="line"><span class="comment">#  [2003 &#x27;Nevada&#x27; 3.2 nan]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># dtypes会变成能兼容所有列的数据类型：</span></span><br><span class="line"><span class="built_in">print</span>(frame2.dtypes)</span><br><span class="line"><span class="comment"># dtype: object</span></span><br></pre></td></tr></table></figure>



<p>索引对象</p>
<p>pandas的索引对象负责管理轴标签和其他元数据（⽐如轴名称等）。<br>构建Series或DataFrame时，所⽤到的任何数组或其他序列的标签都会被转换成⼀个Index.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">obj = pd.Series(<span class="built_in">range</span>(<span class="number">3</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line">a = obj.index</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># Index([&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;], dtype=&#x27;object&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(a))</span><br><span class="line"><span class="comment"># &lt;class &#x27;pandas.core.indexes.base.Index&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>:])</span><br><span class="line"><span class="comment"># Index([&#x27;b&#x27;, &#x27;c&#x27;], dtype=&#x27;object&#x27;)</span></span><br></pre></td></tr></table></figure>

<p><strong>Index对象是不可变的</strong>,这使Index对象能在多个数据结构之间安全共享：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个Index对象</span></span><br><span class="line">obj = pd.Series(<span class="built_in">range</span>(<span class="number">3</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line">obj_index = obj.index</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Index对象不可改变,发生TypeError</span></span><br><span class="line"><span class="comment"># a[1] = &#x27;d&#x27;  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将已经有的Index对象传给Series对象</span></span><br><span class="line">obj2 = pd.Series([<span class="number">1.5</span>, -<span class="number">2.5</span>, <span class="number">0</span>], index=obj_index)</span><br><span class="line"><span class="built_in">print</span>(obj2)</span><br><span class="line"><span class="comment"># a    1.5</span></span><br><span class="line"><span class="comment"># b   -2.5</span></span><br><span class="line"><span class="comment"># c    0.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj2.index <span class="keyword">is</span> obj_index)</span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure>

<p>DataFrame的columns其实就是Index对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">pop = &#123;<span class="string">&#x27;Nevada&#x27;</span>: &#123;<span class="number">2001</span>: <span class="number">2.4</span>, <span class="number">2002</span>: <span class="number">2.9</span>&#125;,</span><br><span class="line">       <span class="string">&#x27;Ohio&#x27;</span>: &#123;<span class="number">2000</span>: <span class="number">1.5</span>, <span class="number">2001</span>: <span class="number">1.7</span>, <span class="number">2002</span>: <span class="number">3.6</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">frame3 = pd.DataFrame(pop)</span><br><span class="line"><span class="built_in">print</span>(frame3)</span><br><span class="line"><span class="comment">#       Nevada  Ohio</span></span><br><span class="line"><span class="comment"># 2000     NaN   1.5</span></span><br><span class="line"><span class="comment"># 2001     2.4   1.7</span></span><br><span class="line"><span class="comment"># 2002     2.9   3.6</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame3.columns)</span><br><span class="line"><span class="comment"># Index([&#x27;Nevada&#x27;, &#x27;Ohio&#x27;], dtype=&#x27;object&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Ohio&#x27;</span> <span class="keyword">in</span> frame3.columns)</span><br><span class="line"><span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="number">2002</span> <span class="keyword">in</span> frame3.index)</span><br><span class="line"><span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="number">2003</span> <span class="keyword">in</span> frame3.index)</span><br><span class="line"><span class="comment"># False</span></span><br></pre></td></tr></table></figure>

<p>Index可以包含重复的标签：选择重复的标签，会显示所有的结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建含有重复标签的Index</span></span><br><span class="line">dup_labels = pd.Index([<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(dup_labels)</span><br><span class="line"><span class="comment"># Index([&#x27;foo&#x27;, &#x27;foo&#x27;, &#x27;bar&#x27;, &#x27;bar&#x27;], dtype=&#x27;object&#x27;)</span></span><br></pre></td></tr></table></figure>

<p>Index的方法和属性</p>
<p><img src="/images/68747537.jpg" alt="68747537"></p>
<hr>
<h2 id="5-2-基本功能"><a href="#5-2-基本功能" class="headerlink" title="5.2 基本功能"></a>5.2 基本功能</h2><p>操作Series和DataFrame中的数据的基本⼿段。</p>
<p>重新索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">obj = pd.Series([<span class="number">4.5</span>, <span class="number">7.2</span>, -<span class="number">5.3</span>, <span class="number">3.6</span>], index=[<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># d    4.5</span></span><br><span class="line"><span class="comment"># b    7.2</span></span><br><span class="line"><span class="comment"># a   -5.3</span></span><br><span class="line"><span class="comment"># c    3.6</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新索引,如果存在原先则保留,不存在则引入NaN</span></span><br><span class="line"><span class="comment"># 注意这里把d索引丢掉了</span></span><br><span class="line">obj2 = obj.reindex([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj2)</span><br><span class="line"><span class="comment"># a   -5.3</span></span><br><span class="line"><span class="comment"># b    7.2</span></span><br><span class="line"><span class="comment"># c    3.6</span></span><br><span class="line"><span class="comment"># e    NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>总结一下:</p>
<ul>
<li>原来就有的索引就保留</li>
<li>原来没有的索引就添加,并且数据都是NaN</li>
<li>多余的全部扔掉</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 快速创建DataFrame的方式</span></span><br><span class="line">frame = pd.DataFrame(np.arange(<span class="number">9</span>).reshape((<span class="number">3</span>, <span class="number">3</span>)),</span><br><span class="line">                     index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>],</span><br><span class="line">                     columns=[<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;California&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#    Ohio  Texas  California</span></span><br><span class="line"><span class="comment"># a     0      1           2</span></span><br><span class="line"><span class="comment"># c     3      4           5</span></span><br><span class="line"><span class="comment"># d     6      7           8</span></span><br><span class="line"></span><br><span class="line">frame2 = frame.reindex([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame2)</span><br><span class="line"><span class="comment">#    Ohio  Texas  California</span></span><br><span class="line"><span class="comment"># a   0.0    1.0         2.0</span></span><br><span class="line"><span class="comment"># b   NaN    NaN         NaN</span></span><br><span class="line"><span class="comment"># c   3.0    4.0         5.0</span></span><br><span class="line"><span class="comment"># d   6.0    7.0         8.0</span></span><br><span class="line"></span><br><span class="line">states = [<span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;California&#x27;</span>]</span><br><span class="line">frame3 = frame.reindex(columns=states)</span><br><span class="line"><span class="built_in">print</span>(frame3)</span><br><span class="line"><span class="comment">#    Texas  Utah  California</span></span><br><span class="line"><span class="comment"># a      1   NaN           2</span></span><br><span class="line"><span class="comment"># c      4   NaN           5</span></span><br><span class="line"><span class="comment"># d      7   NaN           8</span></span><br></pre></td></tr></table></figure>



<p>使用ffill实现向前填充值:ffill很适用于像时间序列这样的有序数据</p>
<p>ffill:即front fill,说明还有bfill:back fill</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj3 = pd.Series([<span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;purple&#x27;</span>, <span class="string">&#x27;yellow&#x27;</span>], index=[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(obj3)</span><br><span class="line"><span class="comment"># 0      blue</span></span><br><span class="line"><span class="comment"># 2    purple</span></span><br><span class="line"><span class="comment"># 4    yellow</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使⽤ffill可以实现前向值填充：</span></span><br><span class="line">obj4 = obj3.reindex(<span class="built_in">range</span>(<span class="number">6</span>), method=<span class="string">&#x27;ffill&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(obj4)</span><br><span class="line"><span class="comment"># 0      blue</span></span><br><span class="line"><span class="comment"># 1      blue</span></span><br><span class="line"><span class="comment"># 2    purple</span></span><br><span class="line"><span class="comment"># 3    purple</span></span><br><span class="line"><span class="comment"># 4    yellow</span></span><br><span class="line"><span class="comment"># 5    yellow</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使⽤bfill可以实现后向值填充：</span></span><br><span class="line">obj5 = obj3.reindex(<span class="built_in">range</span>(<span class="number">6</span>), method=<span class="string">&#x27;bfill&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(obj5)</span><br><span class="line"><span class="comment"># 0      blue</span></span><br><span class="line"><span class="comment"># 1    purple</span></span><br><span class="line"><span class="comment"># 2    purple</span></span><br><span class="line"><span class="comment"># 3    yellow</span></span><br><span class="line"><span class="comment"># 4    yellow</span></span><br><span class="line"><span class="comment"># 5       NaN</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br></pre></td></tr></table></figure>

<p>reindex函数的各参数及说明</p>
<p><img src="/images/68747470.jpg" alt="68747470"></p>
<p>丢弃指定轴上的项</p>
<p>drop⽅法返回的是⼀个在指定轴上删除了指定值的新对象：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = pd.Series(np.arange(<span class="number">5.</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># a    0.0</span></span><br><span class="line"><span class="comment"># b    1.0</span></span><br><span class="line"><span class="comment"># c    2.0</span></span><br><span class="line"><span class="comment"># d    3.0</span></span><br><span class="line"><span class="comment"># e    4.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line">new_obj = obj.drop(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(new_obj)</span><br><span class="line"><span class="comment"># a    0.0</span></span><br><span class="line"><span class="comment"># b    1.0</span></span><br><span class="line"><span class="comment"># d    3.0</span></span><br><span class="line"><span class="comment"># e    4.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line">data1 = obj.drop([<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(data1)</span><br><span class="line"><span class="comment"># a    0.0</span></span><br><span class="line"><span class="comment"># b    1.0</span></span><br><span class="line"><span class="comment"># e    4.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>上面是Series对象删除对象的方法.DataFrame一样可以使用drop:<br>但是==<code>obj.drop([&#39;d&#39;, &#39;c&#39;])</code>只能用于删除行,删除列必须使用axis参数==(因为默认axis=0)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</span><br><span class="line">                    index=[<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Colorado&#x27;</span>, <span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>],</span><br><span class="line">                    columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2     3</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除行(默认axis=0)</span></span><br><span class="line">data2 = data.drop([<span class="string">&#x27;Colorado&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(data2)</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除列传入axis=1或者axis=&#x27;columns&#x27;</span></span><br><span class="line">data3 = data2.drop(<span class="string">&#x27;one&#x27;</span>,axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(data3)</span><br><span class="line"><span class="comment">#           two  three  four</span></span><br><span class="line"><span class="comment"># Utah        9     10    11</span></span><br><span class="line"><span class="comment"># New York   13     14    15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data4 = data3.drop([<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;four&#x27;</span>],axis=<span class="string">&#x27;columns&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data4)</span><br><span class="line"><span class="comment">#           three</span></span><br><span class="line"><span class="comment"># Utah         10</span></span><br><span class="line"><span class="comment"># New York     14</span></span><br></pre></td></tr></table></figure>

<p>索引、选取和过滤</p>
<p>Series索引（obj[…]）的⼯作⽅式类似于NumPy数组的索引，只不过Series的索引值不只是整数。</p>
<p>简单来说:</p>
<ul>
<li>Series的索引,切片可以使用py里的整数,也可以使用Series的标签来索引,切片</li>
<li>使用标签来索引,切片,注意<strong>包含下上限</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">obj = pd.Series(np.arange(<span class="number">4.</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># a    0.0</span></span><br><span class="line"><span class="comment"># b    1.0</span></span><br><span class="line"><span class="comment"># c    2.0</span></span><br><span class="line"><span class="comment"># d    3.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="comment"># 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj[<span class="number">2</span>:<span class="number">4</span>])</span><br><span class="line"><span class="comment"># c    2.0</span></span><br><span class="line"><span class="comment"># d    3.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj[[<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]])</span><br><span class="line"><span class="comment"># b    1.0</span></span><br><span class="line"><span class="comment"># a    0.0</span></span><br><span class="line"><span class="comment"># d    3.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj[[<span class="number">1</span>, <span class="number">3</span>]])</span><br><span class="line"><span class="comment"># b    1.0</span></span><br><span class="line"><span class="comment"># d    3.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj[obj &lt; <span class="number">2</span>])</span><br><span class="line"><span class="comment"># a    0.0</span></span><br><span class="line"><span class="comment"># b    1.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利⽤标签的切⽚包含上限</span></span><br><span class="line"><span class="built_in">print</span>(obj[<span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="comment"># b    1.0</span></span><br><span class="line"><span class="comment"># c    2.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 和py的list一样,索引和切片都是可读可写</span></span><br><span class="line">obj[<span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;c&#x27;</span>] = <span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># a    0.0</span></span><br><span class="line"><span class="comment"># b    5.0</span></span><br><span class="line"><span class="comment"># c    5.0</span></span><br><span class="line"><span class="comment"># d    3.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>其实我们能把DataFrame当成NumPy⼆维数组:<br>他们的语法很像</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</span><br><span class="line">                    index=[<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Colorado&#x27;</span>, <span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>],</span><br><span class="line">                    columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2     3</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[<span class="string">&#x27;two&#x27;</span>])</span><br><span class="line"><span class="comment"># Ohio         1</span></span><br><span class="line"><span class="comment"># Colorado     5</span></span><br><span class="line"><span class="comment"># Utah         9</span></span><br><span class="line"><span class="comment"># New York    13</span></span><br><span class="line"><span class="comment"># Name: two, dtype: int32</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[[<span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;one&#x27;</span>]])</span><br><span class="line"><span class="comment">#           three  one</span></span><br><span class="line"><span class="comment"># Ohio          2    0</span></span><br><span class="line"><span class="comment"># Colorado      6    4</span></span><br><span class="line"><span class="comment"># Utah         10    8</span></span><br><span class="line"><span class="comment"># New York     14   12</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用切片选取行</span></span><br><span class="line"><span class="built_in">print</span>(data[:<span class="number">2</span>])</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2     3</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用布尔型选取数据</span></span><br><span class="line"><span class="built_in">print</span>(data[data[<span class="string">&#x27;three&#x27;</span>] &gt; <span class="number">5</span>])</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用比较运算扩散到全部选区</span></span><br><span class="line"><span class="built_in">print</span>(data &lt; <span class="number">5</span>)</span><br><span class="line"><span class="comment">#             one    two  three   four</span></span><br><span class="line"><span class="comment"># Ohio       True   True   True   True</span></span><br><span class="line"><span class="comment"># Colorado   True  False  False  False</span></span><br><span class="line"><span class="comment"># Utah      False  False  False  False</span></span><br><span class="line"><span class="comment"># New York  False  False  False  False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用布尔值运算将小于5的元素全部改为0</span></span><br><span class="line">data[data &lt; <span class="number">5</span>] = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    0      0     0</span></span><br><span class="line"><span class="comment"># Colorado    0    5      6     7</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br></pre></td></tr></table></figure>


<p>⽤loc和iloc进⾏选取</p>
<p>⾏的标签索引:</p>
<ul>
<li>loc:轴标签</li>
<li>iloc:整数索引</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</span><br><span class="line">                    index=[<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Colorado&#x27;</span>, <span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>],</span><br><span class="line">                    columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2     3</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取单行多列</span></span><br><span class="line"><span class="built_in">print</span>(data.loc[<span class="string">&#x27;Colorado&#x27;</span>, [<span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>]])</span><br><span class="line"><span class="comment"># two      5</span></span><br><span class="line"><span class="comment"># three    6</span></span><br><span class="line"><span class="comment"># Name: Colorado, dtype: int32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取多行多列</span></span><br><span class="line"><span class="built_in">print</span>(data.loc[[<span class="string">&#x27;Colorado&#x27;</span>,<span class="string">&#x27;Ohio&#x27;</span>], [<span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>]])</span><br><span class="line"><span class="comment">#           two  three</span></span><br><span class="line"><span class="comment"># Colorado    5      6</span></span><br><span class="line"><span class="comment"># Ohio        1      2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取索引值为2的行,索引值为3,0,1的列</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[<span class="number">2</span>, [<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="comment"># four    11</span></span><br><span class="line"><span class="comment"># one      8</span></span><br><span class="line"><span class="comment"># two      9</span></span><br><span class="line"><span class="comment"># Name: Utah, dtype: int32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取索引值为2的行</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[<span class="number">2</span>])</span><br><span class="line"><span class="comment"># one       8</span></span><br><span class="line"><span class="comment"># two       9</span></span><br><span class="line"><span class="comment"># three    10</span></span><br><span class="line"><span class="comment"># four     11</span></span><br><span class="line"><span class="comment"># Name: Utah, dtype: int32</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取索引值为1,2的行,索引值为3,0,1的列</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="comment">#           four  one  two</span></span><br><span class="line"><span class="comment"># Colorado     7    4    5</span></span><br><span class="line"><span class="comment"># Utah        11    8    9</span></span><br></pre></td></tr></table></figure>

<p>这两个索引函数也适⽤于⼀个标签或多个标签的切⽚：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</span><br><span class="line">                    index=[<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Colorado&#x27;</span>, <span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>],</span><br><span class="line">                    columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#           one  two  three  four</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2     3</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6     7</span></span><br><span class="line"><span class="comment"># Utah        8    9     10    11</span></span><br><span class="line"><span class="comment"># New York   12   13     14    15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 就像前面说的,当使用标签索引时,包含上下限</span></span><br><span class="line"><span class="built_in">print</span>(data.loc[:<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;two&#x27;</span>])</span><br><span class="line"><span class="comment"># Ohio        1</span></span><br><span class="line"><span class="comment"># Colorado    5</span></span><br><span class="line"><span class="comment"># Utah        9</span></span><br><span class="line"><span class="comment"># Name: two, dtype: int32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取所有行和第0,1,2列</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[:, :<span class="number">3</span>])</span><br><span class="line"><span class="comment">#           one  two  three</span></span><br><span class="line"><span class="comment"># Ohio        0    1      2</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6</span></span><br><span class="line"><span class="comment"># Utah        8    9     10</span></span><br><span class="line"><span class="comment"># New York   12   13     14</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取所有行和第0,1,2列,然后再筛选掉three列小于5的行</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[:, :<span class="number">3</span>][data.three &gt; <span class="number">5</span>])</span><br><span class="line"><span class="comment">#           one  two  three</span></span><br><span class="line"><span class="comment"># Colorado    4    5      6</span></span><br><span class="line"><span class="comment"># Utah        8    9     10</span></span><br><span class="line"><span class="comment"># New York   12   13     14</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 链式调用(可用,但不推荐)</span></span><br><span class="line"><span class="built_in">print</span>(data.iloc[:, :<span class="number">3</span>][data.three &gt; <span class="number">5</span>][data.one &gt; <span class="number">5</span>][data.two &gt; <span class="number">10</span>])</span><br><span class="line"><span class="comment">#           one  two  three</span></span><br><span class="line"><span class="comment"># New York   12   13     14</span></span><br></pre></td></tr></table></figure>

<p>DataFrame的索引选项:</p>
<p><img src="/images/68747437.png" alt="68747437"></p>
<p>整数索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">people = [<span class="string">&#x27;hyl&#x27;</span>,<span class="string">&#x27;dsz&#x27;</span>,<span class="string">&#x27;gzr&#x27;</span>,<span class="string">&#x27;czj&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ser = pd.Series(people,index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(ser)</span><br><span class="line"><span class="comment"># 1    hyl</span></span><br><span class="line"><span class="comment"># 2    dsz</span></span><br><span class="line"><span class="comment"># 3    gzr</span></span><br><span class="line"><span class="comment"># 4    czj</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 产生歧义,是选择标签索引的1还是位置索引的1</span></span><br><span class="line"><span class="comment"># 事实上选择的是标签的1</span></span><br><span class="line"><span class="built_in">print</span>(ser[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># hyl</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为了避免歧义,当标签索引是整数时,索引为-1不可用,会发生KeyError</span></span><br><span class="line"><span class="comment"># print(ser[-1])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ser2 = pd.Series(np.arange(<span class="number">1</span>,<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(ser2)</span><br><span class="line"><span class="comment"># 0    1</span></span><br><span class="line"><span class="comment"># 1    2</span></span><br><span class="line"><span class="comment"># 2    3</span></span><br><span class="line"><span class="comment"># 3    4</span></span><br><span class="line"><span class="comment"># dtype: int32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为了避免歧义,当没有标签索引时,索引为-1不可用,会发生KeyError</span></span><br><span class="line"><span class="comment"># print(ser2[-1])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当标签明确不为整数时,索引为-1可用</span></span><br><span class="line">ser3 = pd.Series(np.arange(<span class="number">3.</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(ser3[-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 2.0</span></span><br></pre></td></tr></table></figure>

<p>造成上面的原因是:<br>为了进⾏统⼀，==如果标签索引含有整数，数据选取总会使⽤标签。==</p>
<p>为了更准确，请使⽤loc（标签）或iloc（整数）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">people = [<span class="string">&#x27;hyl&#x27;</span>,<span class="string">&#x27;dsz&#x27;</span>,<span class="string">&#x27;gzr&#x27;</span>,<span class="string">&#x27;czj&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ser = pd.Series(people,index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(ser)</span><br><span class="line"><span class="comment"># 1    hyl</span></span><br><span class="line"><span class="comment"># 2    dsz</span></span><br><span class="line"><span class="comment"># 3    gzr</span></span><br><span class="line"><span class="comment"># 4    czj</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ser[:<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 1    hyl</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ser.loc[:<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 1    hyl</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ser.iloc[:<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 1    hyl</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br></pre></td></tr></table></figure>

<p>算术运算和数据对⻬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">s1 = pd.Series([<span class="number">7.3</span>, -<span class="number">2.5</span>, <span class="number">3.4</span>, <span class="number">1.5</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">s2 = pd.Series([-<span class="number">2.1</span>, <span class="number">3.6</span>, -<span class="number">1.5</span>, <span class="number">4</span>, <span class="number">3.1</span>],index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line"><span class="comment"># a    7.3</span></span><br><span class="line"><span class="comment"># c   -2.5</span></span><br><span class="line"><span class="comment"># d    3.4</span></span><br><span class="line"><span class="comment"># e    1.5</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s2)</span><br><span class="line"><span class="comment"># a   -2.1</span></span><br><span class="line"><span class="comment"># c    3.6</span></span><br><span class="line"><span class="comment"># e   -1.5</span></span><br><span class="line"><span class="comment"># f    4.0</span></span><br><span class="line"><span class="comment"># g    3.1</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 存在不同的索引对，则结果的索引就是该索引对的并集</span></span><br><span class="line"><span class="comment"># 有点类似于数据库的全外连接</span></span><br><span class="line"><span class="built_in">print</span>(s1+s2)</span><br><span class="line"><span class="comment"># a    5.2</span></span><br><span class="line"><span class="comment"># c    1.1</span></span><br><span class="line"><span class="comment"># d    NaN</span></span><br><span class="line"><span class="comment"># e    0.0</span></span><br><span class="line"><span class="comment"># f    NaN</span></span><br><span class="line"><span class="comment"># g    NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(np.arange(<span class="number">9.</span>).reshape((<span class="number">3</span>, <span class="number">3</span>)), columns=<span class="built_in">list</span>(<span class="string">&#x27;bcd&#x27;</span>),</span><br><span class="line">                   index=[<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Colorado&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)), columns=<span class="built_in">list</span>(<span class="string">&#x27;bde&#x27;</span>),</span><br><span class="line">                   index=[<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line"><span class="comment">#             b    c    d</span></span><br><span class="line"><span class="comment"># Ohio      0.0  1.0  2.0</span></span><br><span class="line"><span class="comment"># Texas     3.0  4.0  5.0</span></span><br><span class="line"><span class="comment"># Colorado  6.0  7.0  8.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df2)</span><br><span class="line"><span class="comment">#           b     d     e</span></span><br><span class="line"><span class="comment"># Utah    0.0   1.0   2.0</span></span><br><span class="line"><span class="comment"># Ohio    3.0   4.0   5.0</span></span><br><span class="line"><span class="comment"># Texas   6.0   7.0   8.0</span></span><br><span class="line"><span class="comment"># Oregon  9.0  10.0  11.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df1 + df2)</span><br><span class="line"><span class="comment">#             b   c     d   e</span></span><br><span class="line"><span class="comment"># Colorado  NaN NaN   NaN NaN</span></span><br><span class="line"><span class="comment"># Ohio      3.0 NaN   6.0 NaN</span></span><br><span class="line"><span class="comment"># Oregon    NaN NaN   NaN NaN</span></span><br><span class="line"><span class="comment"># Texas     9.0 NaN  12.0 NaN</span></span><br><span class="line"><span class="comment"># Utah      NaN NaN   NaN NaN</span></span><br></pre></td></tr></table></figure>

<p>pandas的算术运算有点类似于<strong>数据库的全外连接</strong>:<br>如果存在不同的索引对，则取索引对的并集.<br>并且⾃动的数据对⻬操作在不重叠的索引处引⼊了NaN值。缺失值会在算术运算过程中传播。</p>
<p>在算术⽅法中填充值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line">                   columns=<span class="built_in">list</span>(<span class="string">&#x27;abcd&#x27;</span>))</span><br><span class="line">df2 = pd.DataFrame(np.arange(<span class="number">20.</span>).reshape((<span class="number">4</span>, <span class="number">5</span>)),</span><br><span class="line">                   columns=<span class="built_in">list</span>(<span class="string">&#x27;abcde&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将其中一个元素设置为nan</span></span><br><span class="line">df2.loc[<span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>] = np.nan</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line"><span class="comment">#      a    b     c     d</span></span><br><span class="line"><span class="comment"># 0  0.0  1.0   2.0   3.0</span></span><br><span class="line"><span class="comment"># 1  4.0  5.0   6.0   7.0</span></span><br><span class="line"><span class="comment"># 2  8.0  9.0  10.0  11.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df2)</span><br><span class="line"><span class="comment">#       a     b     c     d     e</span></span><br><span class="line"><span class="comment"># 0   0.0   1.0   2.0   3.0   4.0</span></span><br><span class="line"><span class="comment"># 1   5.0   NaN   7.0   8.0   9.0</span></span><br><span class="line"><span class="comment"># 2  10.0  11.0  12.0  13.0  14.0</span></span><br><span class="line"><span class="comment"># 3  15.0  16.0  17.0  18.0  19.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df1 + df2)</span><br><span class="line"><span class="comment">#       a     b     c     d   e</span></span><br><span class="line"><span class="comment"># 0   0.0   2.0   4.0   6.0 NaN</span></span><br><span class="line"><span class="comment"># 1   9.0   NaN  13.0  15.0 NaN</span></span><br><span class="line"><span class="comment"># 2  18.0  20.0  22.0  24.0 NaN</span></span><br><span class="line"><span class="comment"># 3   NaN   NaN   NaN   NaN NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在计算之前,把所有的NaN都改为0</span></span><br><span class="line"><span class="built_in">print</span>(df1.add(df2, fill_value=<span class="number">0</span>))</span><br><span class="line"><span class="comment">#       a     b     c     d     e</span></span><br><span class="line"><span class="comment"># 0   0.0   2.0   4.0   6.0   4.0</span></span><br><span class="line"><span class="comment"># 1   9.0   5.0  13.0  15.0   9.0</span></span><br><span class="line"><span class="comment"># 2  18.0  20.0  22.0  24.0  14.0</span></span><br><span class="line"><span class="comment"># 3  15.0  16.0  17.0  18.0  19.0</span></span><br></pre></td></tr></table></figure>

<p>Series和DataFrame的算术⽅法。</p>
<p><img src="/images/747269702537.png" alt="747269702537"></p>
<p>r开头的方法会翻转参数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line">                   columns=<span class="built_in">list</span>(<span class="string">&#x27;abcd&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span>/df1)</span><br><span class="line"><span class="comment">#           a         b         c         d</span></span><br><span class="line"><span class="comment"># 0       inf  1.000000  0.500000  0.333333</span></span><br><span class="line"><span class="comment"># 1  0.250000  0.200000  0.166667  0.142857</span></span><br><span class="line"><span class="comment"># 2  0.125000  0.111111  0.100000  0.090909</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df1.rdiv(<span class="number">1</span>))</span><br><span class="line"><span class="comment">#           a         b         c         d</span></span><br><span class="line"><span class="comment"># 0       inf  1.000000  0.500000  0.333333</span></span><br><span class="line"><span class="comment"># 1  0.250000  0.200000  0.166667  0.142857</span></span><br><span class="line"><span class="comment"># 2  0.125000  0.111111  0.100000  0.090909</span></span><br></pre></td></tr></table></figure>

<p>对Series或DataFrame重新索引时，也可以指定⼀<br>个填充值fill_value：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line">                   columns=<span class="built_in">list</span>(<span class="string">&#x27;abcd&#x27;</span>))</span><br><span class="line">df2 = pd.DataFrame(np.arange(<span class="number">20.</span>).reshape((<span class="number">4</span>, <span class="number">5</span>)),</span><br><span class="line">                   columns=<span class="built_in">list</span>(<span class="string">&#x27;abcde&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line"><span class="comment">#      a    b     c     d</span></span><br><span class="line"><span class="comment"># 0  0.0  1.0   2.0   3.0</span></span><br><span class="line"><span class="comment"># 1  4.0  5.0   6.0   7.0</span></span><br><span class="line"><span class="comment"># 2  8.0  9.0  10.0  11.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df2)</span><br><span class="line"><span class="comment">#       a     b     c     d     e</span></span><br><span class="line"><span class="comment"># 0   0.0   1.0   2.0   3.0   4.0</span></span><br><span class="line"><span class="comment"># 1   5.0   6.0   7.0   8.0   9.0</span></span><br><span class="line"><span class="comment"># 2  10.0  11.0  12.0  13.0  14.0</span></span><br><span class="line"><span class="comment"># 3  15.0  16.0  17.0  18.0  19.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = df1.reindex(columns=df2.columns, fill_value=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment">#      a    b     c     d  e</span></span><br><span class="line"><span class="comment"># 0  0.0  1.0   2.0   3.0  0</span></span><br><span class="line"><span class="comment"># 1  4.0  5.0   6.0   7.0  0</span></span><br><span class="line"><span class="comment"># 2  8.0  9.0  10.0  11.0  0</span></span><br></pre></td></tr></table></figure>

<p>DataFrame和Series之间的运算</p>
<p>DataFrame和Series之间的关系就是narray二维数组和一维数组的关系,所以,我们可以使用narray二维数组和一维数组的运算类比DataFrame和Series之间的运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">12.</span>).reshape((<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># [[ 0.  1.  2.  3.]</span></span><br><span class="line"><span class="comment">#  [ 4.  5.  6.  7.]</span></span><br><span class="line"><span class="comment">#  [ 8.  9. 10. 11.]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># [0. 1. 2. 3.]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 广播,会扩散到所有选区</span></span><br><span class="line"><span class="built_in">print</span>(arr - arr[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># [[0. 0. 0. 0.]</span></span><br><span class="line"><span class="comment">#  [4. 4. 4. 4.]</span></span><br><span class="line"><span class="comment">#  [8. 8. 8. 8.]]</span></span><br></pre></td></tr></table></figure>

<p>DataFrame和Series之间的算术运算:</p>
<ul>
<li>将Series的索引匹配到DataFrame的列，然后沿着⾏⼀直向下⼴播.</li>
<li>如果某个索引值在DataFrame的列或Series的索引中找不到，则参与运算的两个对象就会被重新索引以形成并集：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)),</span><br><span class="line">                     columns=<span class="built_in">list</span>(<span class="string">&#x27;bde&#x27;</span>),</span><br><span class="line">                     index=[<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>])</span><br><span class="line">series = frame.iloc[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#           b     d     e</span></span><br><span class="line"><span class="comment"># Utah    0.0   1.0   2.0</span></span><br><span class="line"><span class="comment"># Ohio    3.0   4.0   5.0</span></span><br><span class="line"><span class="comment"># Texas   6.0   7.0   8.0</span></span><br><span class="line"><span class="comment"># Oregon  9.0  10.0  11.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(series)</span><br><span class="line"><span class="comment"># b    0.0</span></span><br><span class="line"><span class="comment"># d    1.0</span></span><br><span class="line"><span class="comment"># e    2.0</span></span><br><span class="line"><span class="comment"># Name: Utah, dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame - series)</span><br><span class="line"><span class="comment">#           b    d    e</span></span><br><span class="line"><span class="comment"># Utah    0.0  0.0  0.0</span></span><br><span class="line"><span class="comment"># Ohio    3.0  3.0  3.0</span></span><br><span class="line"><span class="comment"># Texas   6.0  6.0  6.0</span></span><br><span class="line"><span class="comment"># Oregon  9.0  9.0  9.0</span></span><br><span class="line"></span><br><span class="line">series2 = pd.Series(<span class="built_in">range</span>(<span class="number">3</span>), index=[<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(series2)</span><br><span class="line"><span class="comment"># b    0</span></span><br><span class="line"><span class="comment"># e    1</span></span><br><span class="line"><span class="comment"># f    2</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame + series2)</span><br><span class="line"><span class="comment">#           b   d     e   f</span></span><br><span class="line"><span class="comment"># Utah    0.0 NaN   3.0 NaN</span></span><br><span class="line"><span class="comment"># Ohio    3.0 NaN   6.0 NaN</span></span><br><span class="line"><span class="comment"># Texas   6.0 NaN   9.0 NaN</span></span><br><span class="line"><span class="comment"># Oregon  9.0 NaN  12.0 NaN</span></span><br></pre></td></tr></table></figure>

<p>如果你希望匹配⾏且在列上⼴播，则必须使⽤<strong>算术运算⽅法</strong>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)),</span><br><span class="line">                     columns=<span class="built_in">list</span>(<span class="string">&#x27;bde&#x27;</span>),</span><br><span class="line">                     index=[<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>])</span><br><span class="line"></span><br><span class="line">series3 = frame[<span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#           b     d     e</span></span><br><span class="line"><span class="comment"># Utah    0.0   1.0   2.0</span></span><br><span class="line"><span class="comment"># Ohio    3.0   4.0   5.0</span></span><br><span class="line"><span class="comment"># Texas   6.0   7.0   8.0</span></span><br><span class="line"><span class="comment"># Oregon  9.0  10.0  11.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(series3)</span><br><span class="line"><span class="comment"># Utah       1.0</span></span><br><span class="line"><span class="comment"># Ohio       4.0</span></span><br><span class="line"><span class="comment"># Texas      7.0</span></span><br><span class="line"><span class="comment"># Oregon    10.0</span></span><br><span class="line"><span class="comment"># Name: d, dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># axis=&#x27;index&#x27;或者axis=0</span></span><br><span class="line"><span class="built_in">print</span>(frame.sub(series3, axis=<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"><span class="comment">#           b    d    e</span></span><br><span class="line"><span class="comment"># Utah   -1.0  0.0  1.0</span></span><br><span class="line"><span class="comment"># Ohio   -1.0  0.0  1.0</span></span><br><span class="line"><span class="comment"># Texas  -1.0  0.0  1.0</span></span><br><span class="line"><span class="comment"># Oregon -1.0  0.0  1.0</span></span><br></pre></td></tr></table></figure>



<p>函数应⽤和映射</p>
<p>NumPy的ufuncs（元素级数组⽅法）也可⽤于操作pandas对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), columns=<span class="built_in">list</span>(<span class="string">&#x27;bde&#x27;</span>),</span><br><span class="line">                     index=[<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#                b         d         e</span></span><br><span class="line"><span class="comment"># Utah   -0.967495 -0.247553  1.483448</span></span><br><span class="line"><span class="comment"># Ohio   -0.256602 -0.881130 -0.732070</span></span><br><span class="line"><span class="comment"># Texas   0.379607  0.959606  1.048860</span></span><br><span class="line"><span class="comment"># Oregon  0.225625  0.292465 -0.406547</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">abs</span>(frame))</span><br><span class="line"><span class="comment">#                b         d         e</span></span><br><span class="line"><span class="comment"># Utah    0.967495  0.247553  1.483448</span></span><br><span class="line"><span class="comment"># Ohio    0.256602  0.881130  0.732070</span></span><br><span class="line"><span class="comment"># Texas   0.379607  0.959606  1.048860</span></span><br><span class="line"><span class="comment"># Oregon  0.225625  0.292465  0.406547</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 还可以使用py里的匿名函数</span></span><br><span class="line">f = <span class="keyword">lambda</span> x: x.<span class="built_in">max</span>() - x.<span class="built_in">min</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.apply(f))</span><br><span class="line"><span class="comment"># b    2.290285</span></span><br><span class="line"><span class="comment"># d    0.572808</span></span><br><span class="line"><span class="comment"># e    2.553155</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用例还可以使用axis=&#x27;columns&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(frame.apply(f,axis=<span class="string">&#x27;columns&#x27;</span>))</span><br><span class="line"><span class="comment"># Utah      2.410839</span></span><br><span class="line"><span class="comment"># Ohio      1.082203</span></span><br><span class="line"><span class="comment"># Texas     1.472795</span></span><br><span class="line"><span class="comment"># Oregon    2.333930</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>我们甚至可以使用函数来创建新的Series:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), columns=<span class="built_in">list</span>(<span class="string">&#x27;bde&#x27;</span>),</span><br><span class="line">                     index=[<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#                b         d         e</span></span><br><span class="line"><span class="comment"># Utah   -1.176057 -0.783786 -0.543606</span></span><br><span class="line"><span class="comment"># Ohio    0.777264  1.151499 -1.428496</span></span><br><span class="line"><span class="comment"># Texas   0.036316  0.648344 -2.312486</span></span><br><span class="line"><span class="comment"># Oregon  1.286525 -1.263399  1.165449</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> pd.Series([x.<span class="built_in">min</span>(), x.<span class="built_in">max</span>()], index=[<span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;max&#x27;</span>])</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(frame.apply(f))</span><br><span class="line"><span class="comment">#             b         d         e</span></span><br><span class="line"><span class="comment"># min -1.176057 -1.263399 -2.312486</span></span><br><span class="line"><span class="comment"># max  1.286525  1.151499  1.165449</span></span><br></pre></td></tr></table></figure>

<p>我们还可以使用元素级的python函数:<br>这时要使用<strong>applymap函数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), columns=<span class="built_in">list</span>(<span class="string">&#x27;bde&#x27;</span>),</span><br><span class="line">                     index=[<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#                b         d         e</span></span><br><span class="line"><span class="comment"># Utah   -1.322140  0.974776 -0.832036</span></span><br><span class="line"><span class="comment"># Ohio    2.061849  0.307122  0.085941</span></span><br><span class="line"><span class="comment"># Texas  -1.420665 -0.193728 -0.401482</span></span><br><span class="line"><span class="comment"># Oregon -0.703217  0.103967 -0.689496</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 元素级的python函数</span></span><br><span class="line"><span class="built_in">format</span> = <span class="keyword">lambda</span> x: <span class="string">&#x27;%.2f&#x27;</span> % x</span><br><span class="line">data = frame.applymap(<span class="built_in">format</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#             b      d      e</span></span><br><span class="line"><span class="comment"># Utah    -1.32   0.97  -0.83</span></span><br><span class="line"><span class="comment"># Ohio     2.06   0.31   0.09</span></span><br><span class="line"><span class="comment"># Texas   -1.42  -0.19  -0.40</span></span><br><span class="line"><span class="comment"># Oregon  -0.70   0.10  -0.69</span></span><br></pre></td></tr></table></figure>

<p>applymap函数是DataFrame的元素级应用函数,<br>map函数就是Series的元素级应用函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), columns=<span class="built_in">list</span>(<span class="string">&#x27;bde&#x27;</span>),</span><br><span class="line">                     index=[<span class="string">&#x27;Utah&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Texas&#x27;</span>, <span class="string">&#x27;Oregon&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#                b         d         e</span></span><br><span class="line"><span class="comment"># Utah   -0.817937 -0.802316 -0.293776</span></span><br><span class="line"><span class="comment"># Ohio    0.413619 -0.647371 -0.615123</span></span><br><span class="line"><span class="comment"># Texas  -0.469394  0.663940  0.440380</span></span><br><span class="line"><span class="comment"># Oregon  1.413984  0.933500  1.031781</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">format</span> = <span class="keyword">lambda</span> x: <span class="string">&#x27;%.2f&#x27;</span> % x</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame[<span class="string">&#x27;e&#x27;</span>].<span class="built_in">map</span>(<span class="built_in">format</span>))</span><br><span class="line"><span class="comment"># Utah      -0.29</span></span><br><span class="line"><span class="comment"># Ohio      -0.62</span></span><br><span class="line"><span class="comment"># Texas      0.44</span></span><br><span class="line"><span class="comment"># Oregon     1.03</span></span><br><span class="line"><span class="comment"># Name: e, dtype: object</span></span><br></pre></td></tr></table></figure>

<p>需要注意的是:<br>许多最为常⻅的数组统计功能都被实现成DataFrame的⽅法（如sum和mean），因此⽆需使⽤apply⽅法。</p>
<p>排序和排名</p>
<ul>
<li>按索引进行排序:<br>sort_index</li>
<li>按值进行排序:<br>sort_values</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对索引进行排序</span></span><br><span class="line">obj = pd.Series(<span class="built_in">range</span>(<span class="number">4</span>), index=[<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># d    0</span></span><br><span class="line"><span class="comment"># a    1</span></span><br><span class="line"><span class="comment"># b    2</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj.sort_index())</span><br><span class="line"><span class="comment"># a    1</span></span><br><span class="line"><span class="comment"># b    2</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># d    0</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.arange(<span class="number">8</span>).reshape((<span class="number">2</span>, <span class="number">4</span>)),</span><br><span class="line">                     index=[<span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;one&#x27;</span>],</span><br><span class="line">                     columns=[<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#        d  a  b  c</span></span><br><span class="line"><span class="comment"># three  0  1  2  3</span></span><br><span class="line"><span class="comment"># one    4  5  6  7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对索引进行排序,默认axis=0</span></span><br><span class="line"><span class="built_in">print</span>(frame.sort_index())</span><br><span class="line"><span class="comment">#        d  a  b  c</span></span><br><span class="line"><span class="comment"># one    4  5  6  7</span></span><br><span class="line"><span class="comment"># three  0  1  2  3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.sort_index(axis=<span class="number">1</span>))</span><br><span class="line"><span class="comment">#        a  b  c  d</span></span><br><span class="line"><span class="comment"># three  1  2  3  0</span></span><br><span class="line"><span class="comment"># one    5  6  7  4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认升序,可以使用ascending=False实现降序</span></span><br><span class="line"><span class="built_in">print</span>(frame.sort_index(axis=<span class="number">1</span>, ascending=<span class="literal">False</span>))</span><br><span class="line"><span class="comment">#        d  c  b  a</span></span><br><span class="line"><span class="comment"># three  0  3  2  1</span></span><br><span class="line"><span class="comment"># one    4  7  6  5</span></span><br></pre></td></tr></table></figure>

<p>按值进行排序:<br>在排序时，任何缺失值默认都会被放到Series的末尾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按值进行排序</span></span><br><span class="line">obj = pd.Series([<span class="number">4</span>, <span class="number">7</span>, -<span class="number">3</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># 0    4</span></span><br><span class="line"><span class="comment"># 1    7</span></span><br><span class="line"><span class="comment"># 2   -3</span></span><br><span class="line"><span class="comment"># 3    2</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj.sort_values())</span><br><span class="line"><span class="comment"># 2   -3</span></span><br><span class="line"><span class="comment"># 3    2</span></span><br><span class="line"><span class="comment"># 0    4</span></span><br><span class="line"><span class="comment"># 1    7</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按值进行排序</span></span><br><span class="line">obj = pd.Series([<span class="number">4</span>, np.nan, <span class="number">7</span>, np.nan, -<span class="number">3</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># 0    4.0</span></span><br><span class="line"><span class="comment"># 1    NaN</span></span><br><span class="line"><span class="comment"># 2    7.0</span></span><br><span class="line"><span class="comment"># 3    NaN</span></span><br><span class="line"><span class="comment"># 4   -3.0</span></span><br><span class="line"><span class="comment"># 5    2.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj.sort_values())</span><br><span class="line"><span class="comment"># 4   -3.0</span></span><br><span class="line"><span class="comment"># 5    2.0</span></span><br><span class="line"><span class="comment"># 0    4.0</span></span><br><span class="line"><span class="comment"># 2    7.0</span></span><br><span class="line"><span class="comment"># 1    NaN</span></span><br><span class="line"><span class="comment"># 3    NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>主要关键字/次要关键字排序:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按值进行排序</span></span><br><span class="line">frame = pd.DataFrame(&#123;<span class="string">&#x27;b&#x27;</span>: [<span class="number">4</span>, <span class="number">7</span>, -<span class="number">3</span>, <span class="number">2</span>], <span class="string">&#x27;a&#x27;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#    b  a</span></span><br><span class="line"><span class="comment"># 0  4  0</span></span><br><span class="line"><span class="comment"># 1  7  1</span></span><br><span class="line"><span class="comment"># 2 -3  0</span></span><br><span class="line"><span class="comment"># 3  2  1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.sort_values(by=<span class="string">&#x27;b&#x27;</span>))</span><br><span class="line"><span class="comment">#    b  a</span></span><br><span class="line"><span class="comment"># 2 -3  0</span></span><br><span class="line"><span class="comment"># 3  2  1</span></span><br><span class="line"><span class="comment"># 0  4  0</span></span><br><span class="line"><span class="comment"># 1  7  1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.sort_values(by=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"><span class="comment">#    b  a</span></span><br><span class="line"><span class="comment"># 2 -3  0</span></span><br><span class="line"><span class="comment"># 0  4  0</span></span><br><span class="line"><span class="comment"># 3  2  1</span></span><br><span class="line"><span class="comment"># 1  7  1</span></span><br></pre></td></tr></table></figure>

<p>rank⽅法:<br>rank是默认通过<code>为各组分配⼀个平均排名</code>的⽅式来排序的.<br>可以通过关键字method得到其他排位方式method=‘first’，‘max’等.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = pd.Series([<span class="number">7</span>, -<span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># 0    7</span></span><br><span class="line"><span class="comment"># 1   -5</span></span><br><span class="line"><span class="comment"># 2    7</span></span><br><span class="line"><span class="comment"># 3    4</span></span><br><span class="line"><span class="comment"># 4    2</span></span><br><span class="line"><span class="comment"># 5    0</span></span><br><span class="line"><span class="comment"># 6    4</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># rank默认的排序方式是取平均值</span></span><br><span class="line"><span class="comment"># rank 表示在这个数在原来的Series中排第几名，有相同的数，取其排名平均（默认）作为值。</span></span><br><span class="line"><span class="comment"># 在obj中，4和4的排名是第4名和第五名，取平均得4.5。7和7的排名分别是第六名和第七名，则其排名取平均得6.5</span></span><br><span class="line"><span class="built_in">print</span>(obj.rank())</span><br><span class="line"><span class="comment"># 0    6.5</span></span><br><span class="line"><span class="comment"># 1    1.0</span></span><br><span class="line"><span class="comment"># 2    6.5</span></span><br><span class="line"><span class="comment"># 3    4.5</span></span><br><span class="line"><span class="comment"># 4    3.0</span></span><br><span class="line"><span class="comment"># 5    2.0</span></span><br><span class="line"><span class="comment"># 6    4.5</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改排序方式</span></span><br><span class="line"><span class="comment"># 根据值在原数据中出现的顺序给出排名：</span></span><br><span class="line"><span class="built_in">print</span>(obj.rank(method=<span class="string">&#x27;first&#x27;</span>))</span><br><span class="line"><span class="comment"># 0    6.0</span></span><br><span class="line"><span class="comment"># 1    1.0</span></span><br><span class="line"><span class="comment"># 2    7.0</span></span><br><span class="line"><span class="comment"># 3    4.0</span></span><br><span class="line"><span class="comment"># 4    3.0</span></span><br><span class="line"><span class="comment"># 5    2.0</span></span><br><span class="line"><span class="comment"># 6    5.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用降序</span></span><br><span class="line"><span class="built_in">print</span>(obj.rank(ascending=<span class="literal">False</span>, method=<span class="string">&#x27;max&#x27;</span>))</span><br><span class="line"><span class="comment"># 0    2.0</span></span><br><span class="line"><span class="comment"># 1    7.0</span></span><br><span class="line"><span class="comment"># 2    2.0</span></span><br><span class="line"><span class="comment"># 3    4.0</span></span><br><span class="line"><span class="comment"># 4    5.0</span></span><br><span class="line"><span class="comment"># 5    6.0</span></span><br><span class="line"><span class="comment"># 6    4.0</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>method方法的选项:</p>
<table>
<thead>
<tr>
<th>Tables</th>
<th>Are</th>
</tr>
</thead>
<tbody><tr>
<td>average</td>
<td>默认:在线等分组中,为各个值分配平均排名</td>
</tr>
<tr>
<td>min</td>
<td>使用整个分组的最小排名</td>
</tr>
<tr>
<td>max</td>
<td>使用整个分组的最大排名</td>
</tr>
<tr>
<td>first</td>
<td>按值的原始数据中的出现顺序分配排名</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(&#123;<span class="string">&#x27;b&#x27;</span>: [<span class="number">4.3</span>, <span class="number">7</span>, -<span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">	                  <span class="string">&#x27;a&#x27;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">	                  <span class="string">&#x27;c&#x27;</span>: [-<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, -<span class="number">2.5</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame)</span><br><span class="line"><span class="comment">#      b  a    c</span></span><br><span class="line"><span class="comment"># 0  4.3  0 -2.0</span></span><br><span class="line"><span class="comment"># 1  7.0  1  5.0</span></span><br><span class="line"><span class="comment"># 2 -3.0  0  8.0</span></span><br><span class="line"><span class="comment"># 3  2.0  1 -2.5</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.rank(axis=<span class="string">&#x27;columns&#x27;</span>))</span><br><span class="line"><span class="comment">#      b    a    c</span></span><br><span class="line"><span class="comment"># 0  3.0  2.0  1.0</span></span><br><span class="line"><span class="comment"># 1  3.0  1.0  2.0</span></span><br><span class="line"><span class="comment"># 2  1.0  2.0  3.0</span></span><br><span class="line"><span class="comment"># 3  3.0  2.0  1.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.rank(axis=<span class="number">0</span>))</span><br><span class="line"><span class="comment">#      b    a    c</span></span><br><span class="line"><span class="comment"># 0  3.0  1.5  2.0</span></span><br><span class="line"><span class="comment"># 1  4.0  3.5  3.0</span></span><br><span class="line"><span class="comment"># 2  1.0  1.5  4.0</span></span><br><span class="line"><span class="comment"># 3  2.0  3.5  1.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(frame.rank(axis=<span class="number">1</span>))</span><br><span class="line"><span class="comment">#      b    a    c</span></span><br><span class="line"><span class="comment"># 0  3.0  2.0  1.0</span></span><br><span class="line"><span class="comment"># 1  3.0  1.0  2.0</span></span><br><span class="line"><span class="comment"># 2  1.0  2.0  3.0</span></span><br><span class="line"><span class="comment"># 3  3.0  2.0  1.0</span></span><br></pre></td></tr></table></figure>



<p>带有重复标签的轴索引</p>
<ul>
<li>如果一个索引对应多个值，则返回⼀个Series</li>
<li>如果一个索引对应单个值，则返回⼀个标量值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">obj = pd.Series(<span class="built_in">range</span>(<span class="number">5</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># a    0</span></span><br><span class="line"><span class="comment"># a    1</span></span><br><span class="line"><span class="comment"># b    2</span></span><br><span class="line"><span class="comment"># b    3</span></span><br><span class="line"><span class="comment"># c    4</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过索引的is_unique属性可以判断他的值是否唯一</span></span><br><span class="line"><span class="built_in">print</span>(obj.index.is_unique)</span><br><span class="line"><span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果一个索引对应多个值，则返回⼀个Series</span></span><br><span class="line"><span class="comment"># 如果一个索引对应单个值，则返回⼀个标量值</span></span><br><span class="line"><span class="built_in">print</span>(obj[<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line"><span class="comment"># a    0</span></span><br><span class="line"><span class="comment"># a    1</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj[<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="comment"># 4</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment">#           0         1         2</span></span><br><span class="line"><span class="comment"># a  0.827146 -1.291108 -0.068053</span></span><br><span class="line"><span class="comment"># a -0.614791 -2.891564 -1.103444</span></span><br><span class="line"><span class="comment"># b  2.066921 -2.490818  0.991229</span></span><br><span class="line"><span class="comment"># b -1.383593  1.431614 -0.888320</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="comment">#           0         1         2</span></span><br><span class="line"><span class="comment"># b  2.066921 -2.490818  0.991229</span></span><br><span class="line"><span class="comment"># b -1.383593  1.431614 -0.888320</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="5-3汇总和计算描述统计"><a href="#5-3汇总和计算描述统计" class="headerlink" title="5.3汇总和计算描述统计"></a>5.3汇总和计算描述统计</h2><p>pandas函数都是基于没有缺失数据的假设⽽构建的:</p>
<ul>
<li>NaN会自动被忽略(NaN视为0)</li>
<li>如果整个切片都是NaN,那么会返回NaN</li>
<li>通过skipna来禁用该功能</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame([[<span class="number">1.4</span>, np.nan], [<span class="number">7.1</span>, -<span class="number">4.5</span>],</span><br><span class="line">                   [np.nan, np.nan], [<span class="number">0.75</span>, -<span class="number">1.3</span>]],</span><br><span class="line">                  index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>],</span><br><span class="line">                  columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment">#     one  two</span></span><br><span class="line"><span class="comment"># a  1.40  NaN</span></span><br><span class="line"><span class="comment"># b  7.10 -4.5</span></span><br><span class="line"><span class="comment"># c   NaN  NaN</span></span><br><span class="line"><span class="comment"># d  0.75 -1.3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 自动忽略NaN值(NaN视为0)</span></span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">sum</span>())</span><br><span class="line"><span class="comment"># one    9.25</span></span><br><span class="line"><span class="comment"># two   -5.80</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">sum</span>(axis=<span class="string">&#x27;columns&#x27;</span>))</span><br><span class="line"><span class="comment"># a    1.40</span></span><br><span class="line"><span class="comment"># b    2.60</span></span><br><span class="line"><span class="comment"># c    0.00</span></span><br><span class="line"><span class="comment"># d   -0.55</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.mean(axis=<span class="string">&#x27;columns&#x27;</span>))</span><br><span class="line"><span class="comment"># a    1.400</span></span><br><span class="line"><span class="comment"># b    1.300</span></span><br><span class="line"><span class="comment"># c      NaN</span></span><br><span class="line"><span class="comment"># d   -0.275</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用skipna禁用&#x27;将NaN忽略&#x27;,这样NaN就会被传递</span></span><br><span class="line"><span class="built_in">print</span>(df.mean(axis=<span class="string">&#x27;columns&#x27;</span>, skipna=<span class="literal">False</span>))</span><br><span class="line"><span class="comment"># a      NaN</span></span><br><span class="line"><span class="comment"># b    1.300</span></span><br><span class="line"><span class="comment"># c      NaN</span></span><br><span class="line"><span class="comment"># d   -0.275</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 最大值的索引,同理还有idxmin</span></span><br><span class="line"><span class="built_in">print</span>(df.idxmax())</span><br><span class="line"><span class="comment"># one    b</span></span><br><span class="line"><span class="comment"># two    d</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 累加</span></span><br><span class="line"><span class="built_in">print</span>(df.cumsum())</span><br><span class="line"><span class="comment">#     one  two</span></span><br><span class="line"><span class="comment"># a  1.40  NaN</span></span><br><span class="line"><span class="comment"># b  8.50 -4.5</span></span><br><span class="line"><span class="comment"># c   NaN  NaN</span></span><br><span class="line"><span class="comment"># d  9.25 -5.8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一次性产生多个汇总统计</span></span><br><span class="line"><span class="built_in">print</span>(df.describe())</span><br><span class="line"><span class="comment">#             one       two</span></span><br><span class="line"><span class="comment"># count  3.000000  2.000000</span></span><br><span class="line"><span class="comment"># mean   3.083333 -2.900000</span></span><br><span class="line"><span class="comment"># std    3.493685  2.262742</span></span><br><span class="line"><span class="comment"># min    0.750000 -4.500000</span></span><br><span class="line"><span class="comment"># 25%    1.075000 -3.700000</span></span><br><span class="line"><span class="comment"># 50%    1.400000 -2.900000</span></span><br><span class="line"><span class="comment"># 75%    4.250000 -2.100000</span></span><br><span class="line"><span class="comment"># max    7.100000 -1.300000</span></span><br></pre></td></tr></table></figure>

<p>需要注意的是累加:</p>
<ul>
<li>就算是skipna=True,结果中一样有NaN<br>(不过也没差,反正这个NaN就等于上面的值或左边的值)</li>
<li>如果skipna=False,根据NaN传递原则,那么NaN接下来的数据都会是NaN</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame([[<span class="number">1.4</span>, np.nan], [<span class="number">7.1</span>, -<span class="number">4.5</span>],</span><br><span class="line">                   [np.nan, np.nan], [<span class="number">0.75</span>, -<span class="number">1.3</span>]],</span><br><span class="line">                  index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>],</span><br><span class="line">                  columns=[<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment">#     one  two</span></span><br><span class="line"><span class="comment"># a  1.40  NaN</span></span><br><span class="line"><span class="comment"># b  7.10 -4.5</span></span><br><span class="line"><span class="comment"># c   NaN  NaN</span></span><br><span class="line"><span class="comment"># d  0.75 -1.3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.cumsum(axis=<span class="number">0</span>))</span><br><span class="line"><span class="comment">#     one  two</span></span><br><span class="line"><span class="comment"># a  1.40  NaN</span></span><br><span class="line"><span class="comment"># b  8.50 -4.5</span></span><br><span class="line"><span class="comment"># c   NaN  NaN</span></span><br><span class="line"><span class="comment"># d  9.25 -5.8</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.cumsum(axis=<span class="number">1</span>))</span><br><span class="line"><span class="comment">#     one   two</span></span><br><span class="line"><span class="comment"># a  1.40   NaN</span></span><br><span class="line"><span class="comment"># b  7.10  2.60</span></span><br><span class="line"><span class="comment"># c   NaN   NaN</span></span><br><span class="line"><span class="comment"># d  0.75 -0.55</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.cumsum(axis=<span class="number">1</span>,skipna=<span class="literal">False</span>))</span><br><span class="line"><span class="comment">#     one   two</span></span><br><span class="line"><span class="comment"># a  1.40   NaN</span></span><br><span class="line"><span class="comment"># b  7.10  2.60</span></span><br><span class="line"><span class="comment"># c   NaN   NaN</span></span><br><span class="line"><span class="comment"># d  0.75 -0.55</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># NaN接下去的数据都是NaN</span></span><br><span class="line"><span class="built_in">print</span>(df.cumsum(axis=<span class="number">0</span>,skipna=<span class="literal">False</span>))</span><br><span class="line"><span class="comment">#    one  two</span></span><br><span class="line"><span class="comment"># a  1.4  NaN</span></span><br><span class="line"><span class="comment"># b  8.5  NaN</span></span><br><span class="line"><span class="comment"># c  NaN  NaN</span></span><br><span class="line"><span class="comment"># d  NaN  NaN</span></span><br></pre></td></tr></table></figure>

<p>对于⾮数值型数据，describe会产⽣另外⼀种汇总统计：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于⾮数值型数据，describe会产⽣另外⼀种汇总统计：</span></span><br><span class="line">obj = pd.Series([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>] * <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br><span class="line"><span class="comment"># 0     a</span></span><br><span class="line"><span class="comment"># 1     a</span></span><br><span class="line"><span class="comment"># 2     b</span></span><br><span class="line"><span class="comment"># 3     c</span></span><br><span class="line"><span class="comment"># 4     a</span></span><br><span class="line"><span class="comment"># 5     a</span></span><br><span class="line"><span class="comment"># 6     b</span></span><br><span class="line"><span class="comment"># 7     c</span></span><br><span class="line"><span class="comment"># 8     a</span></span><br><span class="line"><span class="comment"># 9     a</span></span><br><span class="line"><span class="comment"># 10    b</span></span><br><span class="line"><span class="comment"># 11    c</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj.describe())</span><br><span class="line"><span class="comment"># count     12</span></span><br><span class="line"><span class="comment"># unique     3</span></span><br><span class="line"><span class="comment"># top        a</span></span><br><span class="line"><span class="comment"># freq       6</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br></pre></td></tr></table></figure>



<p>所有与描述统计相关的方法。</p>
<p><img src="/images/69702537.jpg" alt="69702537"></p>
<p>相关系数与协⽅差</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas_datareader.data <span class="keyword">as</span> web </span><br><span class="line"></span><br><span class="line">all_data = &#123;ticker: web.get_data_yahoo(ticker)</span><br><span class="line">            <span class="keyword">for</span> ticker <span class="keyword">in</span> [<span class="string">&#x27;AAPL&#x27;</span>, <span class="string">&#x27;IBM&#x27;</span>, <span class="string">&#x27;MSFT&#x27;</span>, <span class="string">&#x27;GOOG&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取DataFrame对象</span></span><br><span class="line">price = pd.DataFrame(&#123;ticker: data[<span class="string">&#x27;Adj Close&#x27;</span>]</span><br><span class="line">                     <span class="keyword">for</span> ticker, data <span class="keyword">in</span> all_data.items()&#125;)</span><br><span class="line"><span class="comment"># 获取DataFrame对象</span></span><br><span class="line">volume = pd.DataFrame(&#123;ticker: data[<span class="string">&#x27;Volume&#x27;</span>]</span><br><span class="line">                     <span class="keyword">for</span> ticker, data <span class="keyword">in</span> all_data.items()&#125;)</span><br><span class="line"></span><br><span class="line">returns = price.pct_change()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算价格的百分比变化</span></span><br><span class="line"><span class="built_in">print</span>(returns.tail())</span><br><span class="line"><span class="comment">#                 AAPL      GOOG       IBM      MSFT</span></span><br><span class="line"><span class="comment"># Date                                              </span></span><br><span class="line"><span class="comment"># 2016-10-17 -0.000680  0.001837  0.002072 -0.003483</span></span><br><span class="line"><span class="comment"># 2016-10-18 -0.000681  0.019616 -0.026168  0.007690</span></span><br><span class="line"><span class="comment"># 2016-10-19 -0.002979  0.007846  0.003583 -0.002255</span></span><br><span class="line"><span class="comment"># 2016-10-20 -0.000512 -0.005652  0.001719 -0.004867</span></span><br><span class="line"><span class="comment"># 2016-10-21 -0.003930  0.003011 -0.012474  0.042096</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Series的corr⽅法⽤于计算两个Series中重叠的、⾮NA的、按索引对⻬的值的相关系数。</span></span><br><span class="line"><span class="built_in">print</span>(returns[<span class="string">&#x27;MSFT&#x27;</span>].corr(returns[<span class="string">&#x27;IBM&#x27;</span>]))</span><br><span class="line"><span class="comment"># 0.49976361144151144</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cov⽤于计算协⽅差</span></span><br><span class="line"><span class="built_in">print</span>(returns[<span class="string">&#x27;MSFT&#x27;</span>].cov(returns[<span class="string">&#x27;IBM&#x27;</span>]))</span><br><span class="line"><span class="comment"># 8.8706554797035462e-05</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用MSTF用更简洁的语法选择列</span></span><br><span class="line"><span class="built_in">print</span>(returns.MSFT.corr(returns.IBM))</span><br><span class="line"><span class="comment"># 0.49976361144151144</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># corr⽅法:以DataFrame的形式返回完整的相关系数：</span></span><br><span class="line"><span class="built_in">print</span>(returns.corr())</span><br><span class="line"><span class="comment">#           AAPL      GOOG       IBM      MSFT</span></span><br><span class="line"><span class="comment"># AAPL  1.000000  0.407919  0.386817  0.389695</span></span><br><span class="line"><span class="comment"># GOOG  0.407919  1.000000  0.405099  0.465919</span></span><br><span class="line"><span class="comment"># IBM   0.386817  0.405099  1.000000  0.499764</span></span><br><span class="line"><span class="comment"># MSFT  0.389695  0.465919  0.499764  1.000000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># cov⽅法:以DataFrame的形式返回完整的协⽅差矩阵：</span></span><br><span class="line"><span class="built_in">print</span>(returns.cov())</span><br><span class="line"><span class="comment">#           AAPL      GOOG       IBM      MSFT</span></span><br><span class="line"><span class="comment"># AAPL  0.000277  0.000107  0.000078  0.000095</span></span><br><span class="line"><span class="comment"># GOOG  0.000107  0.000251  0.000078  0.000108</span></span><br><span class="line"><span class="comment"># IBM   0.000078  0.000078  0.000146  0.000089</span></span><br><span class="line"><span class="comment"># MSFT  0.000095  0.000108  0.000089  0.000215</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># corrwith⽅法:计算其列或⾏跟另⼀个Series或DataFrame之间的相关系数。</span></span><br><span class="line"><span class="comment"># 传⼊⼀个Series将会返回⼀个相关系数值Series（针对各列进⾏计算）：</span></span><br><span class="line"><span class="built_in">print</span>(returns.corrwith(returns.IBM))</span><br><span class="line"><span class="comment"># AAPL    0.386817</span></span><br><span class="line"><span class="comment"># GOOG    0.405099</span></span><br><span class="line"><span class="comment"># IBM     1.000000</span></span><br><span class="line"><span class="comment"># MSFT    0.499764</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 传⼊⼀个DataFrame则会计算按列名配对的相关系数。</span></span><br><span class="line"><span class="comment"># 这⾥，计算百分⽐变化与成交量的相关系数：</span></span><br><span class="line"><span class="built_in">print</span>(returns.corrwith(volume))</span><br><span class="line"><span class="comment"># AAPL   -0.075565</span></span><br><span class="line"><span class="comment"># GOOG   -0.007067</span></span><br><span class="line"><span class="comment"># IBM    -0.204849</span></span><br><span class="line"><span class="comment"># MSFT   -0.092950</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure>

<p>唯⼀值、值计数以及成员资格</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">obj = pd.Series([<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># unique方法:Series中的唯⼀值数组</span></span><br><span class="line"><span class="built_in">print</span>(obj.unique())</span><br><span class="line"><span class="comment"># [&#x27;c&#x27; &#x27;a&#x27; &#x27;d&#x27; &#x27;b&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># value_counts方法:计算⼀个Series中各值出现的频率</span></span><br><span class="line"><span class="comment"># 默认按值频率降序排列</span></span><br><span class="line"><span class="built_in">print</span>(obj.value_counts())</span><br><span class="line"><span class="comment"># a    3</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># b    2</span></span><br><span class="line"><span class="comment"># d    1</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用sort不排序</span></span><br><span class="line"><span class="built_in">print</span>(pd.value_counts(obj.values, sort=<span class="literal">False</span>))</span><br><span class="line"><span class="comment"># b    2</span></span><br><span class="line"><span class="comment"># c    3</span></span><br><span class="line"><span class="comment"># d    1</span></span><br><span class="line"><span class="comment"># a    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断集合的成员资格</span></span><br><span class="line">mask = obj.isin([<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(mask)</span><br><span class="line"><span class="comment"># 0     True</span></span><br><span class="line"><span class="comment"># 1    False</span></span><br><span class="line"><span class="comment"># 2    False</span></span><br><span class="line"><span class="comment"># 3    False</span></span><br><span class="line"><span class="comment"># 4    False</span></span><br><span class="line"><span class="comment"># 5     True</span></span><br><span class="line"><span class="comment"># 6     True</span></span><br><span class="line"><span class="comment"># 7     True</span></span><br><span class="line"><span class="comment"># 8     True</span></span><br><span class="line"><span class="comment"># dtype: bool</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过传入布尔型Series过滤出需要的数据</span></span><br><span class="line"><span class="built_in">print</span>(obj[mask])</span><br><span class="line"><span class="comment"># 0    c</span></span><br><span class="line"><span class="comment"># 5    b</span></span><br><span class="line"><span class="comment"># 6    b</span></span><br><span class="line"><span class="comment"># 7    c</span></span><br><span class="line"><span class="comment"># 8    c</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br></pre></td></tr></table></figure>

<p>Index.get_indexer⽅法:<br>功能和isin类似:<br>获取to_match在unique_vals中的位置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">to_match    = pd.Series([<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">unique_vals = pd.Series([<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pd.Index(unique_vals))</span><br><span class="line"><span class="comment"># Index([&#x27;c&#x27;, &#x27;b&#x27;, &#x27;a&#x27;], dtype=&#x27;object&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pd.Index(unique_vals).get_indexer(to_match))</span><br><span class="line"><span class="comment"># [0 2 1 1 0 2]</span></span><br></pre></td></tr></table></figure>

<p>这几个方法的参考信息:</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>isin</td>
<td>计算一个表示”Series各值是否包含于传入的值序列中”的布尔型数组</td>
</tr>
<tr>
<td>match</td>
<td>计算一个数组中的各值到另一个不同值数组的整数索引;对于数据对齐和连接类型的操作十分有用</td>
</tr>
<tr>
<td>unique</td>
<td>计算Series的唯一值数组,按发现的顺序返回</td>
</tr>
<tr>
<td>value_counts</td>
<td>返回一个Series,其索引为唯一值,其值为频率,按计数值降序排列</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(&#123;<span class="string">&#x27;Qu1&#x27;</span>: [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>],</span><br><span class="line">                     <span class="string">&#x27;Qu2&#x27;</span>: [<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>],</span><br><span class="line">                     <span class="string">&#x27;Qu3&#x27;</span>: [<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#   Qu1 Qu2 Qu3</span></span><br><span class="line"><span class="comment"># 0   a   e   c</span></span><br><span class="line"><span class="comment"># 1   b   b   c</span></span><br><span class="line"><span class="comment"># 2   e   b   c</span></span><br><span class="line"><span class="comment"># 3   d   d   d</span></span><br><span class="line"><span class="comment"># 4   e   e   e</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 左侧为出现的全部元素，矩阵为出现次数</span></span><br><span class="line">result1 = data.apply(pd.value_counts)</span><br><span class="line"><span class="built_in">print</span>(result1)</span><br><span class="line"><span class="comment">#    Qu1  Qu2  Qu3</span></span><br><span class="line"><span class="comment"># a  1.0  NaN  NaN</span></span><br><span class="line"><span class="comment"># b  1.0  2.0  NaN</span></span><br><span class="line"><span class="comment"># c  NaN  NaN  3.0</span></span><br><span class="line"><span class="comment"># d  1.0  1.0  1.0</span></span><br><span class="line"><span class="comment"># e  2.0  2.0  1.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到每一个元素在每一列中出现的次数,对有的列中没有出现的数值的频率为NA的值设置为0</span></span><br><span class="line">result2 = data.apply(pd.value_counts).fillna(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(result2)</span><br><span class="line"><span class="comment">#    Qu1  Qu2  Qu3</span></span><br><span class="line"><span class="comment"># a  1.0  0.0  0.0</span></span><br><span class="line"><span class="comment"># b  1.0  2.0  0.0</span></span><br><span class="line"><span class="comment"># c  0.0  0.0  3.0</span></span><br><span class="line"><span class="comment"># d  1.0  1.0  1.0</span></span><br><span class="line"><span class="comment"># e  2.0  2.0  1.0</span></span><br></pre></td></tr></table></figure>






</div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>