<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;数据库&quot;&gt;&lt;a href=&quot;#数据库&quot; class=&quot;headerlink&quot; title=&quot;数据库&quot;&gt;&lt;/a&gt;数据库&lt;/h1&gt;&lt;p&gt;NoSQL优点:"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>千锋教育3_数据库 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Python/" rel="tag">Python</a></div><div class="post-time">2019-06-17</div></div></div><div class="container post-header"><h1>千锋教育3_数据库</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9CmongoDB%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.</span> <span class="toc-text">操作mongoDB数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E9%9B%86%E5%90%88"><span class="toc-number">1.2.</span> <span class="toc-text">操作集合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3"><span class="toc-number">1.3.</span> <span class="toc-text">操作文档</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis"><span class="toc-number">2.</span> <span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2string"><span class="toc-number">2.1.</span> <span class="toc-text">字符串string</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#key"><span class="toc-number">2.2.</span> <span class="toc-text">key</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%88%E5%B8%8Chash"><span class="toc-number">2.3.</span> <span class="toc-text">哈希hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%97%E8%A1%A8list"><span class="toc-number">2.4.</span> <span class="toc-text">列表list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%86%E5%90%88set"><span class="toc-number">2.5.</span> <span class="toc-text">集合set</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88zset"><span class="toc-number">2.6.</span> <span class="toc-text">有序集合zset</span></a></li></ol></li></ol></details></div><div class="container post-content"><h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><p>NoSQL优点:</p>
<ol>
<li>高可扩展性</li>
<li>分布式计算</li>
<li>低成本</li>
<li>架构的灵活性,半结构化数据</li>
<li>没有复杂的关系</li>
</ol>
<p>缺点:</p>
<ol>
<li>没有标准化</li>
<li>有限的查询功能</li>
<li>最终一致是不直观的程序</li>
</ol>
<p>NoSQL分类:</p>
<ol>
<li>列存储:<br>顾名思义，是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的IO优势</li>
<li>文档存储:<br>文档存储一般用类似json的格式存储，存储的内容是文档型的。这样也就有有机会对某些字段建立索引，实现关系散据库的某些功能</li>
<li>Key-value存储:<br>可以通过key快速查询到其value，一般来说，存储不管value的格式，照单全收。（Redis包含了其他功能）</li>
<li>图存储:<br>通过类似面向对象语言的语法操作数据库，通过对象的方式存取数据</li>
<li>XML存储:<br>高效的存储XML数据，并支持XML的内部查询语法，比如XQuery,Xpath</li>
</ol>
<table>
<thead>
<tr>
<th>SQL术语</th>
<th>MongoDB术语</th>
<th>解释说明</th>
</tr>
</thead>
<tbody><tr>
<td>database</td>
<td>database</td>
<td>数据库</td>
</tr>
<tr>
<td>table</td>
<td>collecion</td>
<td>数据库表/集合</td>
</tr>
<tr>
<td>row</td>
<td>document</td>
<td>数据记录行/文档</td>
</tr>
<tr>
<td>column</td>
<td>field</td>
<td>数据字段/域</td>
</tr>
<tr>
<td>index</td>
<td>index</td>
<td>索引</td>
</tr>
<tr>
<td>table joins</td>
<td></td>
<td>表连接MongoDB不支持</td>
</tr>
<tr>
<td>primary key</td>
<td>primary key</td>
<td>主键,MongoDB自动将_id设置为主键</td>
</tr>
</tbody></table>
<p>文档:<br>{name：“张三”，age：20，hobby：{“看书”，“旅游”，“唱歌”}}</p>
<p>注意:</p>
<ol>
<li><strong>文档中的键/值对是有序的</strong>。</li>
<li>文档的键必须是字符串</li>
</ol>
<p>如果将文档类比成数据库中的行，那么集合就可以类比成数据库的表</p>
<p>在mongodb中的集合是无模式的，也就是说集合中存储的文档的结构可以是不同的，比如下面的两个文档可以同时存入到一个集合中:<br>{“name”:”hyl”}<br>{“name”:”hyl”,”age”:1}</p>
<table>
<thead>
<tr>
<th align="left"><strong>Type</strong></th>
<th align="left"><strong>Number</strong></th>
<th align="left"><strong>String</strong></th>
<th align="left"><strong>Notes</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">Double</td>
<td align="left">1</td>
<td align="left">“double”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">字符串</td>
<td align="left">2</td>
<td align="left">“string”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">对象</td>
<td align="left">3</td>
<td align="left">“object”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">数组</td>
<td align="left">4</td>
<td align="left">“array”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">二进制数据</td>
<td align="left">5</td>
<td align="left">“binData”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">未定义</td>
<td align="left">6</td>
<td align="left">“undefined”</td>
<td align="left">已过期</td>
</tr>
<tr>
<td align="left">ObjectId</td>
<td align="left">7</td>
<td align="left">“objectId”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">Boolean</td>
<td align="left">8</td>
<td align="left">“bool”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">日期</td>
<td align="left">9</td>
<td align="left">“date”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">空</td>
<td align="left">10</td>
<td align="left">“null”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">正则表达式</td>
<td align="left">11</td>
<td align="left">“regex”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">DBPointer</td>
<td align="left">12</td>
<td align="left">“dbPointer”</td>
<td align="left">已过期</td>
</tr>
<tr>
<td align="left">JavaScript(代码)</td>
<td align="left">13</td>
<td align="left">“javascript”</td>
<td align="left">此数据类型用于将JavaScript代码存储到文档中</td>
</tr>
<tr>
<td align="left">符号</td>
<td align="left">14</td>
<td align="left">“symbol”</td>
<td align="left">已过期</td>
</tr>
<tr>
<td align="left">JavaScript(带范围)</td>
<td align="left">15</td>
<td align="left">“javascriptWithScope”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">32位整数</td>
<td align="left">16</td>
<td align="left">“int”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">时间戳</td>
<td align="left">17</td>
<td align="left">“timestamp”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">64位整数</td>
<td align="left">18</td>
<td align="left">“long”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">Decimal128</td>
<td align="left">19</td>
<td align="left">“decimal”</td>
<td align="left">New in version 3.4</td>
</tr>
<tr>
<td align="left">Min key</td>
<td align="left">-1</td>
<td align="left">“minKey”</td>
<td align="left">—–</td>
</tr>
<tr>
<td align="left">Max key</td>
<td align="left">127</td>
<td align="left">“maxKey”</td>
<td align="left">—–</td>
</tr>
</tbody></table>
<h2 id="操作mongoDB数据库"><a href="#操作mongoDB数据库" class="headerlink" title="操作mongoDB数据库"></a>操作mongoDB数据库</h2><ol>
<li><p>创建数据库:<br>如果数据库不存在则创建数据库,否则切换到指定的数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名</span><br></pre></td></tr></table></figure></li>
<li><p>查看所有数据库:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show dbs</span><br></pre></td></tr></table></figure>

<p>注意:刚创建的数据库是不能显示的.必须插入数据库才能显示</p>
</li>
<li><p>查看当前正在使用的数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db</span><br></pre></td></tr></table></figure>

<p>或:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.getName()</span><br></pre></td></tr></table></figure></li>
<li><p>删除数据库:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.dropDatabase()</span><br></pre></td></tr></table></figure></li>
<li><p>插入数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.insert(&#123;name:&quot;hyl&quot;,age:18,gender:1,address:&quot;北京&quot;&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>断开连接:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="操作集合"><a href="#操作集合" class="headerlink" title="操作集合"></a>操作集合</h2><ol>
<li><p>查看当前数据库下有哪些集合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show collections</span><br></pre></td></tr></table></figure></li>
<li><p>创建集合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection(&quot;集合名&quot;)</span><br></pre></td></tr></table></figure>

<p>或者:<br>创建一个空的集合并添加一个文档</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.insert(document)</span><br></pre></td></tr></table></figure></li>
<li><p>删除当前数据库中的集合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.drop(document)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="操作文档"><a href="#操作文档" class="headerlink" title="操作文档"></a>操作文档</h2><ol>
<li><p>插入文件</p>
<ul>
<li><p>使用 insert()方法插入文档</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.insert(document)</span><br></pre></td></tr></table></figure>

<p>eg:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.student.insert(</span><br><span class="line">&#123;name:&quot;hyl&quot;,age:18,gender:1,address:&quot;北京&quot;&#125;)</span><br></pre></td></tr></table></figure>

<p>如果要插入多条数据:<br>注意要<strong>添加中括号</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.student.insert(</span><br><span class="line">[&#123;name:&quot;hyl&quot;,age:18,gender:1,address:&quot;北京&quot;&#125;,</span><br><span class="line">&#123;name:&quot;dsz&quot;,age:15,gender:0,address:&quot;广州&quot;&#125;,])</span><br></pre></td></tr></table></figure></li>
<li><p>使用save方法插入文档:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.save(文档)</span><br></pre></td></tr></table></figure>

<p>如果不指定<strong>_id字段</strong>，save（）方法类似于 Insert（）方法.如果指定_id字段,则会更新_id字段的数据.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.student.save(</span><br><span class="line">&#123;name:&quot;hyl&quot;,age:18,gender:1,address:&quot;北京&quot;&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.student.save(</span><br><span class="line">&#123;_id:ObjectId(5995096201 723fe2a0d8d17&quot;&#125;,name:&quot;poi&quot;,age:22,gender:7 address:&quot;石家庄&quot;,isDelete:e&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>文档更新:</p>
<ul>
<li><p>udate()方法用于更新已经存在的文档</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.update(</span><br><span class="line">	query,</span><br><span class="line">	update,</span><br><span class="line">	&#123;</span><br><span class="line">        upset:&lt;boolean&gt;,</span><br><span class="line">        multi:&lt;boolean&gt;,</span><br><span class="line">        writeConcern:&lt;document&gt;</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>参数说明:</p>
<ol>
<li>query:<br>updata的查询条件,类似于sql里的update语句内where后面的内容.</li>
<li>update:<br>update的对象和一些更新的操作符($set,​$inc)等</li>
<li>upset:<br>可选.如果不存在update的记录,是否当成新数据插入,true为插入,False为不插入(默认False)</li>
<li>multi:<br>可选.如果查找到多条数据,是否更新全部数据,否则只更新一条数据(默认False)</li>
<li>writeConcern:<br>可选,抛出异常的级别.</li>
</ol>
</li>
</ul>
</li>
</ol>
<pre><code> 示例:将李雷的年龄更新为25

 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.update(&#123;name:&quot;lilei&quot;&#125;,&#123;$set:&#123;age:25&#125;&#125;)</span><br></pre></td></tr></table></figure>

 将所有名字是李雷的人年龄更新为25

 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.update(&#123;name:&quot;lilei&quot;&#125;,&#123;$set:&#123;age:25&#125;&#125;,&#123;mutil:true&#125;)</span><br></pre></td></tr></table></figure>
</code></pre>
<ul>
<li><p>save()方法通过传入的文档<strong>替换</strong>已有文档:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.save(</span><br><span class="line">	document,</span><br><span class="line">	&#123;</span><br><span class="line">        writeConcern:&lt;document&gt;</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="3">
<li><p>文档删除</p>
<ul>
<li><p>说明：在执行 removel（）函数前，先执行find命令来判断执行的条件是否存在是一个良好习惯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.remove(</span><br><span class="line">	query,</span><br><span class="line">	&#123;</span><br><span class="line">        justOne:&lt;boolean&gt;,</span><br><span class="line">        writeConcern:&lt;document&gt;</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ol>
<li>query:<br>可选,删除文档的条件</li>
<li>justOne:<br>可选,如果为tureen或1,则只删除一个文档</li>
<li>writeConcern:<br>可选,抛出异常的级别.</li>
</ol>
</li>
<li><p>eg:删除名字为tom的学生</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.student.remove(&#123;name:&quot;tom&quot;&#125;)</span><br><span class="line"></span><br><span class="line">db.student.remove(&#123;name:&quot;tom&quot;&#125;,&#123;justOne:&quot;true&quot;&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>文档查询:</p>
<ul>
<li><p>find()方法:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 查询集合下所有的文档</span><br><span class="line">db.集合名.find()</span><br><span class="line"></span><br><span class="line">db.student.find()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 查询指定列</span><br><span class="line">db.集合名.find(</span><br><span class="line">	query,</span><br><span class="line">	&#123;</span><br><span class="line">        &lt;key&gt;:1,</span><br><span class="line">        &lt;key&gt;:1</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// 查看年龄为18的所有人的姓名,性别:</span><br><span class="line">db.student.find(&#123;age:18&#125;,&#123;name:1,age:1&#125;)</span><br></pre></td></tr></table></figure>

<p>query:查询条件<br>key:要显示的字段,1表示显示</p>
</li>
<li><p>pretty()方法以格式化的方式来显示文档</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bd.student.find().pretty()</span><br></pre></td></tr></table></figure></li>
<li><p>findOne():方法查询匹配结果哦第一条数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.findOne(&#123;gender:0&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>查询条件操作符:</p>
<ul>
<li><p><code>$gt</code>,<code>$gte</code>,<code>$lt</code>,<code>$lte</code>:大于,大于等于,小于,小于等于.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.find(&lt;key&gt;:&#123;$gt:&lt;value&gt;&#125;)</span><br><span class="line"></span><br><span class="line">// 查询年龄大于20的学生</span><br><span class="line">db.student.find(&#123;age:&#123;$gt:20&#125;&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 查询年龄大于20,小于40的学生</span><br><span class="line">db.student.find(&#123;age:&#123;$gte:20,$lte:40&#125;&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>等于使用冒号<code>:</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.findOne(&#123;gender:0&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>使用id进行查询:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.find(&#123;&quot;_id&quot;:ObjectId(&quot;59995084b019723fe2a0d8d14&quot;)&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>id查询某个结果集的数据条数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.find().count()</span><br></pre></td></tr></table></figure></li>
<li><p>查询某个字段的值当中是否包含另一个值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 查询名字包含yl的学生</span><br><span class="line">db.student.find(&#123;name:/yl/&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>ObjectId()查询某个字段的值是否以另一个值开头</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 查询名字以h开头的学生</span><br><span class="line">db.student.find(&#123;name:/^h/&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>and,or:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.find(条件1,条件2,条件3....)</span><br><span class="line"></span><br><span class="line">db.student.find(&#123;age:&#123;$gt:16&#125;,gender:0&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.find(&#123;</span><br><span class="line">    $or:[&#123;条件1&#125;,&#123;条件2&#125;,&#123;条件3&#125;....]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">db.student.find(&#123;$or:[&#123;age:&#123;$gt:16&#125;&#125;,&#123;gender:0&#125;]&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.find(&#123;</span><br><span class="line">	条件1,</span><br><span class="line">	条件2,</span><br><span class="line">    $or:[&#123;条件3&#125;,&#123;条件4&#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>limit,skip:</p>
<ul>
<li><p>limit():读取指定数量的数据记录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.find().limit(2)</span><br></pre></td></tr></table></figure></li>
<li><p>skip():跳过指定数量的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 跳过前三条</span><br><span class="line">db.student.find().skip(3)</span><br></pre></td></tr></table></figure></li>
<li><p>limit与skip联合使用:<br>实现分页功能</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.find().skip(3).limit(2)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>排序:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.find().sort(&lt;key&gt;:1|-1)</span><br></pre></td></tr></table></figure>

<p>1表示升序,-1表示降序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.student.find().sort(age:1)</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><p>终端运行redis:<br>进入目录,执行redis-cli.exe</p>
<ol>
<li>redis是key-vaue的数据，所以每个数据都是一个键值对</li>
<li>键的类型是字符串</li>
<li>值的类型分为五种:<ul>
<li>字符串string</li>
<li>哈希hash</li>
<li>列表list</li>
<li>集合set</li>
<li>有序集合zset</li>
</ul>
</li>
<li>数据操作的全部命令<a target="_blank" rel="noopener" href="http://redis.cn/commands.html">http://redis.cn/commands.html</a></li>
</ol>
<hr>
<h2 id="字符串string"><a href="#字符串string" class="headerlink" title="字符串string"></a>字符串string</h2><p>String是 redis最基本的类型，最大能存储512M的数据.<br>string类型是二进制安全的，即可以存储任何数据、比如数字,图片、序列化对象等</p>
<ol>
<li><p>设置</p>
<ul>
<li><p>设置键值:<br>set key value</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set a_key &quot;a_value&quot;</span><br></pre></td></tr></table></figure></li>
<li><p>设置值键值及过期时间,以秒为单位<br>setex key seconds value</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setex a_key 10 &quot;a_value&quot;</span><br></pre></td></tr></table></figure></li>
<li><p>设置多个键值:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mset key1 value1 key2 value2 key3 value3</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>获取:</p>
<ul>
<li>根据键获取值,如果将不存在者None<br>get key</li>
<li>根据多个键获取多个值<br>get key1 key2 key3…</li>
</ul>
</li>
<li><p>运算</p>
<ul>
<li><p>要求：值是字符串类型的数字</p>
</li>
<li><p>将key对应的值加1/减1:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">incr key1</span><br><span class="line">decr key2</span><br></pre></td></tr></table></figure></li>
<li><p>将key对应的值加n/减n:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">incrby key intnum</span><br><span class="line">decrby key intnum</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>其他</p>
<ul>
<li>追加值(比如给字符串最后加一个标点符号)<br>append key value</li>
<li>获取值长度<br>strlen key</li>
</ul>
</li>
</ol>
<h2 id="key"><a href="#key" class="headerlink" title="key"></a>key</h2><ol>
<li><p>查找键:<br>keys pattern<br>(注意:pattern支持正则)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查找全部</span><br><span class="line">keys *</span><br></pre></td></tr></table></figure></li>
<li><p>判断键是否存在，如果存在返回1，不存在返回0:<br>exsits key</p>
</li>
<li><p>查看键对应的value类型:<br>type key</p>
</li>
<li><p>删除键及对应的值</p>
<p>del key1 key2 key3…</p>
</li>
<li><p>设置过期时间(以秒为单位):<br>expire key seconds</p>
</li>
<li><p>查看有效时间(以秒为单位):<br>ttl key</p>
</li>
</ol>
<h2 id="哈希hash"><a href="#哈希hash" class="headerlink" title="哈希hash"></a>哈希hash</h2><ol>
<li><p>用于存储对象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;name:&quot;tom&quot;,age:18&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>设置:</p>
<ul>
<li><p>设置单个值:<br>hset key field value</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hset student1 name hyl</span><br><span class="line">hset student1 age 18</span><br></pre></td></tr></table></figure></li>
<li><p>设置多个值:<br>hmset key filed1 value1 filed2 value2…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hmset student1 name hyl age 18</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>获取:</p>
<ul>
<li><p>获取一个属性的值:<br>hget key filed</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hget student1 name</span><br></pre></td></tr></table></figure></li>
<li><p>获取多个属性的值:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hmget student1 name age gander</span><br></pre></td></tr></table></figure></li>
<li><p>获取所有属性和值:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgetall student1</span><br></pre></td></tr></table></figure></li>
<li><p>获取所有的属性:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hkeys student1</span><br></pre></td></tr></table></figure></li>
<li><p>获取所有的值:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hvals student1</span><br></pre></td></tr></table></figure></li>
<li><p>返回包含属性的个数:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hlen student1</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>其他:</p>
<ul>
<li><p>判断属性是否存在:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexists student1 name</span><br></pre></td></tr></table></figure></li>
<li><p>删除属性及值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hdel key field1 field2...</span><br><span class="line"></span><br><span class="line">hdel student1 name gender</span><br></pre></td></tr></table></figure></li>
<li><p>获取指定field的长度:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hstrlen student1 age</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="列表list"><a href="#列表list" class="headerlink" title="列表list"></a>列表list</h2><ol>
<li><p>概述:<br>列表的元素类型为 string，按照插入顺序排序，在列表的头部或尾部添加元素.<br>其实就是一个<strong>双向队列</strong>.</p>
</li>
<li><p>设置:</p>
<ul>
<li><p>在头部插入:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lpush key value1 value2....</span><br><span class="line"></span><br><span class="line">lpush students hyl</span><br></pre></td></tr></table></figure></li>
<li><p>在尾部插入:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpush key value</span><br></pre></td></tr></table></figure></li>
<li><p>在一个元素的前|后插入新元素:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linsert key before|after pivot value</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 在students对应的列表中,在hyl元素的后面添加一个dsl</span><br><span class="line">linsert students after hyl dsl</span><br></pre></td></tr></table></figure></li>
<li><p>设置指定索引的元素值:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lset key index value</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 在students对应的列表中,将索引值为2的元素的值改为40</span><br><span class="line">lset students 2 40</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>获取:</p>
<ul>
<li><p>弹出key对应的list的第一个元素.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpop key</span><br></pre></td></tr></table></figure></li>
<li><p>弹出key对应的list的最后一个元素.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpop key</span><br></pre></td></tr></table></figure>

<p>注意:索引值可以是负数,表示偏移量是从另外一边开始</p>
</li>
<li><p>返回存储在key的列表中的指定范围的元素:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lrange key start end</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 弹出index0-2的元素</span><br><span class="line">lrange students 0 2</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 弹出全部的元素</span><br><span class="line">lrange students 0 -1</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>其他:</p>
<ul>
<li><p>裁剪列表:改为原集合的一个子集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ltrim key start end</span><br></pre></td></tr></table></figure>

<p>注意包含上下限:<br>eg:<code>ltrim students 0 1</code>:获取前两个元素</p>
</li>
<li><p>返回list长度</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llen key</span><br></pre></td></tr></table></figure></li>
<li><p>返回列表中索引对应的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lindex key index</span><br><span class="line"></span><br><span class="line"># 获取students对应的列表中索引值为20的元素</span><br><span class="line">lindex students 20</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="集合set"><a href="#集合set" class="headerlink" title="集合set"></a>集合set</h2><ol>
<li><p>无序集合,==元素类型为string类型==.</p>
</li>
<li><p>设置:</p>
<ul>
<li><p>添加元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sadd key menber1 menber2... </span><br><span class="line"></span><br><span class="line"># 添加一个集合,集合元素为hyl,gzr,dsz</span><br><span class="line">sadd students hyl gzr dsz</span><br></pre></td></tr></table></figure></li>
<li><p>获取:</p>
<ul>
<li><p>返回key集合中所有元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">smembers key</span><br><span class="line"></span><br><span class="line"># 返回students对应的集合的所有元素</span><br><span class="line">sadd students</span><br></pre></td></tr></table></figure></li>
<li><p>返回集合元素个数:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scard key</span><br><span class="line"></span><br><span class="line">scard students</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p>其他:</p>
<ul>
<li><p>交集:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sinter key1 key2 key3...</span><br></pre></td></tr></table></figure></li>
<li><p>差集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdiff key1 key2 key3...</span><br></pre></td></tr></table></figure></li>
<li><p>合集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sunion key1 key2 key3...</span><br></pre></td></tr></table></figure></li>
<li><p>判断元素是否在集合中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sismumber key member</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="有序集合zset"><a href="#有序集合zset" class="headerlink" title="有序集合zset"></a>有序集合zset</h2><ol>
<li><p>有序集合，元素类型为 Sting，元素具有唯一性,不能重复<br><strong>每个元素都会关联一个double类型的 score（表示权重）通过权重进行大小排序，元素的 score可以相同</strong>.</p>
</li>
<li><p>设置:</p>
<ul>
<li><p>添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zadd key score1 member1 score2 member2...</span><br></pre></td></tr></table></figure></li>
<li><p> 获取:</p>
</li>
</ul>
<ol>
<li><p>返回指定范围的元素(第几个元素到第几个元素)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">zrange key start end</span><br><span class="line"></span><br><span class="line"># 查看全部的数据</span><br><span class="line">zrange students 0 -1</span><br></pre></td></tr></table></figure></li>
<li><p>返回元素个数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zcard key</span><br></pre></td></tr></table></figure></li>
<li><p>返回有序集合key中,score在min和max之间的元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zcount key min max</span><br></pre></td></tr></table></figure></li>
<li><p>返回有序集合key中，成员 member的 score值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">zscore key member</span><br><span class="line"></span><br><span class="line"># 查看students中hyl的权重</span><br><span class="line">zscore students hyl</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<hr>
<p>redis其实一般是用于缓存的.(因为redis的查询速度很快)</p>
<ol>
<li>公司使用MySQL存储全部数据,使用redis存储常用数据(比如说账号密码)</li>
<li>用户登录时,服务器先去redis查询该用户<ul>
<li>如果查询成功,那么直接从redis返回数据(不经过MySQL)</li>
<li>如果查询失败,那么再去MySQL里查询数据.<br>然后把查询过来的数据存储到Redis里</li>
</ul>
</li>
</ol>
<p><img src="/images/redis%E7%94%A8%E4%BD%9C%E5%AD%98%E7%BC%93.jpg" alt="redis用作存缓"></p>
<p>​    </p>
</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>