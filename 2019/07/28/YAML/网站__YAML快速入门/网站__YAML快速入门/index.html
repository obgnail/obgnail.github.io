<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;一、简介&quot;&gt;&lt;a href=&quot;#一、简介&quot; class=&quot;headerlink&quot; title=&quot;一、简介&quot;&gt;&lt;/a&gt;一、简介&lt;/h2&gt;&lt;p&gt;YAML 是专门用来写配置文件的语言，非常简洁和强大，远比 JSON 格式方便。"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>YAML快速入门 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/YAML/" rel="tag">YAML</a></div><div class="post-time">2019-07-28</div></div></div><div class="container post-header"><h1>YAML快速入门</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">一、简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.</span> <span class="toc-text">二、对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%95%B0%E7%BB%84"><span class="toc-number">3.</span> <span class="toc-text">三、数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%A4%8D%E5%90%88%E7%BB%93%E6%9E%84"><span class="toc-number">4.</span> <span class="toc-text">四、复合结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E7%BA%AF%E9%87%8F"><span class="toc-number">5.</span> <span class="toc-text">五、纯量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">6.</span> <span class="toc-text">六、字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%BC%95%E7%94%A8"><span class="toc-number">7.</span> <span class="toc-text">七、引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%88%86%E6%AE%B5"><span class="toc-number">8.</span> <span class="toc-text">八、分段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%92%8Cpython%E4%BA%A4%E4%BA%92"><span class="toc-number">9.</span> <span class="toc-text">和python交互</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PyYaml"><span class="toc-number">9.1.</span> <span class="toc-text">PyYaml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%99%A8%E3%80%81%E8%A1%A8%E7%A4%BA%E5%99%A8%E3%80%81%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="toc-number">9.2.</span> <span class="toc-text">构造器、表示器、解析器</span></a></li></ol></li></ol></details></div><div class="container post-content"><h2 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h2><p>YAML 是专门用来写配置文件的语言，非常简洁和强大，远比 JSON 格式方便。</p>
<p>基本语法规则如下:</p>
<ul>
<li>大小写敏感</li>
<li>使用缩进表示层级关系</li>
<li>缩进时不允许使用Tab键，只允许使用空格。</li>
<li>缩进的空格数目不重要，只要相同层级的元素左侧对齐即可</li>
<li><code>#</code> 表示注释</li>
</ul>
<p>YAML 支持的数据结构有三种。</p>
<ul>
<li>对象：<br>键值对的集合，又称为映射（mapping）/ 哈希（hashes） / <strong>字典</strong>（dictionary）</li>
<li>数组：<br>一组按次序排列的值，又称为序列（sequence） / <strong>列表</strong>（list）</li>
<li>纯量（scalars）：<br>单个的、不可再分的<strong>值</strong></li>
</ul>
<h2 id="二、对象"><a href="#二、对象" class="headerlink" title="二、对象"></a>二、对象</h2><p>对象的一组键值对，使用冒号结构表示。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">animal:</span> <span class="string">pets</span></span><br><span class="line"><span class="attr">hash:</span> &#123; <span class="attr">name:</span> <span class="string">Steve</span>, <span class="attr">foo:</span> <span class="string">bar</span> &#125; </span><br></pre></td></tr></table></figure>

<p>转为JavaScript :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">animal</span>: <span class="string">&#x27;pets&#x27;</span> &#125;</span><br><span class="line">&#123; <span class="attr">hash</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;Steve&#x27;</span>, <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span> &#125; &#125;</span><br></pre></td></tr></table></figure>



<h2 id="三、数组"><a href="#三、数组" class="headerlink" title="三、数组"></a>三、数组</h2><p>一组<strong>连词线开头</strong>的行，构成一个数组。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">Cat</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">Dog</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">Goldfish</span></span><br></pre></td></tr></table></figure>

<p>转为 JavaScript</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ <span class="string">&#x27;Cat&#x27;</span>, <span class="string">&#x27;Dog&#x27;</span>, <span class="string">&#x27;Goldfish&#x27;</span> ]</span><br></pre></td></tr></table></figure>

<p>嵌套数组，则在该项下面缩进一个空格。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Cat</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Dog</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Goldfish</span></span><br></pre></td></tr></table></figure>

<p>转为JS :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ [ <span class="string">&#x27;Cat&#x27;</span>, <span class="string">&#x27;Dog&#x27;</span>, <span class="string">&#x27;Goldfish&#x27;</span> ] ]</span><br></pre></td></tr></table></figure>

<p>数组也可以采用行内表示法。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">animal:</span> [<span class="string">Cat</span>, <span class="string">Dog</span>]</span><br></pre></td></tr></table></figure>

<p>转为 JavaScript</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">animal</span>: [ <span class="string">&#x27;Cat&#x27;</span>, <span class="string">&#x27;Dog&#x27;</span> ] &#125;</span><br></pre></td></tr></table></figure>



<h2 id="四、复合结构"><a href="#四、复合结构" class="headerlink" title="四、复合结构"></a>四、复合结构</h2><p>对象和数组可以结合使用，形成复合结构。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">languages:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Ruby</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Perl</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Python</span> </span><br><span class="line"><span class="attr">websites:</span></span><br><span class="line"> <span class="attr">YAML:</span> <span class="string">yaml.org</span> </span><br><span class="line"> <span class="attr">Ruby:</span> <span class="string">ruby-lang.org</span> </span><br><span class="line"> <span class="attr">Python:</span> <span class="string">python.org</span> </span><br><span class="line"> <span class="attr">Perl:</span> <span class="string">use.perl.org</span> </span><br></pre></td></tr></table></figure>

<p>转为 JavaScript 如下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">languages</span>: [ <span class="string">&#x27;Ruby&#x27;</span>, <span class="string">&#x27;Perl&#x27;</span>, <span class="string">&#x27;Python&#x27;</span> ],</span><br><span class="line">  <span class="attr">websites</span>: </span><br><span class="line">  &#123; <span class="attr">YAML</span>: <span class="string">&#x27;yaml.org&#x27;</span>,</span><br><span class="line">    <span class="attr">Ruby</span>: <span class="string">&#x27;ruby-lang.org&#x27;</span>,</span><br><span class="line">    <span class="attr">Python</span>: <span class="string">&#x27;python.org&#x27;</span>,</span><br><span class="line">    <span class="attr">Perl</span>: <span class="string">&#x27;use.perl.org&#x27;</span> &#125; &#125;</span><br></pre></td></tr></table></figure>





<h2 id="五、纯量"><a href="#五、纯量" class="headerlink" title="五、纯量"></a>五、纯量</h2><p>纯量是最基本的、不可再分的值。以下数据类型都属于 JavaScript 的纯量。</p>
<ol>
<li>字符串</li>
<li>布尔值</li>
<li>整数</li>
<li>浮点数</li>
<li>Null</li>
<li>时间</li>
<li>日期</li>
</ol>
<p>表示如下:</p>
<ol>
<li>数值直接以字面量的形式表示。</li>
<li>布尔值用<code>true</code>和<code>false</code>表示。</li>
<li><code>null</code>用<code>~</code>表示。</li>
<li>时间采用 ISO8601 格式。</li>
<li>日期采用复合 iso8601 格式的年、月、日表示。</li>
<li>YAML 允许使用两个感叹号，强制转换数据类型。</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数值直接以字面量的形式表示。</span></span><br><span class="line"><span class="attr">number:</span> <span class="number">12.30</span></span><br><span class="line"><span class="comment"># 布尔值用`true`和`false`表示。</span></span><br><span class="line"><span class="attr">isSet:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># null用~表示。</span></span><br><span class="line"><span class="attr">parent:</span> <span class="string">~</span></span><br><span class="line"><span class="comment"># 时间采用 ISO8601 格式。</span></span><br><span class="line"><span class="attr">iso8601:</span> <span class="number">2001-12-14t21:59:43.10-05:00</span> </span><br><span class="line"><span class="comment"># 日期采用复合 iso8601 格式的年、月、日表示。</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">1976-07-31</span></span><br><span class="line"><span class="comment"># YAML 允许使用两个感叹号，强制转换数据类型。</span></span><br><span class="line"><span class="attr">e:</span> <span class="type">!!str</span> <span class="number">123</span></span><br></pre></td></tr></table></figure>

<p>对应的js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">number</span>: <span class="number">12.30</span> &#125;</span><br><span class="line">&#123; <span class="attr">isSet</span>: <span class="literal">true</span> &#125;</span><br><span class="line">&#123; <span class="attr">parent</span>: <span class="literal">null</span> &#125;</span><br><span class="line">&#123; <span class="attr">iso8601</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">&#x27;2001-12-14t21:59:43.10-05:00&#x27;</span>) &#125;</span><br><span class="line">&#123; <span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">&#x27;1976-07-31&#x27;</span>) &#125;</span><br><span class="line">&#123; <span class="attr">e</span>: <span class="string">&#x27;123&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>





<h2 id="六、字符串"><a href="#六、字符串" class="headerlink" title="六、字符串"></a>六、字符串</h2><ol>
<li>字符串默认<strong>不使用引号表示</strong></li>
<li>如果字符串之中包含空格或特殊字符，需要放在引号之中</li>
<li>单引号和双引号都可以使用，双引号不会对特殊字符转义。</li>
<li>单引号之中如果还有单引号，必须连续使用两个单引号转义。</li>
<li>字符串可以写成多行，从第二行开始，必须有一个<strong>单空格缩进</strong>。换行符会被转为空格。</li>
<li>多行字符串可以使用<code>|</code>保留换行符，也可以使用<code>&gt;</code>折叠换行。</li>
<li><code>+</code>表示保留文字块末尾的换行，<code>-</code>表示删除字符串末尾的换行。</li>
<li>字符串之中可以插入 HTML 标记。</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串默认不使用引号表示</span></span><br><span class="line"><span class="attr">str:</span> <span class="string">这是一行字符串</span></span><br><span class="line"><span class="comment"># 如果字符串之中包含空格或特殊字符，需要放在引号之中</span></span><br><span class="line"><span class="attr">str:</span> <span class="string">&#x27;内容： 字符串&#x27;</span></span><br><span class="line"><span class="comment"># 单引号和双引号都可以使用，双引号不会对特殊字符转义。</span></span><br><span class="line"><span class="attr">s1:</span> <span class="string">&#x27;内容\n字符串&#x27;</span></span><br><span class="line"><span class="attr">s2:</span> <span class="string">&quot;内容\n字符串&quot;</span></span><br><span class="line"><span class="comment"># 单引号之中如果还有单引号，必须连续使用两个单引号转义。</span></span><br><span class="line"><span class="attr">str:</span> <span class="string">&#x27;labor&#x27;</span><span class="string">&#x27;s day&#x27;</span></span><br><span class="line"><span class="comment"># 字符串可以写成多行，从第二行开始，必须有一个单空格缩进。换行符会被转为空格。</span></span><br><span class="line"><span class="attr">str:</span> <span class="string">这是一段</span></span><br><span class="line">  <span class="string">多行</span></span><br><span class="line">  <span class="string">字符串</span></span><br><span class="line"><span class="comment"># 多行字符串可以使用|保留换行符，也可以使用&gt;折叠换行。</span></span><br><span class="line"><span class="attr">this:</span> <span class="string">|</span></span><br><span class="line"><span class="string">  Foo</span></span><br><span class="line"><span class="string">  Bar</span></span><br><span class="line"><span class="string"></span><span class="attr">that:</span> <span class="string">&gt;</span></span><br><span class="line"><span class="string">  Foo</span></span><br><span class="line"><span class="string">  Bar</span></span><br><span class="line"><span class="string"></span><span class="comment"># +表示保留文字块末尾的换行，-表示删除字符串末尾的换行。</span></span><br><span class="line"><span class="attr">s1:</span> <span class="string">|</span></span><br><span class="line"><span class="string">  Foo</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="attr">s2:</span> <span class="string">|+</span></span><br><span class="line"><span class="string">  Foo</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"></span><br><span class="line"><span class="attr">s3:</span> <span class="string">|-</span></span><br><span class="line"><span class="string">  Foo</span></span><br><span class="line"><span class="string"></span><span class="comment"># 字符串之中可以插入 HTML 标记。</span></span><br><span class="line"><span class="attr">message:</span> <span class="string">|</span></span><br><span class="line"></span><br><span class="line">  <span class="string">&lt;p</span> <span class="string">style=&quot;color:</span> <span class="string">red&quot;&gt;</span></span><br><span class="line">    <span class="string">段落</span></span><br><span class="line">  <span class="string">&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>

<p>转为 JavaScript 如下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">str</span>: <span class="string">&#x27;这是一行字符串&#x27;</span> &#125;</span><br><span class="line">&#123; <span class="attr">str</span>: <span class="string">&#x27;内容: 字符串&#x27;</span> &#125;</span><br><span class="line">&#123; <span class="attr">s1</span>: <span class="string">&#x27;内容\\n字符串&#x27;</span>, <span class="attr">s2</span>: <span class="string">&#x27;内容\n字符串&#x27;</span> &#125;</span><br><span class="line">&#123; <span class="attr">str</span>: <span class="string">&#x27;labor\&#x27;s day&#x27;</span> &#125;</span><br><span class="line">&#123; <span class="attr">str</span>: <span class="string">&#x27;这是一段 多行 字符串&#x27;</span> &#125;</span><br><span class="line">&#123; <span class="attr">this</span>: <span class="string">&#x27;Foo\nBar\n&#x27;</span>, <span class="attr">that</span>: <span class="string">&#x27;Foo Bar\n&#x27;</span> &#125;</span><br><span class="line"> &#123; <span class="attr">s1</span>: <span class="string">&#x27;Foo\n&#x27;</span>, <span class="attr">s2</span>: <span class="string">&#x27;Foo\n\n\n&#x27;</span>, <span class="attr">s3</span>: <span class="string">&#x27;Foo&#x27;</span> &#125;</span><br><span class="line"> &#123; <span class="attr">message</span>: <span class="string">&#x27;\n&lt;p style=&quot;color: red&quot;&gt;\n  段落\n&lt;/p&gt;\n&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>



<h2 id="七、引用"><a href="#七、引用" class="headerlink" title="七、引用"></a>七、引用</h2><p>锚点<code>&amp;</code>和别名<code>*</code>，可以用来引用</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">defaults:</span> <span class="meta">&amp;defaults</span></span><br><span class="line">  <span class="attr">adapter:</span>  <span class="string">postgres</span></span><br><span class="line">  <span class="attr">host:</span>     <span class="string">localhost</span></span><br><span class="line"></span><br><span class="line"><span class="attr">development:</span></span><br><span class="line">  <span class="attr">database:</span> <span class="string">myapp_development</span></span><br><span class="line">  <span class="string">&lt;&lt;:</span> <span class="meta">*defaults</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">database:</span> <span class="string">myapp_test</span></span><br><span class="line">  <span class="string">&lt;&lt;:</span> <span class="meta">*defaults</span></span><br></pre></td></tr></table></figure>

<p>等同于下面的代码。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">defaults:</span></span><br><span class="line">  <span class="attr">adapter:</span>  <span class="string">postgres</span></span><br><span class="line">  <span class="attr">host:</span>     <span class="string">localhost</span></span><br><span class="line"></span><br><span class="line"><span class="attr">development:</span></span><br><span class="line">  <span class="attr">database:</span> <span class="string">myapp_development</span></span><br><span class="line">  <span class="attr">adapter:</span>  <span class="string">postgres</span></span><br><span class="line">  <span class="attr">host:</span>     <span class="string">localhost</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">database:</span> <span class="string">myapp_test</span></span><br><span class="line">  <span class="attr">adapter:</span>  <span class="string">postgres</span></span><br><span class="line">  <span class="attr">host:</span>     <span class="string">localhost</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>&amp;</code>用来建立锚点（<code>defaults</code>），<code>&lt;&lt;</code>表示合并到当前数据，<code>*</code>用来引用锚点。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">&amp;showell</span> <span class="string">Steve</span> </span><br><span class="line"><span class="bullet">-</span> <span class="string">Clark</span> </span><br><span class="line"><span class="bullet">-</span> <span class="string">Brian</span> </span><br><span class="line"><span class="bullet">-</span> <span class="string">Oren</span> </span><br><span class="line"><span class="bullet">-</span> <span class="string">*showell</span> </span><br></pre></td></tr></table></figure>

<p>转为 JavaScript 代码如下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ <span class="string">&#x27;Steve&#x27;</span>, <span class="string">&#x27;Clark&#x27;</span>, <span class="string">&#x27;Brian&#x27;</span>, <span class="string">&#x27;Oren&#x27;</span>, <span class="string">&#x27;Steve&#x27;</span> ]</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="八、分段"><a href="#八、分段" class="headerlink" title="八、分段"></a>八、分段</h2><p>在同一个yaml文件中，可以用 — 来分段，这样可以将多个文档写在一个文件中</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">James</span></span><br><span class="line"><span class="attr">age:</span> <span class="number">20</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Lily</span></span><br><span class="line"><span class="attr">age:</span> <span class="number">19</span></span><br></pre></td></tr></table></figure>





<h2 id="和python交互"><a href="#和python交互" class="headerlink" title="和python交互"></a>和python交互</h2><h3 id="PyYaml"><a href="#PyYaml" class="headerlink" title="PyYaml"></a>PyYaml</h3><p>load() :返回一个对象 </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config.yaml</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Tom</span> <span class="string">Smith</span></span><br><span class="line"><span class="attr">age:</span> <span class="number">37</span></span><br><span class="line"><span class="attr">spouse:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Jane</span> <span class="string">Smith</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">25</span></span><br><span class="line"><span class="attr">children:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Jimmy</span> <span class="string">Smith</span></span><br><span class="line">   <span class="attr">age:</span> <span class="number">15</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">name1:</span> <span class="string">Jenny</span> <span class="string">Smith</span></span><br><span class="line">   <span class="attr">age1:</span> <span class="number">12</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># main.py</span></span><br><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;config.yaml&#x27;</span>)</span><br><span class="line">y = yaml.load(f)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;Tom Smith&#x27;, &#x27;age&#x27;: 37, &#x27;spouse&#x27;: &#123;&#x27;name&#x27;: &#x27;Jane Smith&#x27;, &#x27;age&#x27;: 25&#125;, &#x27;children&#x27;: [&#123;&#x27;name&#x27;: &#x27;Jimmy Smith&#x27;, &#x27;age&#x27;: 15&#125;, &#123;&#x27;name1&#x27;: &#x27;Jenny Smith&#x27;, &#x27;age1&#x27;: 12&#125;]&#125;</span></span><br></pre></td></tr></table></figure>



<p>load_all()生成一个迭代器 </p>
<blockquote>
<p>如果string或文件包含几块yaml文档，你可以使用yaml.load_all来解析全部的文档。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line">f = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">name: James</span></span><br><span class="line"><span class="string">age: 20</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">name: Lily</span></span><br><span class="line"><span class="string">age: 19</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">y = yaml.load_all(f)</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> y:</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;James&#x27;, &#x27;age&#x27;: 20&#125;</span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;Lily&#x27;, &#x27;age&#x27;: 19&#125;</span></span><br></pre></td></tr></table></figure>

<p>yaml.dump 将一个python对象生成为yaml文档</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line">aproject = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Silenthand Olleander&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;race&#x27;</span>: <span class="string">&#x27;Human&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;traits&#x27;</span>: [<span class="string">&#x27;ONE_HAND&#x27;</span>, <span class="string">&#x27;ONE_EYE&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(yaml.dump(aproject,))</span><br><span class="line"><span class="comment"># name: Silenthand Olleander</span></span><br><span class="line"><span class="comment"># race: Human</span></span><br><span class="line"><span class="comment"># traits: [ONE_HAND, ONE_EYE]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>yaml.dump接收的第二个参数一定要是一个打开的文本文件或二进制文件，yaml.dump会把生成的yaml文档写到文件里</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line">aproject = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Silenthand Olleander&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;race&#x27;</span>: <span class="string">&#x27;Human&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;traits&#x27;</span>: [<span class="string">&#x27;ONE_HAND&#x27;</span>, <span class="string">&#x27;ONE_EYE&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;config.yaml&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(yaml.dump(aproject,f))</span><br></pre></td></tr></table></figure>
</blockquote>
<p>yaml.dump_all()将多个段输出到一个文件中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line">obj1 = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;James&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">20</span>&#125;</span><br><span class="line">obj2 = [<span class="string">&quot;Lily&quot;</span>, <span class="number">19</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;config.yaml&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    yaml.dump_all([obj1, obj2], f)</span><br></pre></td></tr></table></figure>



<h3 id="构造器、表示器、解析器"><a href="#构造器、表示器、解析器" class="headerlink" title="构造器、表示器、解析器"></a>构造器、表示器、解析器</h3><p>构造器(constructors)、表示器(representers)、解析器(resolvers )</p>
<p>1、yaml.YAMLObject<br>yaml.YAMLObject用元类来注册一个构造器（也就是代码里的 init() 方法），让你把yaml节点转为Python对象实例，用表示器（也就是代码里的 repr() 函数）来让你把Python对象转为yaml节点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">yaml.YAMLObject</span>):</span></span><br><span class="line">    yaml_tag = <span class="string">&#x27;!person&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;%s(name=%s, age=%d)&#x27;</span> % (self.__class__.__name__, self.name, self.age)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">james = Person(<span class="string">&#x27;James&#x27;</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(yaml.dump(james))  <span class="comment"># Python对象实例转为yaml</span></span><br><span class="line"></span><br><span class="line">lily = yaml.load(<span class="string">&#x27;!person &#123;name: Lily, age: 19&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(lily)  <span class="comment"># yaml转为Python对象实例</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line"><span class="comment"># !person &#123;age: 20, name: James&#125;</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># Person(name=Lily, age=19)</span></span><br></pre></td></tr></table></figure>



<p>2、yaml.add_constructor 和 yaml.add_representer </p>
<p>你可能在使用过程中并不想通过上面这种元类的方式，而是想定义正常的类，那么，可以用这两种方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Person(%s, %s)&#x27;</span> % (self.name, self.age)</span><br><span class="line"></span><br><span class="line">james = Person(<span class="string">&#x27;James&#x27;</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span> (yaml.dump(james))  <span class="comment"># 没加表示器之前</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person_repr</span>(<span class="params">dumper, data</span>):</span></span><br><span class="line">    <span class="keyword">return</span> dumper.represent_mapping(<span class="string">u&#x27;!person&#x27;</span>, &#123;<span class="string">&quot;name&quot;</span>: data.name, <span class="string">&quot;age&quot;</span>: data.age&#125;)  <span class="comment"># mapping表示器，用于dict</span></span><br><span class="line"></span><br><span class="line">yaml.add_representer(Person, person_repr)  <span class="comment"># 用add_representer方法为对象添加表示器</span></span><br><span class="line"><span class="built_in">print</span> (yaml.dump(james))  <span class="comment"># 加了表示器之后</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person_cons</span>(<span class="params">loader, node</span>):</span></span><br><span class="line">    value = loader.construct_mapping(node)  <span class="comment"># mapping构造器，用于dict</span></span><br><span class="line">    name = value[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">    age = value[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> Person(name, age)</span><br><span class="line"></span><br><span class="line">yaml.add_constructor(<span class="string">u&#x27;!person&#x27;</span>, person_cons)  <span class="comment"># 用add_constructor方法为指定yaml标签添加构造器</span></span><br><span class="line">lily = yaml.load(<span class="string">&#x27;!person &#123;name: Lily, age: 19&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (lily)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line"><span class="comment"># !!python/object:__main__.Person &#123;age: 20, name: James&#125;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># !person &#123;age: 20, name: James&#125;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Person(Lily, 19)</span></span><br></pre></td></tr></table></figure>















































</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>