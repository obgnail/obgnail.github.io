<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;第三章：数字日期和时间&quot;&gt;&lt;a href=&quot;#第三章：数字日期和时间&quot; class=&quot;headerlink&quot; title=&quot;第三章：数字日期和时间&quot;&gt;&lt;/a&gt;第三章：数字日期和时间&lt;/h2&gt;&lt;h3 id=&quot;3-1-数字的四舍五入&quot;&gt;&lt;a href=&quot;#3-1-数字的四舍五入&quot; class=&quot;headerlink&quot; title=&quot;3.1 数字的四舍五入&quot;&gt;&lt;/a&gt;3.1 数字的四舍五入&lt;/h3&gt;&lt;p&gt;round(value, ndigits) 函数"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>python-cookbook3_第三章_数字日期和时间 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Python/" rel="tag">Python</a></div><div class="post-time">2019-07-27</div></div></div><div class="container post-header"><h1>python-cookbook3_第三章_数字日期和时间</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0%EF%BC%9A%E6%95%B0%E5%AD%97%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4"><span class="toc-number">1.</span> <span class="toc-text">第三章：数字日期和时间</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%95%B0%E5%AD%97%E7%9A%84%E5%9B%9B%E8%88%8D%E4%BA%94%E5%85%A5"><span class="toc-number">1.1.</span> <span class="toc-text">3.1 数字的四舍五入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%89%A7%E8%A1%8C%E7%B2%BE%E7%A1%AE%E7%9A%84%E6%B5%AE%E7%82%B9%E6%95%B0%E8%BF%90%E7%AE%97"><span class="toc-number">1.2.</span> <span class="toc-text">3.2 执行精确的浮点数运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%95%B0%E5%AD%97%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA"><span class="toc-number">1.3.</span> <span class="toc-text">3.3 数字的格式化输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E4%BA%8C%E5%85%AB%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E6%95%B4%E6%95%B0"><span class="toc-number">1.4.</span> <span class="toc-text">3.4 二八十六进制整数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%AD%97%E8%8A%82%E5%88%B0%E5%A4%A7%E6%95%B4%E6%95%B0%E7%9A%84%E6%89%93%E5%8C%85%E4%B8%8E%E8%A7%A3%E5%8C%85"><span class="toc-number">1.5.</span> <span class="toc-text">3.5 字节到大整数的打包与解包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-%E5%A4%8D%E6%95%B0%E7%9A%84%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><span class="toc-number">1.6.</span> <span class="toc-text">3.6 复数的数学运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-%E6%97%A0%E7%A9%B7%E5%A4%A7%E4%B8%8E-NaN"><span class="toc-number">1.7.</span> <span class="toc-text">3.7 无穷大与 NaN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-%E5%88%86%E6%95%B0%E8%BF%90%E7%AE%97"><span class="toc-number">1.8.</span> <span class="toc-text">3.8 分数运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9-%E5%A4%A7%E5%9E%8B%E6%95%B0%E7%BB%84%E8%BF%90%E7%AE%97"><span class="toc-number">1.9.</span> <span class="toc-text">3.9 大型数组运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-10-%E7%9F%A9%E9%98%B5%E4%B8%8E%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%BF%90%E7%AE%97"><span class="toc-number">1.10.</span> <span class="toc-text">3.10 矩阵与线性代数运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-11-%E9%9A%8F%E6%9C%BA%E9%80%89%E6%8B%A9"><span class="toc-number">1.11.</span> <span class="toc-text">3.11 随机选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-12-%E5%9F%BA%E6%9C%AC%E7%9A%84%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.12.</span> <span class="toc-text">3.12 基本的日期与时间转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-13-%E8%AE%A1%E7%AE%97%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E5%91%A8%E4%BA%94%E7%9A%84%E6%97%A5%E6%9C%9F"><span class="toc-number">1.13.</span> <span class="toc-text">3.13 计算最后一个周五的日期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-14-%E8%AE%A1%E7%AE%97%E5%BD%93%E5%89%8D%E6%9C%88%E4%BB%BD%E7%9A%84%E6%97%A5%E6%9C%9F%E8%8C%83%E5%9B%B4"><span class="toc-number">1.14.</span> <span class="toc-text">3.14 计算当前月份的日期范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-15-%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%97%A5%E6%9C%9F%E4%BA%92%E8%BD%AC"><span class="toc-number">1.15.</span> <span class="toc-text">3.15 字符串与日期互转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-16-%E7%BB%93%E5%90%88%E6%97%B6%E5%8C%BA%E7%9A%84%E6%97%A5%E6%9C%9F%E6%93%8D%E4%BD%9C"><span class="toc-number">1.16.</span> <span class="toc-text">3.16 结合时区的日期操作</span></a></li></ol></li></ol></details></div><div class="container post-content"><h2 id="第三章：数字日期和时间"><a href="#第三章：数字日期和时间" class="headerlink" title="第三章：数字日期和时间"></a>第三章：数字日期和时间</h2><h3 id="3-1-数字的四舍五入"><a href="#3-1-数字的四舍五入" class="headerlink" title="3.1 数字的四舍五入"></a>3.1 数字的四舍五入</h3><p>round(value, ndigits) 函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">round</span>(<span class="number">1.23</span>, <span class="number">1</span>))  <span class="comment"># 1.2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">round</span>(<span class="number">1.27</span>, <span class="number">1</span>))  <span class="comment"># 1.3</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">round</span>(-<span class="number">1.27</span>, <span class="number">1</span>)) <span class="comment"># -1.3</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">round</span>(<span class="number">1.25361</span>,<span class="number">3</span>)) <span class="comment"># 1.254</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">round</span>(<span class="number">1627735</span>,-<span class="number">1</span>))  <span class="comment"># 1627740</span></span><br></pre></td></tr></table></figure>



<h3 id="3-2-执行精确的浮点数运算"><a href="#3-2-执行精确的浮点数运算" class="headerlink" title="3.2 执行精确的浮点数运算"></a>3.2 执行精确的浮点数运算</h3><p>浮点数的一个普遍问题是它们并不能精确的表示十进制数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">4.2</span></span><br><span class="line">b = <span class="number">2.1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a+b)   <span class="comment"># 6.300000000000001</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">6.3</span>==a+b) <span class="comment"># False</span></span><br></pre></td></tr></table></figure>

<p>这些错误是由底层 CPU 和 IEEE 754 标准通过自己的浮点单位去执行算术时的特征。由于 Python 的浮点数据类型使用底层表示存储数据，因此你没办法去避免这样的误差。</p>
<p>使用 decimal 模块：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意要传入str</span></span><br><span class="line">a = Decimal(<span class="string">&#x27;4.2&#x27;</span>)</span><br><span class="line">b = Decimal(<span class="string">&#x27;2.1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a+b)   <span class="comment"># 6.3</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">6.3</span> == a+b) <span class="comment"># False</span></span><br><span class="line"><span class="built_in">print</span>(Decimal(<span class="string">&#x27;6.3&#x27;</span>) == a+b) <span class="comment"># False</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>用字符串来表示数字</p>
</blockquote>
<p>使用decimal获取精确到小数位N位:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> localcontext,Decimal</span><br><span class="line"></span><br><span class="line">a = Decimal(<span class="string">&#x27;1.3&#x27;</span>)</span><br><span class="line">b = Decimal(<span class="string">&#x27;1.7&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a/b)  <span class="comment"># 0.7647058823529411764705882353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> localcontext() <span class="keyword">as</span> ctx:</span><br><span class="line">	ctx.prec = <span class="number">50</span></span><br><span class="line">	<span class="built_in">print</span>(a/b)  <span class="comment"># 0.76470588235294117647058823529411764705882352941176</span></span><br></pre></td></tr></table></figure>



<h3 id="3-3-数字的格式化输出"><a href="#3-3-数字的格式化输出" class="headerlink" title="3.3 数字的格式化输出"></a>3.3 数字的格式化输出</h3><p>控制数字的位数、对齐、千位分隔符和其他的细节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">1234.56789</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(x,<span class="string">&#x27;.2f&#x27;</span>))  <span class="comment"># 1234.57</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(x,<span class="string">&#x27;&gt;10.2f&#x27;</span>)) <span class="comment">#    1234.57</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加千位符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(x,<span class="string">&#x27;,&#x27;</span>))  <span class="comment"># 1,234.56789</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(x,<span class="string">&#x27;,.2f&#x27;</span>))  <span class="comment"># 1,234.57</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>format的格式为:<code>&#39;[&lt;&gt;^]?width[,]?(.digits)?&#39;</code></p>
</blockquote>
<h3 id="3-4-二八十六进制整数"><a href="#3-4-二八十六进制整数" class="headerlink" title="3.4 二八十六进制整数"></a>3.4 二八十六进制整数</h3><p>bin() , oct()  , hex() 函数</p>
<blockquote>
<p>也可以使用<code>format</code>来转化</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">1234</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bin</span>(x))  <span class="comment"># 0b10011010010</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">oct</span>(x))  <span class="comment"># 0o2322</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(x))  <span class="comment"># 0x4d2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以使用format转化</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(x,<span class="string">&#x27;b&#x27;</span>))  <span class="comment"># 10011010010</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(x,<span class="string">&#x27;o&#x27;</span>))  <span class="comment"># 2322</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(x,<span class="string">&#x27;x&#x27;</span>))  <span class="comment"># 4d2</span></span><br></pre></td></tr></table></figure>



<h3 id="3-5-字节到大整数的打包与解包"><a href="#3-5-字节到大整数的打包与解包" class="headerlink" title="3.5 字节到大整数的打包与解包"></a>3.5 字节到大整数的打包与解包</h3><ul>
<li>有一个字节字符串并想将它解压成一个整数。</li>
<li>需要将一个大整数转换为一个字节字符串。</li>
</ul>
<p>为了将 bytes 解析为整数，使用 int.from_bytes() 方法<br>为了将一个大整数转换为一个字节字符串，使用 int.to_bytes() 方法</p>
<blockquote>
<p>res = int.from_bytes(x) : </p>
<ul>
<li>把bytes类型的变量x，转化为十进制整数，并存入res中。</li>
<li><code>int.from_bytes(bytes, byteorder, *, signed=False)</code><br>byteorder主要有两种：’big’和’little’；signed=True表示需要考虑符号位。<br>big代表正常顺序,little反之</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">b&#x27;\x00\x124V\x00x\x90\xab\x00\xcd\xef\x01\x00#\x004&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data))  <span class="comment"># 16</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>.from_bytes(data,<span class="string">&#x27;little&#x27;</span>))  <span class="comment"># 69120565665751139577663547927094891008</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>.from_bytes(data,<span class="string">&#x27;big&#x27;</span>))  <span class="comment"># 94522842520747284487117727783387188</span></span><br><span class="line"></span><br><span class="line">x = <span class="number">94522842520747284487117727783387188</span></span><br><span class="line"><span class="built_in">print</span>(x.to_bytes(<span class="number">16</span>,<span class="string">&#x27;big&#x27;</span>))  <span class="comment"># b&#x27;\x00\x124V\x00x\x90\xab\x00\xcd\xef\x01\x00#\x004&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(x.to_bytes(<span class="number">16</span>,<span class="string">&#x27;little&#x27;</span>))  <span class="comment"># b&#x27;4\x00#\x00\x01\xef\xcd\x00\xab\x90x\x00V4\x12\x00&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>字节顺序规则 (little 或 big) 指定了构建整数时的字节的低位高位排列方式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">0x01020304</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.to_bytes(<span class="number">4</span>,<span class="string">&#x27;big&#x27;</span>))  <span class="comment"># b&#x27;\x01\x02\x03\x04&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(x.to_bytes(<span class="number">4</span>,<span class="string">&#x27;little&#x27;</span>))  <span class="comment"># b&#x27;\x04\x03\x02\x01&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="3-6-复数的数学运算"><a href="#3-6-复数的数学运算" class="headerlink" title="3.6 复数的数学运算"></a>3.6 复数的数学运算</h3><p>使用函数 complex(real, imag) 或者是带有后缀 j 的浮点数来指定。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="built_in">complex</span>(<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">b = <span class="number">3</span>-<span class="number">5j</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># (2+4j)</span></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment"># (3-5j)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a.real,a.imag) <span class="comment"># 2.0 4.0</span></span><br><span class="line"><span class="comment"># 共轭复数</span></span><br><span class="line"><span class="built_in">print</span>(a.conjugate()) <span class="comment"># (2-4j)</span></span><br></pre></td></tr></table></figure>



<h3 id="3-7-无穷大与-NaN"><a href="#3-7-无穷大与-NaN" class="headerlink" title="3.7 无穷大与 NaN"></a>3.7 无穷大与 NaN</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line">b = <span class="built_in">float</span>(<span class="string">&#x27;-inf&#x27;</span>)</span><br><span class="line">c = <span class="built_in">float</span>(<span class="string">&#x27;nan&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(math.isinf(a)) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">print</span>(math.isinf(b)) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">print</span>(math.isnan(c)) <span class="comment"># True</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>float(&#39;inf&#39;)</code>,<code>float(&#39;-inf&#39;)</code>,<code>flaot(&#39;nan&#39;)</code>三者都会在运算中传播<br>而nan的等级更高,<strong>inf + nan == nan</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line">b = <span class="built_in">float</span>(<span class="string">&#x27;-inf&#x27;</span>)</span><br><span class="line">c = <span class="built_in">float</span>(<span class="string">&#x27;nan&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a + <span class="number">5</span>) <span class="comment"># inf</span></span><br><span class="line"><span class="built_in">print</span>(a + b) <span class="comment"># nan</span></span><br><span class="line"><span class="built_in">print</span>(a + c) <span class="comment"># nan</span></span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>和js一样,nan之间的比较总是False,只能使用math.isnan来判断</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">float</span>(<span class="string">&#x27;nan&#x27;</span>)</span><br><span class="line">b = <span class="built_in">float</span>(<span class="string">&#x27;nan&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a == b) <span class="comment"># False</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> b) <span class="comment"># False</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="3-8-分数运算"><a href="#3-8-分数运算" class="headerlink" title="3.8 分数运算"></a>3.8 分数运算</h3><p>fractions 模块可以被用来执行包含分数的数学运算。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"></span><br><span class="line">a = Fraction(<span class="number">5</span>,<span class="number">4</span>)</span><br><span class="line">b = Fraction(<span class="number">7</span>,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a.numerator,a.denominator) <span class="comment"># 5 4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">float</span>(a)) <span class="comment"># 1.25</span></span><br><span class="line"><span class="built_in">print</span>(a + b) <span class="comment"># 27/16</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将浮点转为分数</span></span><br><span class="line">x = <span class="number">3.75</span></span><br><span class="line">y = Fraction(*x.as_integer_ratio())</span><br><span class="line"><span class="built_in">print</span>(y)<span class="comment"># 15/4</span></span><br></pre></td></tr></table></figure>



<h3 id="3-9-大型数组运算"><a href="#3-9-大型数组运算" class="headerlink" title="3.9 大型数组运算"></a>3.9 大型数组运算</h3><p>使用 NumPy</p>
<h3 id="3-10-矩阵与线性代数运算"><a href="#3-10-矩阵与线性代数运算" class="headerlink" title="3.10 矩阵与线性代数运算"></a>3.10 矩阵与线性代数运算</h3><p>执行矩阵和线性代数运算，比如矩阵乘法、寻找行列式、求解线性方程组等等。</p>
<p>使用NumPy 库有一个矩阵对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">m = np.matrix([[<span class="number">1</span>,-<span class="number">2</span>,<span class="number">3</span>],[<span class="number">0</span>,<span class="number">4</span>,<span class="number">5</span>],[<span class="number">7</span>,<span class="number">8</span>,-<span class="number">9</span>]])</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># [[ 1 -2  3]</span></span><br><span class="line"> <span class="comment"># [ 0  4  5]</span></span><br><span class="line"> <span class="comment"># [ 7  8 -9]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m.T)</span><br><span class="line"><span class="comment"># [[ 1  0  7]</span></span><br><span class="line"><span class="comment">#  [-2  4  8]</span></span><br><span class="line"><span class="comment">#  [ 3  5 -9]]</span></span><br></pre></td></tr></table></figure>



<h3 id="3-11-随机选择"><a href="#3-11-随机选择" class="headerlink" title="3.11 随机选择"></a>3.11 随机选择</h3><p>random 模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">x = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>]</span><br><span class="line"><span class="comment"># 选样本</span></span><br><span class="line"><span class="built_in">print</span>(random.sample(x,<span class="number">2</span>)) <span class="comment"># [&#x27;e&#x27;, &#x27;a&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取 N 位随机位 (二进制) 的整数</span></span><br><span class="line"><span class="built_in">print</span>(random.getrandbits(<span class="number">200</span>))</span><br><span class="line"><span class="comment"># 1600357600159928260096229373737394765980934110472789307213699</span></span><br></pre></td></tr></table></figure>

<p>random 模块还包含基于均匀分布、高斯分布和其他分布的随机数生成函数。</p>
<ul>
<li>random.uniform() 计算均匀分布随机数</li>
<li>random.gauss() 计算正态分布随机数。</li>
</ul>
<h3 id="3-12-基本的日期与时间转换"><a href="#3-12-基本的日期与时间转换" class="headerlink" title="3.12 基本的日期与时间转换"></a>3.12 基本的日期与时间转换</h3><p>执行不同时间单位的转换和计算，请使用 datetime 模块</p>
<ul>
<li>timedelta 实例 : 表示一个时间段</li>
<li> datetime 实例 : 表示指定的日期和时间</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta,datetime</span><br><span class="line"></span><br><span class="line">a = timedelta(days=<span class="number">2</span>,hours=<span class="number">6</span>)</span><br><span class="line">b = timedelta(hours=<span class="number">.5</span>)</span><br><span class="line">c = a + b</span><br><span class="line"><span class="built_in">print</span>(c)  <span class="comment"># 2 days, 6:30:00</span></span><br><span class="line"><span class="built_in">print</span>(c.days,c.seconds) <span class="comment"># 2 23400</span></span><br><span class="line"></span><br><span class="line">d = datetime(<span class="number">2012</span>, <span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(d+a) <span class="comment"># 2012-03-03 06:00:00</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>datetime会自动处理闰年</p>
</blockquote>
<h3 id="3-13-计算最后一个周五的日期"><a href="#3-13-计算最后一个周五的日期" class="headerlink" title="3.13 计算最后一个周五的日期"></a>3.13 计算最后一个周五的日期</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">weekdays = [<span class="string">&#x27;Monday&#x27;</span>, <span class="string">&#x27;Tuesday&#x27;</span>, <span class="string">&#x27;Wednesday&#x27;</span>, <span class="string">&#x27;Thursday&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Friday&#x27;</span>, <span class="string">&#x27;Saturday&#x27;</span>, <span class="string">&#x27;Sunday&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_previous_byday</span>(<span class="params">dayname, start_date=<span class="literal">None</span></span>):</span></span><br><span class="line">	<span class="keyword">if</span> start_date <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">		start_date = datetime.today()</span><br><span class="line">	day_num = start_date.weekday()</span><br><span class="line">	day_num_target = weekdays.index(dayname)</span><br><span class="line">	<span class="comment"># 通过模运算计算出目标日期要经过多少天才能到达开始日期。</span></span><br><span class="line">	days_ago = (<span class="number">7</span> + day_num - day_num_target) % <span class="number">7</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> days_ago == <span class="number">0</span>:</span><br><span class="line">		days_ago = <span class="number">7</span></span><br><span class="line">	target_date = start_date - timedelta(days=days_ago)</span><br><span class="line">	<span class="keyword">return</span> target_date</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(datetime.today())              <span class="comment"># 2019-07-27 10:11:52.155536</span></span><br><span class="line"><span class="built_in">print</span>(get_previous_byday(<span class="string">&#x27;Monday&#x27;</span>))  <span class="comment"># 2019-07-22 10:11:52.155536</span></span><br><span class="line"><span class="built_in">print</span>(get_previous_byday(<span class="string">&#x27;Tuesday&#x27;</span>)) <span class="comment"># 2019-07-23 10:11:52.155536</span></span><br></pre></td></tr></table></figure>

<p>当然,也有第三方包 python-dateutil。</p>
<h3 id="3-14-计算当前月份的日期范围"><a href="#3-14-计算当前月份的日期范围" class="headerlink" title="3.14 计算当前月份的日期范围"></a>3.14 计算当前月份的日期范围</h3><p>在这样的日期上循环并需要事先构造一个包含所有日期的列表。你可以先计算出开始日期和结束日期，然后在你步进的时候使用 datetime.timedelta 对象递增这个日期变量即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> calendar</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, date, timedelta</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_month_range</span>(<span class="params">start_date=<span class="literal">None</span></span>):</span></span><br><span class="line">	<span class="keyword">if</span> start_date <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">		start_date = date.today().replace(day=<span class="number">1</span>)</span><br><span class="line">	_, days_in_month = calendar.monthrange(start_date.year, start_date.month)</span><br><span class="line">	end_date = start_date + timedelta(days=days_in_month)</span><br><span class="line">	<span class="keyword">return</span> (start_date, end_date)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a_day = timedelta(days=<span class="number">1</span>)</span><br><span class="line">first_day, last_day = get_month_range()</span><br><span class="line"><span class="keyword">while</span> first_day &lt; last_day:</span><br><span class="line">	<span class="built_in">print</span>(first_day)</span><br><span class="line">	first_day += a_day</span><br><span class="line"><span class="comment"># 2019-07-01</span></span><br><span class="line"><span class="comment"># 2019-07-02</span></span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line"><span class="comment"># 2019-07-30</span></span><br><span class="line"><span class="comment"># 2019-07-31</span></span><br></pre></td></tr></table></figure>



<h3 id="3-15-字符串与日期互转"><a href="#3-15-字符串与日期互转" class="headerlink" title="3.15 字符串与日期互转"></a>3.15 字符串与日期互转</h3><blockquote>
<ul>
<li>strptime() ：按照特定时间格式将字符串转换（解析）为时间类型<br><code>p ==&gt; parse</code></li>
<li>strftim() ：将时间格式化<br><code>f ==&gt; format</code></li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;2012-09-20&#x27;</span></span><br><span class="line">y = datetime.strptime(text,<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">z = datetime.now()</span><br><span class="line"></span><br><span class="line">diff = z- y</span><br><span class="line"><span class="built_in">print</span>(diff) <span class="comment"># 2501 days, 10:25:45.608327</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(datetime.strftime(z,<span class="string">&#x27;%Y-%m-%d&#x27;</span>)) <span class="comment"># 2019-07-27</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p>strptime() 的性能要比你想象中的差很多，因为它是使用纯 Python 实现，并且必须处理所有的系统本地设置。</p>
</li>
<li><p>如果你要在代码中需要解析大量的日期并且已经知道了日期字符串的确切格式，可以自己实现一套解析方案来获取更好的性能。</p>
</li>
<li><p>比如，如果你已经知道所以日期格式是 YYYY-MM-DD ，你可以像下面这样实现一个解析函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_ymd</span>(<span class="params">s</span>):</span></span><br><span class="line">	year_s, mon_s, day_s = s.split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">	<span class="keyword">return</span> datetime(<span class="built_in">int</span>(year_s), <span class="built_in">int</span>(mon_s), <span class="built_in">int</span>(day_s))</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<h3 id="3-16-结合时区的日期操作"><a href="#3-16-结合时区的日期操作" class="headerlink" title="3.16 结合时区的日期操作"></a>3.16 结合时区的日期操作</h3><p>对几乎所有涉及到时区的问题，应该使用 <strong>pytz 模块</strong>。</p>
<blockquote>
<ul>
<li>pytz 模块一个主要用途是<strong>将 datetime 库创建的简单日期对象本地化</strong>。</li>
<li>一旦日期被本地化了，它就可以转换为其他时区的时间了。</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> pytz <span class="keyword">import</span> timezone</span><br><span class="line"></span><br><span class="line">d = datetime(<span class="number">2012</span>, <span class="number">12</span>, <span class="number">21</span>, <span class="number">9</span>, <span class="number">30</span>, <span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment"># 2012-12-21 09:30:00</span></span><br><span class="line"></span><br><span class="line">central = timezone(<span class="string">&#x27;US/Central&#x27;</span>)</span><br><span class="line">loc_d = central.localize(d)</span><br><span class="line"><span class="built_in">print</span>(loc_d)</span><br><span class="line"><span class="comment"># 2012-12-21 09:30:00-06:00</span></span><br><span class="line"></span><br><span class="line">bang_d = loc_d.astimezone(timezone(<span class="string">&#x27;Asia/Kolkata&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(bang_d) </span><br><span class="line"><span class="comment"># 2012-12-21 21:00:00+05:30</span></span><br></pre></td></tr></table></figure>





</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>