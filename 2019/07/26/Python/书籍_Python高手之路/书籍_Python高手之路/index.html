<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;第一章-项目开始&quot;&gt;&lt;a href=&quot;#第一章-项目开始&quot; class=&quot;headerlink&quot; title=&quot;第一章 项目开始&quot;&gt;&lt;/a&gt;第一章 项目开始&lt;/h2&gt;&lt;h3 id=&quot;项目结构&quot;&gt;&lt;a href=&quot;#项目结构&quot; class=&quot;headerlink&quot; title=&quot;项目结构&quot;&gt;&lt;/a&gt;项目结构&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/untitled.png&quot; alt=&quot;untitled&quot;&gt;"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>书籍_Python高手之路 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Python/" rel="tag">Python</a></div><div class="post-time">2019-07-26</div></div></div><div class="container post-header"><h1>书籍_Python高手之路</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%A7%8B"><span class="toc-number">1.</span> <span class="toc-text">第一章 项目开始</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">项目结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PEP"><span class="toc-number">1.2.</span> <span class="toc-text">PEP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.</span> <span class="toc-text">第二章 模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%BA%93"><span class="toc-number">2.1.</span> <span class="toc-text">标准库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86API%E5%8F%98%E5%8C%96"><span class="toc-number">2.2.</span> <span class="toc-text">管理API变化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E6%96%87%E6%A1%A3"><span class="toc-number">3.</span> <span class="toc-text">第三章 文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E5%88%86%E5%8F%91"><span class="toc-number">4.</span> <span class="toc-text">第四章 分发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#setup-py"><span class="toc-number">4.1.</span> <span class="toc-text">setup.py</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83"><span class="toc-number">5.</span> <span class="toc-text">第五章 虚拟环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="toc-number">6.</span> <span class="toc-text">第六章 单元测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%EF%BC%88mocking%EF%BC%89"><span class="toc-number">6.1.</span> <span class="toc-text">模拟（mocking）</span></a></li></ol></li></ol></details></div><div class="container post-content"><h2 id="第一章-项目开始"><a href="#第一章-项目开始" class="headerlink" title="第一章 项目开始"></a>第一章 项目开始</h2><h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p><img src="/images/untitled.png" alt="untitled"></p>
<ul>
<li><code>setup.py</code>是Python安装脚本的标准名称。在安装时，它会通过Python分发工具（distuils）进行包的安装。也可以通过<code>README.rst</code>（或者<code>README.txt</code>，或者其他合适的名字）为用户提供重要信息。</li>
<li><code>requirements.txt</code>应该包含Python包所需要的依赖包，也就是说，所有这些包都会预先通过<code>pip</code>这样的工具进行安装以保证你的包能正常工作。</li>
<li><code>test-requirements.txt</code>，它应该列出运行测试集所需要的依赖包。</li>
<li><code>docs</code>文件夹应该包括reStructuredText格式的文档，以便能够被Sphinx处理</li>
<li><code>etc</code>用来存放配置文件的样例。</li>
<li><code>tools</code>用来存放与工具有关的shell脚本。</li>
<li><code>bin</code>用来存放将被<code>setup.py</code>安装的二进制脚本。</li>
<li><code>data</code>用来存放其他类型的文件，如媒体文件。</li>
</ul>
<h3 id="PEP"><a href="#PEP" class="headerlink" title="PEP"></a>PEP</h3><ul>
<li>每个缩进层级使用4个空格。</li>
<li>每行最多79个字符。</li>
<li><strong>顶层的函数或类的定义之间空两行</strong>。</li>
<li>采用ASCII或UTF-8编码文件。</li>
<li>在文件顶端，注释和文档说明之下，每行每条<code>import</code>语句只导入一个模块，同时要按<strong>标准库、第三方库和本地库</strong>的导入顺序进行分组。</li>
<li>在小括号、中括号、大括号之间或者逗号之前没有额外的空格。</li>
<li><strong>类的命名采用骆驼命名法</strong></li>
</ul>
<p>检测PEP8</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pycodestyle trainingfile1.py</span><br></pre></td></tr></table></figure>

<p>PEP8的错误</p>
<ul>
<li>以E2开头的错误通常与空格有关，</li>
<li>以E3开头的错误则与空行有关，</li>
<li>以W6开头的警告则表明使用了已废弃的功能。</li>
</ul>
<h2 id="第二章-模块"><a href="#第二章-模块" class="headerlink" title="第二章 模块"></a>第二章 模块</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sys.modules   <span class="comment"># 当前可导入模块</span></span><br><span class="line">sys.builtin_module_names   <span class="comment"># 查看所有的内建包</span></span><br><span class="line">sys.path  <span class="comment"># 包的路径列表</span></span><br><span class="line">sys.path_hooks   <span class="comment"># 添加自定义的模块查找器（finder）。</span></span><br></pre></td></tr></table></figure>

<h3 id="标准库"><a href="#标准库" class="headerlink" title="标准库"></a>标准库</h3><ul>
<li>atexit允许注册在程序退出时调用的函数。</li>
<li>argparse提供解析命令行参数的函数。</li>
<li>bisect为可排序列表提供二分查找算法。</li>
<li>calendar提供一组与日期相关的函数。</li>
<li>codecs提供编解码数据的函数。</li>
<li>collections提供一组有用的数据结构。</li>
<li>copy提供复制数据的函数。</li>
<li>csv提供用于读写CSV文件的函数。</li>
<li>datetime提供用于处理日期和时间的类。</li>
<li>fnmatch提供用于匹配Unix风格文件名模式的函数。</li>
<li>glob提供用于匹配Unix风格路径模式的函数。</li>
<li>io提供用于处理I/O流的函数。在Python3中，它还包含StringIO（在Python 2中有同名的模块），可以像处理文件一样处理字符串。</li>
<li>json提供用来读写JSON格式数据的函数。</li>
<li>logging提供对Python内置的日志功能的访问。</li>
<li>multiprocessing可以在应用程序中运行多个子进程，而且提供API让这些子进程看上去像线程一样。</li>
<li>operator提供实现基本的Python运算符功能的函数，可以使用这些函数而不是自己写lambda表达式。</li>
<li>os提供对基本的操作系统函数的访问。</li>
<li>random提供生成伪随机数的函数。</li>
<li>re提供正则表达式功能。</li>
<li>select提供对函数*select()<em>和</em>poll()*的访问，用于创建事件循环。</li>
<li>shutil提供对高级文件处理函数的访问。</li>
<li>signal提供用于处理POSIX信号的函数。</li>
<li>tempfile提供用于创建临时文件和目录的函数。</li>
<li>threading提供对处理高级线程功能的访问。</li>
<li>urllib（以及Python 2.x中的urllib2和urlparse）提供处理和解析URL的函数。</li>
<li>uuid可以生成全局唯一标识符（Universally Unique Identifiers，UUID）。</li>
</ul>
<h3 id="管理API变化"><a href="#管理API变化" class="headerlink" title="管理API变化"></a>管理API变化</h3><ul>
<li><p>公共API是指将应用程序或库暴露给终端用户的API。</p>
</li>
<li><p>内部API则有另外的考虑，并且由于它们在内部（也就是说<strong>用户不需要直接操作这些API</strong>），因而可以任意处理它们：分解、调整或者根据需要任意使用。</p>
<blockquote>
<p>两种API很容易区分。</p>
<p>用下划线作为私有API的前缀，如<code>foo</code>是公共API，而<code>_bar</code>是私有的。</p>
</blockquote>
</li>
</ul>
<h2 id="第三章-文档"><a href="#第三章-文档" class="headerlink" title="第三章 文档"></a>第三章 文档</h2><p>项目的文档应该包括下列内容。</p>
<ul>
<li>用一两句话描述这个项目要解决的问题。</li>
<li>项目所基于的分发许可。如果是开源软件的话，应该在每一个代码文件中包含相应信息。因为上传代码到互联网并不意味着人们知道他们可以对代码做什么。</li>
<li>一个展示项目如何工作的小例子。</li>
<li>安装指南。</li>
<li>指向社区支持、邮件列表、IRC、论坛等的链接。</li>
<li>指向bug跟踪系统的链接。</li>
<li>指向源代码的链接，以便开发人员可以下载并立刻投入开发。</li>
</ul>
<h2 id="第四章-分发"><a href="#第四章-分发" class="headerlink" title="第四章 分发"></a>第四章 分发</h2><h3 id="setup-py"><a href="#setup-py" class="headerlink" title="setup.py"></a>setup.py</h3><p>setup.py是一个python文件，它通常告诉你，你要安装的模块/包已经与Distutils一起打包和分发，这是分发Python模块的标准。</p>
<p>这允许你轻松地安装Python包，通常足够写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>



<ul>
<li><p>Python库是指那些被开发并且为了其他人来使用而发布的东西。</p>
</li>
<li><p>为了更好的推广和传播 自己，Python库会包含很多的信息，比如它的名字，版本号，依赖等等。</p>
</li>
<li><p> <code>setup.py</code> 就是用来提供这些信息的:</p>
</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> setup</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    name=<span class="string">&quot;MyLibrary&quot;</span>,</span><br><span class="line">    version=<span class="string">&quot;1.0&quot;</span>,</span><br><span class="line">    install_requires=[</span><br><span class="line">        <span class="string">&quot;requests&quot;</span>,</span><br><span class="line">        <span class="string">&quot;bcrypt&quot;</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>setup.py</code> 文件中的常用项:</p>
<ul>
<li><code>name</code>: 包名称, 也就是能够通过 <code>import name</code> 被导入的名字</li>
<li><code>packages</code>: 你要安装的包的路径, 例如: <code>[&quot;canbeAny&quot;, &quot;canbeAny.packages&quot;]</code></li>
<li><code>version</code>: 版本号, 通常在 <code>name.__init__.py</code> 中以 <code>__version__ = &quot;0.0.1&quot;</code> 的形式被定义</li>
<li><code>description</code>: PyPI首页的一句话短描述</li>
<li><code>long_description</code>: PyPI首页的正文</li>
<li><code>url</code>: 你的项目主页, 通常是项目的Github主页</li>
<li><code>download_url</code>: 你项目源码的下载链接</li>
<li><code>license</code>: 版权协议名</li>
</ul>
<h2 id="第五章-虚拟环境"><a href="#第五章-虚拟环境" class="headerlink" title="第五章 虚拟环境"></a>第五章 虚拟环境</h2><p>退出虚拟环境:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deactivate</span><br></pre></td></tr></table></figure>



<h2 id="第六章-单元测试"><a href="#第六章-单元测试" class="headerlink" title="第六章 单元测试"></a>第六章 单元测试</h2><p>nose包提供nosetests命令，该命令会加载所有以<code>test_</code>开头的文件，然后执行其中所有以<code>test_</code>开头的函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tests/test_key.py</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestKey</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_key</span>(<span class="params">self</span>):</span></span><br><span class="line">         a = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]</span><br><span class="line">         b = [<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line">         self.assertEqual(a, b)</span><br></pre></td></tr></table></figure>

<p>进行单测:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nosetests -v</span><br></pre></td></tr></table></figure>



<p>写单测的时候,<strong>永远</strong>不应该使用<code>assert</code><br>unittest提供了一组测试函数，可以用来特化测试，如<code>assertDictEqual</code>、<code>ass-ertEqual</code>、<code>assertTrue</code>、<code>assertFalse</code>、<code>assertGreater</code>、  <code>assertGreaterEqual</code>、<code>assertIn</code>、<code>assertIs</code>、<code>assertIsIntance</code>、<code>assertIsNon</code>、  <code>assertualIsNot</code>、<code>as-sertIsNotNone</code>、<code>assertItemsEqual</code>、<code>assertLess</code>、<code>assertLessEqual</code>、  <code>asse-rtListEqual</code>、<code>assertMultiLineEqual</code>、<code>assertNotAlmostEqual</code>、<code>assertNot-Equal</code>、  <code>assertTupleEqual</code>、<code>assertRaises</code>、<code>assertRaisesRegexp</code>、<code>assertReg-expMatches</code></p>
<p>使用<code>fail(msg)</code>方法有意让某个测试立刻失败</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestFail</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_range</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            <span class="keyword">if</span> x &gt; <span class="number">4</span>:</span><br><span class="line">                self.fail(<span class="string">&quot;Range returned a too big value: %d&quot;</span> % x)</span><br></pre></td></tr></table></figure>



<p>在运行某个测试前后执行一组通用的操作。<code>unittest</code>提供了两个特殊的方法setUp和tearDown，它们会<strong>在类的每个测试方法调用前后执行一次</strong></p>
<h3 id="模拟（mocking）"><a href="#模拟（mocking）" class="headerlink" title="模拟（mocking）"></a>模拟（mocking）</h3><ul>
<li>mock对象即模拟对象，用来通过某种特殊和可控的方式模拟真实应用程序对象的行为。</li>
<li>在创建精确地描述测试代码的状态的环境时，它们非常有用。</li>
</ul>
</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>