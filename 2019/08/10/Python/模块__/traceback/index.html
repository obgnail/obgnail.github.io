<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Python的traceback模块用于从程序运行的堆栈中提取，格式化或打印程序目前执行的上下文信息。"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>traceback | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Python/" rel="tag">Python</a></div><div class="post-time">2019-08-10</div></div></div><div class="container post-header"><h1>traceback</h1></div><div class="container post-content"><p>Python的traceback模块用于从程序运行的堆栈中提取，格式化或打印程序目前执行的上下文信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span> // <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">	main()</span><br><span class="line"><span class="keyword">except</span> ZeroDivisionError <span class="keyword">as</span> e:</span><br><span class="line">	traceback.print_exc()</span><br><span class="line"><span class="comment"># Traceback (most recent call last):</span></span><br><span class="line"><span class="comment">#   File &quot;D:\trainingfile\training5.py&quot;, line 7, in &lt;module&gt;</span></span><br><span class="line"><span class="comment">#     main()</span></span><br><span class="line"><span class="comment">#   File &quot;D:\trainingfile\training5.py&quot;, line 4, in main</span></span><br><span class="line"><span class="comment">#     return 2 // 0</span></span><br><span class="line"><span class="comment"># ZeroDivisionError: integer division or modulo by zero</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><code>traceback.print_exc()</code>函数只是<code>traceback.print_exception()</code>函数的一个简写形式，</li>
<li>它们获取异常相关的数据都是通过sys.exc_info()函数得到的。</li>
</ul>
</blockquote>
<p>traceback.print_exc()跟traceback.format_exc()有什么区别</p>
<ul>
<li><p>format_exc()返回字符串，print_exc()则直接给打印出来。</p>
</li>
<li><p>即traceback.print_exc()与print traceback.format_exc()效果是一样的。</p>
</li>
<li><p>print_exc()还可以接受file参数直接写入到一个文件。</p>
</li>
<li><p>比如写入到tb.txt文件去。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traceback.print_exc(file=<span class="built_in">open</span>(<span class="string">&#x27;tb.txt&#x27;</span>,<span class="string">&#x27;w+&#x27;</span>))</span><br></pre></td></tr></table></figure></li>
</ul>
<p>traceback.print_exc() 方法打印出的信息包括3 部分：</p>
<ul>
<li><p>错误类型（IndexError）</p>
</li>
<li><p>错误对应的值（list index out of range）</p>
</li>
<li><p>具体的 trace 信息，包括文件名、具体的行号、函数名以及 对应的源代码。</p>
</li>
</ul>
<p>Traceback 模块提供了一系列方法来获取和显示异常发生时候的trace 相关信息，下面列举几个常用的方法：</p>
<ol>
<li><code>traceback.print_exception(type, value, traceback[, limit[, ﬁle]])</code>，<br>根据limit 的设置打印栈信息，ﬁle 为 None 的情况下定位到sys.stderr，否则则写入文件；其中type、value、 traceback 这 3 个参数对应的值可以从 sys.exc_info() 中获取。 </li>
<li><code>raceback.print_exc([limit[, ﬁle]])</code>，<br>为print_exception() 函数的缩写，不需要传入type、 value、traceback 这 3 个参数。 </li>
<li><code>traceback.format_exc([limit])</code>，与 print_exc() 类似，区别在于返回形式为字符串。 </li>
<li><code>traceback.extract_stack([ﬁle,[, limit]])</code>，从当前栈帧中提取 trace 信息</li>
</ol>
</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>