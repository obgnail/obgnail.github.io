<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;登录准备&quot;&gt;&lt;a href=&quot;#登录准备&quot; class=&quot;headerlink&quot; title=&quot;登录准备&quot;&gt;&lt;/a&gt;登录准备&lt;/h3&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# -h表示主机,-u表示用户名,-p表示密码&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -hlocalhost -uroot -p5KVp2y7,k96o&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;describe acglist;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h3 id=&quot;检索数据&quot;&gt;&lt;a href=&quot;#检索数据&quot; class=&quot;headerlink&quot; title=&quot;检索数据&quot;&gt;&lt;/a&gt;检索数据&lt;/h3&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# 查找唯一值&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;select DISTINCT col from table2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 检索从第5行(不含)开始的6行(就是6-11行)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;select name from new_list limit 5, 6;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h3 id=&quot;排序&quot;&gt;&lt;a href=&quot;#排序&quot; class=&quot;headerlink&quot; title=&quot;排序&quot;&gt;&lt;/a&gt;排序&lt;/h3&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# 首要关键字是page,次要关键字是tags,再次关键字是id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;select id,languages from commic_list order by page,tags,id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 两个关键字, from_date升序,emp_no为降序&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 注意要有逗号&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;select * from titles order by emp_no DESC ,from_date limit 5;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;使用ORDER BY和LIMIT的组合，能够找出一个列中最高或最低的值。 eg:找出最昂贵物品的值"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>总结 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/MySQL/" rel="tag">MySQL</a></div><div class="post-time">2019-08-08</div></div></div><div class="container post-header"><h1>总结</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E5%87%86%E5%A4%87"><span class="toc-number">1.</span> <span class="toc-text">登录准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E6%95%B0%E6%8D%AE"><span class="toc-number">2.</span> <span class="toc-text">检索数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">3.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#where%E8%BF%87%E6%BB%A4"><span class="toc-number">4.1.</span> <span class="toc-text">where过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%80%9A%E9%85%8D%E7%AC%A6%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4"><span class="toc-number">4.2.</span> <span class="toc-text">使用通配符进行过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4"><span class="toc-number">4.3.</span> <span class="toc-text">使用正则表达式进行过滤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="toc-number">5.</span> <span class="toc-text">计算字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">使用函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%87%E6%80%BB%E6%95%B0%E6%8D%AE"><span class="toc-number">7.</span> <span class="toc-text">汇总数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E6%95%B0%E6%8D%AE"><span class="toc-number">8.</span> <span class="toc-text">分组数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%88%86%E7%BB%84-HAVING%E5%AD%90%E5%8F%A5"><span class="toc-number">8.1.</span> <span class="toc-text">过滤分组:HAVING子句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-SELECT%E5%AD%90%E5%8F%A5%E9%A1%BA%E5%BA%8F"><span class="toc-number">9.</span> <span class="toc-text">总结 SELECT子句顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">10.</span> <span class="toc-text">子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E7%BB%93%E8%A1%A8"><span class="toc-number">11.</span> <span class="toc-text">联结表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E8%81%94%E7%BB%93"><span class="toc-number">12.</span> <span class="toc-text">高级联结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">13.</span> <span class="toc-text">组合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="toc-number">14.</span> <span class="toc-text">全文本搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">15.</span> <span class="toc-text">插入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">16.</span> <span class="toc-text">更新和删除数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E6%93%8D%E7%BA%B5%E8%A1%A8"><span class="toc-number">17.</span> <span class="toc-text">创建和操纵表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">18.</span> <span class="toc-text">视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">19.</span> <span class="toc-text">存储过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87"><span class="toc-number">20.</span> <span class="toc-text">游标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">21.</span> <span class="toc-text">触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">22.</span> <span class="toc-text">事务</span></a></li></ol></details></div><div class="container post-content"><h3 id="登录准备"><a href="#登录准备" class="headerlink" title="登录准备"></a>登录准备</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># -h表示主机,-u表示用户名,-p表示密码</span><br><span class="line">mysql -hlocalhost -uroot -p5KVp2y7,k96o</span><br><span class="line"></span><br><span class="line">describe acglist;</span><br></pre></td></tr></table></figure>



<h3 id="检索数据"><a href="#检索数据" class="headerlink" title="检索数据"></a>检索数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 查找唯一值</span><br><span class="line">select DISTINCT col from table2</span><br><span class="line"></span><br><span class="line"># 检索从第5行(不含)开始的6行(就是6-11行)</span><br><span class="line">select name from new_list limit 5, 6;</span><br></pre></td></tr></table></figure>



<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 首要关键字是page,次要关键字是tags,再次关键字是id</span><br><span class="line">select id,languages from commic_list order by page,tags,id</span><br><span class="line"></span><br><span class="line"># 两个关键字, from_date升序,emp_no为降序</span><br><span class="line"># 注意要有逗号</span><br><span class="line">select * from titles order by emp_no DESC ,from_date limit 5;</span><br></pre></td></tr></table></figure>

<p>使用ORDER BY和LIMIT的组合，能够找出一个列中最高或最低的值。 eg:找出最昂贵物品的值</p>
<h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h3><h4 id="where过滤"><a href="#where过滤" class="headerlink" title="where过滤"></a>where过滤</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 注意要加引号,一个等号(不是两个等号)</span><br><span class="line">select * from titles where title=&#x27;Staff&#x27; limit 5;</span><br><span class="line">select * from titles where Date(to_date) = &quot;9999-01-01&quot; limit 5;</span><br><span class="line"></span><br><span class="line"># 空值检查使用is null</span><br><span class="line">select id from commic_list where artists is null</span><br><span class="line"></span><br><span class="line"># 使用序列的in</span><br><span class="line">select id,page from commic_list where languages in (&#x27;english&#x27;,&#x27;japanese&#x27;);</span><br></pre></td></tr></table></figure>

<h4 id="使用通配符进行过滤"><a href="#使用通配符进行过滤" class="headerlink" title="使用通配符进行过滤"></a>使用通配符进行过滤</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># _替代一个字符</span><br><span class="line">select * from titles where emp_no like &quot;_000_&quot;;</span><br></pre></td></tr></table></figure>

<h4 id="使用正则表达式进行过滤"><a href="#使用正则表达式进行过滤" class="headerlink" title="使用正则表达式进行过滤"></a>使用正则表达式进行过滤</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查找所有以(开头的记录</span><br><span class="line">select id,title from commic_list where title regexp &quot;^\\(&quot;;</span><br></pre></td></tr></table></figure>



<h3 id="计算字段"><a href="#计算字段" class="headerlink" title="计算字段"></a>计算字段</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select concat(emp_no,&quot;-&quot;,title) as new_col from titles limit 5;</span><br></pre></td></tr></table></figure>



<h3 id="使用函数"><a href="#使用函数" class="headerlink" title="使用函数"></a>使用函数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 截取前面5个字符</span><br><span class="line">select left(title,5) as new_col from titles limit 5;</span><br></pre></td></tr></table></figure>



<h3 id="汇总数据"><a href="#汇总数据" class="headerlink" title="汇总数据"></a>汇总数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 获取行数</span><br><span class="line">select count(emp_no) from titles where title is not null;</span><br><span class="line"></span><br><span class="line">select avg(distinct salary) as avg_salary from salaries ;</span><br></pre></td></tr></table></figure>



<h3 id="分组数据"><a href="#分组数据" class="headerlink" title="分组数据"></a>分组数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select emp_no ,avg(salary) as avg_salary from salaries group by emp_no limit 5;</span><br></pre></td></tr></table></figure>

<ul>
<li>如果在SELECT中使用表达式，则必须在 GROUP BY子句中指定相同的表达式</li>
<li>除聚集计算语句外，SELECT语句中的每个列都必须在GROUP BY子句中给出</li>
</ul>
<h4 id="过滤分组-HAVING子句"><a href="#过滤分组-HAVING子句" class="headerlink" title="过滤分组:HAVING子句"></a>过滤分组:HAVING子句</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> select emp_no , avg(distinct salary) <span class="keyword">from</span> salaries group by emp_no having emp_no &gt; <span class="number">10088</span> limit <span class="number">5</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 查找作品的语言是英语,同时总页数大于60的作者</span></span><br><span class="line"><span class="comment"># 然后按照总页数升序排列</span></span><br><span class="line">select artists,languages,<span class="built_in">sum</span>(page) </span><br><span class="line">    <span class="keyword">from</span> commic_list </span><br><span class="line">    where languages = <span class="string">&#x27;english&#x27;</span> </span><br><span class="line">    group by artists </span><br><span class="line">    having <span class="built_in">sum</span>(page) &gt; <span class="number">60</span> </span><br><span class="line">    order by <span class="built_in">sum</span>(page);</span><br></pre></td></tr></table></figure>



<h3 id="总结-SELECT子句顺序"><a href="#总结-SELECT子句顺序" class="headerlink" title="总结 SELECT子句顺序"></a>总结 SELECT子句顺序</h3><table>
<thead>
<tr>
<th>子句</th>
<th>说明</th>
<th>是否必须使用</th>
</tr>
</thead>
<tbody><tr>
<td>select</td>
<td>要返回的列或表达式</td>
<td>是</td>
</tr>
<tr>
<td>from</td>
<td>从中检索数据的表</td>
<td>仅在表中选择数据时使用</td>
</tr>
<tr>
<td>where</td>
<td>行级过滤</td>
<td>否</td>
</tr>
<tr>
<td>group by</td>
<td>分组说明</td>
<td>仅在按组计算聚集时使用</td>
</tr>
<tr>
<td>having</td>
<td>组级过滤</td>
<td>否</td>
</tr>
<tr>
<td>order by</td>
<td>输出排序顺序</td>
<td>否</td>
</tr>
<tr>
<td>limit</td>
<td>要检索的行数</td>
<td>否</td>
</tr>
</tbody></table>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p>外查询where的内容其实就是内查询select的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select dept_no from departments where dept_no in </span><br><span class="line">	(select dept_no from dept_emp </span><br><span class="line">     	where Date(to_date)=&quot;9999-01-01&quot;)</span><br><span class="line">limit 5;</span><br><span class="line"></span><br><span class="line">select count(dept_no) from departments where dept_no in </span><br><span class="line">	(select dept_no from dept_emp </span><br><span class="line">     	where Date(to_date)=&quot;9999-01-01&quot;) ;</span><br></pre></td></tr></table></figure>



<h3 id="联结表"><a href="#联结表" class="headerlink" title="联结表"></a>联结表</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select d1.dept_no,d1.dept_name,d2.from_date </span><br><span class="line">	<span class="keyword">from</span> departments <span class="keyword">as</span> d1 left join dept_emp <span class="keyword">as</span> d2 </span><br><span class="line">	on d1.dept_no=d2.dept_no</span><br><span class="line">    limit <span class="number">5</span>;</span><br></pre></td></tr></table></figure>



<h3 id="高级联结"><a href="#高级联结" class="headerlink" title="高级联结"></a>高级联结</h3><p>自联结、自然联结和外部联结。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select name from table1 where</span><br><span class="line">	(select price from table1 where name = &#x27;惠惠&#x27;)</span><br><span class="line"></span><br><span class="line"># 将上面的代码改为</span><br><span class="line">select t1.name from table1 t1 , table1 t2 where t1.name = &#x27;惠惠&#x27; and t1.price &lt; t2.price</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 查找页数比id为258126这本书 还有多的书的id</span><br><span class="line">select t2.id,t2.page from commic_list t1,commic_list t2 </span><br><span class="line">	where t1.id=258126 and t1.page &lt; t2.page</span><br></pre></td></tr></table></figure>



<h3 id="组合查询"><a href="#组合查询" class="headerlink" title="组合查询"></a>组合查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select dept_no from departments where dept_name = &quot;Finance&quot;  </span><br><span class="line">union </span><br><span class="line">select dept_no from dept_emp where to_date = &quot;9999-01-01&quot;;</span><br></pre></td></tr></table></figure>

<p>UNION中的每个查询必须包含相同的列、表达式或聚集函数（不过各个列不需要以相同的次序列出）</p>
<h3 id="全文本搜索"><a href="#全文本搜索" class="headerlink" title="全文本搜索"></a>全文本搜索</h3><p><code>fulltext(note_text)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 在定义表时使用fulltext</span><br><span class="line">creat table product_notes</span><br><span class="line">(</span><br><span class="line">	note_id    int       not null  auto_increment,</span><br><span class="line">	prod_id    char(10)  not null,</span><br><span class="line">	note_date  datetime  not null,</span><br><span class="line">	note_text  text      null,</span><br><span class="line">	primary key (note_id),</span><br><span class="line">	fulltext(note_text)</span><br><span class="line">) engine = MyISAM;</span><br><span class="line"># 在定义之后，MySQL自动维护note_text索引。在增加、更新或删除行时， 索引随之自动更新。 </span><br></pre></td></tr></table></figure>



<h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 各个列必须以它们在表定义中出现的次序填充。</span><br><span class="line">insert into less_table values (50219,&#x27;hyl&#x27;,&#x27;http:xxx.jpg&#x27;,&#x27;2019-04-08 14:35&#x27;,&#x27;hh&#x27;)</span><br><span class="line"></span><br><span class="line"># 在表名后的括号里明确地给出了列名</span><br><span class="line">insert into less_table(id,name,img,created_time,text) </span><br><span class="line">	values (50220,null,null,&#x27;2019-04-08 14:35&#x27;,&#x27;hh&#x27;)</span><br><span class="line">	</span><br><span class="line"># 省略列。这表示可以只给某些列提供值，给其他列不提供值。</span><br><span class="line">insert into less_table(id,text) values (50221,&#x27;hh&#x27;)</span><br><span class="line"></span><br><span class="line"># 一次性插入多条数据</span><br><span class="line">insert into less_table(id,text) values</span><br><span class="line">	(50221,&#x27;hh&#x27;),</span><br><span class="line">	(50222,&#x27;xx&#x27;),</span><br><span class="line">	(20223,&#x27;ww&#x27;);</span><br></pre></td></tr></table></figure>

<p>使用省略列需要注意:</p>
<ol>
<li>该列定义为允许NULL值（无值或空值）。 </li>
<li>在表定义中给出默认值。这表示如果不给出值，将使用默认值。 </li>
</ol>
<blockquote>
<p>将一条SELECT语句的结果插入表中。这就是所谓的INSERT SELECT</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 使用insert into从custnew表中的数据导入customers表</span><br><span class="line">insert into customers(cust_id,</span><br><span class="line">	cust_contact,</span><br><span class="line">	cust_email,</span><br><span class="line">	cust_name)</span><br><span class="line">select cust_id,</span><br><span class="line">	cust_contact,</span><br><span class="line">	cust_email,</span><br><span class="line">	cust_name</span><br><span class="line">from custnew</span><br><span class="line">where cust_id &gt; 10000;</span><br></pre></td></tr></table></figure>

<p>需要注意的是:<strong>insert select使用的并不是关键词参数,而是位置参数:</strong></p>
</blockquote>
<h3 id="更新和删除数据"><a href="#更新和删除数据" class="headerlink" title="更新和删除数据"></a>更新和删除数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 更新特定行</span><br><span class="line">update less_table set name = &#x27;hyl&#x27;,img = &#x27;http://xx.jpg&#x27; where id = 50221</span><br><span class="line"></span><br><span class="line">delete from less_table where id = 50221</span><br><span class="line"></span><br><span class="line"># 删除原来的表并重新创建一个表</span><br><span class="line">truncate less_table</span><br></pre></td></tr></table></figure>



<h3 id="创建和操纵表"><a href="#创建和操纵表" class="headerlink" title="创建和操纵表"></a>创建和操纵表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">creat table product_notes</span><br><span class="line">(</span><br><span class="line">	note_id    int       not null  auto_increment,</span><br><span class="line">	prod_id    char(10)  not null,</span><br><span class="line">	note_date  datetime  not null,</span><br><span class="line">	note_text  text      null,</span><br><span class="line">	primary key (note_id),</span><br><span class="line">	fulltext(note_text)</span><br><span class="line">) engine = InnoDB;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># if not exists</span><br><span class="line">creat table product_notes if not exists</span><br><span class="line">(</span><br><span class="line">	note_id    int       not null  auto_increment,</span><br><span class="line">	prod_id    char(10)  not null,</span><br><span class="line">	note_date  datetime  not null,</span><br><span class="line">	note_text  text      null      default &#x27;xxx&#x27;,</span><br><span class="line">	primary key (note_id),</span><br><span class="line">	fulltext(note_text)</span><br><span class="line">) engine = InnoDB;</span><br></pre></td></tr></table></figure>

<p>更改表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 添加新的字段</span><br><span class="line">alter table less_table add new_column char(20)</span><br><span class="line"># 删除字段</span><br><span class="line">alter table less_table drop column new_column</span><br><span class="line"></span><br><span class="line"># 定义外键</span><br><span class="line">alter table orderitems </span><br><span class="line">	add constraint fk_orderitems_orders</span><br><span class="line">	foreign key (order_num) references orders (order_num);</span><br></pre></td></tr></table></figure>

<p>删除表:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table less_table</span><br></pre></td></tr></table></figure>

<p>重命名表:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 重命名单个表</span><br><span class="line">rename table less_table to new_table</span><br><span class="line"># 重命名多个表</span><br><span class="line">rename table old_table1 to new_table1</span><br><span class="line">			old_table2 to new_table2</span><br><span class="line">			old_table3 to new_table3</span><br></pre></td></tr></table></figure>



<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p><strong>视图是虚拟的表</strong>。与包含数据的表不一样，视图只包含使用时动态检索数据的查询。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select cust_name,cust_contact</span><br><span class="line">from customers,orders,orderitems</span><br><span class="line">where customers.cust_id = orders.cust_id</span><br><span class="line">	and orderitems.order_num = orders.order_num</span><br><span class="line">	and prod_id = &#x27;TNT2&#x27;</span><br></pre></td></tr></table></figure>

<p>现在，假如可以把整个查询包装成一个名为product_customers的虚拟表，则可以如下轻松地检索出相同的数据： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select cust_name,cust_contact from product_custimers</span><br><span class="line">where prod_id = &#x27;TNT2&#x27;</span><br></pre></td></tr></table></figure>

<p>product_customers就是一个视图.<br>作为视图，本身并不包含数据。==它包含的是一个SQL查询==（与上面用以正确联结表的相同的查询）<br>为什么要使用视图？<br><strong>视图的常见的应用之一是隐藏复杂的SQL</strong>，这通常都会涉及联结。 </p>
<p>使用规则:</p>
<ol>
<li>视图用CREATE VIEW语句来创建。</li>
<li>使用SHOW CREATE VIEW viewname；来查看创建视图的语句。 </li>
<li>用DROP删除视图，其语法为DROP VIEW viewname;。 </li>
<li>更新视图时，可以先用DROP再用CREATE，也可以直接用CREATE OR REPLACE VIEW。如果要更新的视图不存在，则第2条更新语句会创建一个视图；如果要更新的视图存在，则第2条更新语句会替换原有视图</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 用视图重新格式化检索出的数据(就是创建了一个新的name列)</span><br><span class="line">create or replace view name2dept as </span><br><span class="line">select e.emp_no,concat(e.first_name,&#x27; &#x27;,e.last_name) as name,d1.dept_name</span><br><span class="line">	from employees e,departments d1,dept_emp d2 </span><br><span class="line">	where e.emp_no = d2.emp_no and d2.dept_no = d1.dept_no </span><br><span class="line">	order by e.emp_no </span><br><span class="line"></span><br><span class="line"># 复用视图</span><br><span class="line">select * from name2dept where emp_no &lt; 10005;</span><br><span class="line"></span><br><span class="line"># 使用视图来创建并且存储计算字段</span><br><span class="line">create view sumPrice as </span><br><span class="line">select item_prict*quantity as tot_price from orderitems</span><br></pre></td></tr></table></figure>



<h3 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h3><p>简单来说,存储过程就是数据库语言层面的<strong>代码封装与重用</strong>。<br>或者说存储过程就是一组可编程的<strong>函数</strong>，是为了完成特定功能的SQL语句集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 存储过程就是函数,所以product_pricing()后面的括号就是放参数的地方</span><br><span class="line"># begin和end中间就是函数体,不过这里称为&quot;存储过程体&quot;</span><br><span class="line">create procedure product_pricing()</span><br><span class="line">	begin</span><br><span class="line">	select avg(prod_price) as price_average from products;</span><br><span class="line">	end;</span><br></pre></td></tr></table></figure>



<h3 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h3><p>有时，需要在检索出来的行中前进或后退一行或多行,这时就可以使用游标了。</p>
<p>游标不是一条SELECT语句，而是<strong>被该语句检索出来的结果集</strong>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 定义名为ordernumbers的游标，使用了可以检索所有订单的SELECT语句</span><br><span class="line">create procedure processorders()</span><br><span class="line">begin</span><br><span class="line">	declare ordernumbers cursor</span><br><span class="line">	for</span><br><span class="line">	select order_num from orders</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>



<h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><p>触发器可在一个操作发生之前或之后执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 每次成功插入行，显示Product added消息。 </span><br><span class="line">create trigger newproduct after insert on products</span><br><span class="line">for each row select &#x27;Product added&#x27;;</span><br><span class="line"></span><br><span class="line"># 删除触发器</span><br><span class="line">drop trigger newproduct;</span><br></pre></td></tr></table></figure>



<h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><p>并非所有引擎都支持事务处理 :<br>MyISAM和InnoDB是两种最常使用的引擎。前者不支持明确的事务处理管理，而后者支持。</p>
<p><strong>事务处理保证操作的原子性</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select * from ordertotals;</span><br><span class="line"></span><br><span class="line">start transaction;</span><br><span class="line">delete from ordertotals;</span><br><span class="line">select * from ordertotals;</span><br><span class="line">rollback;</span><br><span class="line"></span><br><span class="line">select * from ordertotals;</span><br></pre></td></tr></table></figure>







</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>