<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="地址 : &lt;a href=&quot;https://zhuanlan.zhihu.com/p/43312668&quot;&gt;https://zhuanlan.zhihu.com/p/43312668&lt;/a&gt;"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>pandas常用示例 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Python/" rel="tag">Python</a></div><div class="post-time">2020-06-26</div></div></div><div class="container post-header"><h1>pandas常用示例</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">1.</span> <span class="toc-text">生成数据表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%BF%A1%E6%81%AF%E6%9F%A5%E7%9C%8B"><span class="toc-number">2.</span> <span class="toc-text">数据表信息查看</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%B8%85%E6%B4%97"><span class="toc-number">3.</span> <span class="toc-text">数据表清洗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">数据预处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96"><span class="toc-number">5.</span> <span class="toc-text">数据提取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%AD%9B%E9%80%89"><span class="toc-number">6.</span> <span class="toc-text">数据筛选</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B1%87%E6%80%BB"><span class="toc-number">7.</span> <span class="toc-text">数据汇总</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1"><span class="toc-number">8.</span> <span class="toc-text">数据统计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BE%93%E5%87%BA"><span class="toc-number">9.</span> <span class="toc-text">数据输出</span></a></li></ol></details></div><div class="container post-content"><p>地址 : <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/43312668">https://zhuanlan.zhihu.com/p/43312668</a></p>
<h2 id="生成数据表"><a href="#生成数据表" class="headerlink" title="生成数据表"></a>生成数据表</h2><p>1、首先导入pandas库，一般都会用到numpy库，所以我们先导入备用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br></pre></td></tr></table></figure>

<p>2、导入CSV或者xlsx文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(pd.read_csv(&#x27;name.csv&#x27;,header=1))</span><br><span class="line">df = pd.DataFrame(pd.read_excel(&#x27;name.xlsx&#x27;))</span><br></pre></td></tr></table></figure>

<p>3、用pandas创建数据表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;&quot;id&quot;:[1001,1002,1003,1004,1005,1006], </span><br><span class="line"> &quot;date&quot;:pd.date_range(&#x27;20130102&#x27;, periods=6),</span><br><span class="line">  &quot;city&quot;:[&#x27;Beijing &#x27;, &#x27;SH&#x27;, &#x27; guangzhou &#x27;, &#x27;Shenzhen&#x27;, &#x27;shanghai&#x27;, &#x27;BEIJING &#x27;],</span><br><span class="line"> &quot;age&quot;:[23,44,54,32,34,32],</span><br><span class="line"> &quot;category&quot;:[&#x27;100-A&#x27;,&#x27;100-B&#x27;,&#x27;110-A&#x27;,&#x27;110-C&#x27;,&#x27;210-A&#x27;,&#x27;130-F&#x27;],</span><br><span class="line">  &quot;price&quot;:[1200,np.nan,2133,5433,np.nan,4432]&#125;,</span><br><span class="line">  columns =[&#x27;id&#x27;,&#x27;date&#x27;,&#x27;city&#x27;,&#x27;category&#x27;,&#x27;age&#x27;,&#x27;price&#x27;])</span><br></pre></td></tr></table></figure>



<h2 id="数据表信息查看"><a href="#数据表信息查看" class="headerlink" title="数据表信息查看"></a>数据表信息查看</h2><p>1、维度查看：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure>

<p>2、数据表基本信息（维度、列名称、数据格式、所占空间等）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>

<p>3、每一列数据的格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>

<p>4、某一列格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;B&#x27;].dtype</span><br></pre></td></tr></table></figure>

<p>5、空值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isnull()</span><br></pre></td></tr></table></figure>

<p>6、查看某一列空值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isnull()</span><br></pre></td></tr></table></figure>

<p>7、查看某一列的唯一值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;B&#x27;].unique()</span><br></pre></td></tr></table></figure>

<p>8、查看数据表的值：<br>df.values<br>9、查看列名称：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns</span><br></pre></td></tr></table></figure>

<p>10、查看前10行数据、后10行数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.head() #默认前10行数据</span><br><span class="line">df.tail()    #默认后10 行数据</span><br></pre></td></tr></table></figure>



<h2 id="数据表清洗"><a href="#数据表清洗" class="headerlink" title="数据表清洗"></a>数据表清洗</h2><p>1、用数字0填充空值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.fillna(value=0)</span><br></pre></td></tr></table></figure>

<p>2、使用列prince的均值对NA进行填充：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;prince&#x27;].fillna(df[&#x27;prince&#x27;].mean())</span><br></pre></td></tr></table></figure>

<p>3、清楚city字段的字符空格：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;city&#x27;]=df[&#x27;city&#x27;].map(str.strip)</span><br></pre></td></tr></table></figure>

<p>4、大小写转换：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;city&#x27;]=df[&#x27;city&#x27;].str.lower()</span><br></pre></td></tr></table></figure>

<p>5、更改数据格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;price&#x27;].astype(&#x27;int&#x27;)</span><br></pre></td></tr></table></figure>

<p>6、更改列名称：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;&#x27;category&#x27;: &#x27;category-size&#x27;&#125;)</span><br></pre></td></tr></table></figure>

<p>7、删除后出现的重复值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;city&#x27;].drop_duplicates()</span><br></pre></td></tr></table></figure>

<p>8、删除先出现的重复值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;city&#x27;].drop_duplicates(keep=&#x27;last&#x27;)</span><br></pre></td></tr></table></figure>

<p>9、数据替换：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&#x27;city&#x27;].replace(&#x27;sh&#x27;, &#x27;shanghai&#x27;)</span><br></pre></td></tr></table></figure>



<h2 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df1=pd.DataFrame(&#123;&quot;id&quot;:[1001,1002,1003,1004,1005,1006,1007,1008], </span><br><span class="line">&quot;gender&quot;:[&#x27;male&#x27;,&#x27;female&#x27;,&#x27;male&#x27;,&#x27;female&#x27;,&#x27;male&#x27;,&#x27;female&#x27;,&#x27;male&#x27;,&#x27;female&#x27;],</span><br><span class="line">&quot;pay&quot;:[&#x27;Y&#x27;,&#x27;N&#x27;,&#x27;Y&#x27;,&#x27;Y&#x27;,&#x27;N&#x27;,&#x27;Y&#x27;,&#x27;N&#x27;,&#x27;Y&#x27;,],</span><br><span class="line">&quot;m-point&quot;:[10,12,20,40,40,40,30,20]&#125;)</span><br></pre></td></tr></table></figure>

<p>1、数据表合并</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_inner=pd.merge(df,df1,how=&#x27;inner&#x27;)  # 匹配合并，交集</span><br><span class="line">df_left=pd.merge(df,df1,how=&#x27;left&#x27;)        #</span><br><span class="line">df_right=pd.merge(df,df1,how=&#x27;right&#x27;)</span><br><span class="line">df_outer=pd.merge(df,df1,how=&#x27;outer&#x27;)  #并集</span><br></pre></td></tr></table></figure>

<p>2、设置索引列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.set_index(&#x27;id&#x27;)</span><br></pre></td></tr></table></figure>

<p>3、按照特定列的值排序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.sort_values(by=[&#x27;age&#x27;])</span><br></pre></td></tr></table></figure>

<p>4、按照索引列排序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.sort_index()</span><br></pre></td></tr></table></figure>

<p>5、如果prince列的值&gt;3000，group列显示high，否则显示low：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner[&#x27;group&#x27;] = np.where(df_inner[&#x27;price&#x27;] &gt; 3000,&#x27;high&#x27;,&#x27;low&#x27;)</span><br></pre></td></tr></table></figure>

<p>6、对复合多个条件的数据进行分组标记</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[(df_inner[&#x27;city&#x27;] == &#x27;beijing&#x27;) &amp; (df_inner[&#x27;price&#x27;] &gt;= 4000), &#x27;sign&#x27;]=1</span><br></pre></td></tr></table></figure>

<p>7、对category字段的值依次进行分列，并创建数据表，索引值为df_inner的索引列，列名称为category和size</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame((x.split(&#x27;-&#x27;) for x in df_inner[&#x27;category&#x27;]),index=df_inner.index,columns=[&#x27;category&#x27;,&#x27;size&#x27;]))</span><br></pre></td></tr></table></figure>

<p>8、将完成分裂后的数据表和原df_inner数据表进行匹配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner=pd.merge(df_inner,split,right_index=True, left_index=True)</span><br></pre></td></tr></table></figure>



<h2 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h2><p>主要用到的三个函数：loc,iloc和ix，loc函数按标签值进行提取，iloc按位置进行提取，ix可以同时按标签和位置进行提取。<br>1、按索引提取单行的数值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[3]</span><br></pre></td></tr></table></figure>

<p>2、按索引提取区域行数值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.iloc[0:5]</span><br></pre></td></tr></table></figure>

<p>3、重设索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.reset_index()</span><br></pre></td></tr></table></figure>

<p>4、设置日期为索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner=df_inner.set_index(&#x27;date&#x27;)</span><br></pre></td></tr></table></figure>

<p>5、提取4日之前的所有数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner[:&#x27;2013-01-04&#x27;]</span><br></pre></td></tr></table></figure>

<p>6、使用iloc按位置区域提取数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.iloc[:3,:2] #冒号前后的数字不再是索引的标签名称，而是数据所在的位置，从0开始，前三行，前两列。</span><br></pre></td></tr></table></figure>

<p>7、适应iloc按位置单独提起数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.iloc[[0,2,5],[4,5]] #提取第0、2、5行，4、5列</span><br></pre></td></tr></table></figure>

<p>8、使用ix按索引标签和位置混合提取数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.ix[:&#x27;2013-01-03&#x27;,:4] #2013-01-03号之前，前四列数据</span><br></pre></td></tr></table></figure>

<p>9、判断city列的值是否为北京</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner[&#x27;city&#x27;].isin([&#x27;beijing&#x27;])</span><br></pre></td></tr></table></figure>

<p>10、判断city列里是否包含beijing和shanghai，然后将符合条件的数据提取出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[df_inner[&#x27;city&#x27;].isin([&#x27;beijing&#x27;,&#x27;shanghai&#x27;])]</span><br></pre></td></tr></table></figure>

<p>11、提取前三个字符，并生成数据表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame(category.str[:3])</span><br></pre></td></tr></table></figure>



<h2 id="数据筛选"><a href="#数据筛选" class="headerlink" title="数据筛选"></a>数据筛选</h2><p>使用与、或、非三个条件配合大于、小于、等于对数据进行筛选，并进行计数和求和。<br>1、使用“与”进行筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[(df_inner[&#x27;age&#x27;] &gt; 25) &amp; (df_inner[&#x27;city&#x27;] == &#x27;beijing&#x27;), [&#x27;id&#x27;,&#x27;city&#x27;,&#x27;age&#x27;,&#x27;category&#x27;,&#x27;gender&#x27;]]</span><br></pre></td></tr></table></figure>

<p>2、使用“或”进行筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[(df_inner[&#x27;age&#x27;] &gt; 25) | (df_inner[&#x27;city&#x27;] == &#x27;beijing&#x27;), [&#x27;id&#x27;,&#x27;city&#x27;,&#x27;age&#x27;,&#x27;category&#x27;,&#x27;gender&#x27;]].sort([&#x27;age&#x27;])</span><br></pre></td></tr></table></figure>

<p>3、使用“非”条件进行筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[(df_inner[&#x27;city&#x27;] != &#x27;beijing&#x27;), [&#x27;id&#x27;,&#x27;city&#x27;,&#x27;age&#x27;,&#x27;category&#x27;,&#x27;gender&#x27;]].sort([&#x27;id&#x27;])</span><br></pre></td></tr></table></figure>

<p>4、对筛选后的数据按city列进行计数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[(df_inner[&#x27;city&#x27;] != &#x27;beijing&#x27;), [&#x27;id&#x27;,&#x27;city&#x27;,&#x27;age&#x27;,&#x27;category&#x27;,&#x27;gender&#x27;]].sort([&#x27;id&#x27;]).city.count()</span><br></pre></td></tr></table></figure>

<p>5、使用query函数进行筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.query(&#x27;city == [&quot;beijing&quot;, &quot;shanghai&quot;]&#x27;)</span><br></pre></td></tr></table></figure>

<p>6、对筛选后的结果按prince进行求和</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.query(&#x27;city == [&quot;beijing&quot;, &quot;shanghai&quot;]&#x27;).price.sum()</span><br></pre></td></tr></table></figure>



<h2 id="数据汇总"><a href="#数据汇总" class="headerlink" title="数据汇总"></a>数据汇总</h2><p>主要函数是groupby和pivote_table<br>1、对所有的列进行计数汇总</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.groupby(&#x27;city&#x27;).count()</span><br></pre></td></tr></table></figure>

<p>2、按城市对id字段进行计数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.groupby(&#x27;city&#x27;)[&#x27;id&#x27;].count()</span><br></pre></td></tr></table></figure>

<p>3、对两个字段进行汇总计数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.groupby([&#x27;city&#x27;,&#x27;size&#x27;])[&#x27;id&#x27;].count()</span><br></pre></td></tr></table></figure>

<p>4、对city字段进行汇总，并分别计算prince的合计和均值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.groupby(&#x27;city&#x27;)[&#x27;price&#x27;].agg([len,np.sum, np.mean])</span><br></pre></td></tr></table></figure>



<h2 id="数据统计"><a href="#数据统计" class="headerlink" title="数据统计"></a>数据统计</h2><p>数据采样，计算标准差，协方差和相关系数<br>1、简单的数据采样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.sample(n=3)</span><br></pre></td></tr></table></figure>

<p>2、手动设置采样权重</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">weights = [0, 0, 0, 0, 0.5, 0.5]</span><br><span class="line">df_inner.sample(n=2, weights=weights)</span><br></pre></td></tr></table></figure>

<p>3、采样后不放回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.sample(n=6, replace=False)</span><br></pre></td></tr></table></figure>

<p>4、采样后放回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.sample(n=6, replace=True)</span><br></pre></td></tr></table></figure>

<p>5、 数据表描述性统计</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.describe().round(2).T #round函数设置显示小数位，T表示转置</span><br></pre></td></tr></table></figure>

<p>6、计算列的标准差</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner[&#x27;price&#x27;].std()</span><br></pre></td></tr></table></figure>

<p>7、计算两个字段间的协方差</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner[&#x27;price&#x27;].cov(df_inner[&#x27;m-point&#x27;])</span><br></pre></td></tr></table></figure>

<p>8、数据表中所有字段间的协方差</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.cov()</span><br></pre></td></tr></table></figure>

<p>9、两个字段的相关性分析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner[&#x27;price&#x27;].corr(df_inner[&#x27;m-point&#x27;]) #相关系数在-1到1之间，接近1为正相关，接近-1为负相关，0为不相关</span><br></pre></td></tr></table></figure>

<p>10、数据表的相关性分析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.corr()</span><br></pre></td></tr></table></figure>



<h2 id="数据输出"><a href="#数据输出" class="headerlink" title="数据输出"></a>数据输出</h2><p>分析后的数据可以输出为xlsx格式和csv格式<br>1、写入Excel</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.to_excel(&#x27;excel_to_python.xlsx&#x27;, sheet_name=&#x27;bluewhale_cc&#x27;)</span><br></pre></td></tr></table></figure>

<p>2、写入到CSV</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.to_csv(&#x27;excel_to_python.csv&#x27;)</span><br></pre></td></tr></table></figure>
</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>