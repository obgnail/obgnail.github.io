<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="&lt;a href=&quot;https://cn.redux.js.org/docs/advanced/UsageWithReactRouter.html&quot;&gt;https://cn.redux.js.org/docs/advanced/UsageWithReactRouter.html&lt;/a&gt;"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>react-router快速入门 | 凉薄的自动书记人偶</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Tags</a><a class="sidebar-nav-item" href="/About">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/React/" rel="tag">React</a></div><div class="post-time">2020-08-04</div></div></div><div class="container post-header"><h1>react-router快速入门</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%90%AD%E9%85%8D-React-Router"><span class="toc-number">1.</span> <span class="toc-text">搭配 React Router</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-React-Router"><span class="toc-number">1.1.</span> <span class="toc-text">安装 React Router</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%90%8E%E5%A4%87-fallback-URL"><span class="toc-number">1.2.</span> <span class="toc-text">配置后备(fallback) URL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Create-React-App-%E9%A1%BB%E7%9F%A5"><span class="toc-number">1.2.1.</span> <span class="toc-text">使用 Create React App 须知</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-Express"><span class="toc-number">1.2.2.</span> <span class="toc-text">配置 Express</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-WebpackDevServer"><span class="toc-number">1.2.3.</span> <span class="toc-text">配置 WebpackDevServer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5-React-Router-%E5%92%8C-Redux-%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">连接 React Router 和 Redux 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#components-Root-js"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">components&#x2F;Root.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#index-js"><span class="toc-number">1.3.0.2.</span> <span class="toc-text">index.js</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-React-Router-%E5%AF%BC%E8%88%AA"><span class="toc-number">1.4.</span> <span class="toc-text">通过 React Router 导航</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#containers-FilterLink-js"><span class="toc-number">1.4.1.</span> <span class="toc-text">containers&#x2F;FilterLink.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#components-Footer-js"><span class="toc-number">1.4.2.</span> <span class="toc-text">components&#x2F;Footer.js</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E-URL-%E4%B8%AD%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.</span> <span class="toc-text">从 URL 中读取数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#containers-VisibleTodoList-js"><span class="toc-number">1.5.1.</span> <span class="toc-text">containers&#x2F;VisibleTodoList.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#components-App-js"><span class="toc-number">1.5.2.</span> <span class="toc-text">components&#x2F;App.js</span></a></li></ol></li></ol></li></ol></details></div><div class="container post-content"><p><a target="_blank" rel="noopener" href="https://cn.redux.js.org/docs/advanced/UsageWithReactRouter.html">https://cn.redux.js.org/docs/advanced/UsageWithReactRouter.html</a></p>
<h1 id="搭配-React-Router"><a href="#搭配-React-Router" class="headerlink" title="搭配 React Router"></a>搭配 React Router</h1><p>现在你想在你的 Redux 应用中使用路由功能，可以搭配使用 <a target="_blank" rel="noopener" href="https://github.com/reactjs/react-router">React Router</a> 来实现。 Redux 和 React Router 将分别成为你数据和 URL 的事实来源（the source of truth）。 在大多数情况下， <strong>最好</strong> 将他们分开，除非你需要时光旅行和回放 action 来触发 URL 改变。</p>
<h2 id="安装-React-Router"><a href="#安装-React-Router" class="headerlink" title="安装 React Router"></a>安装 React Router</h2><p>可以使用 npm 来安装 <code>react-router-dom</code>。本教程基于 <code>react-router-dom@^4.1.1</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react-router-dom</span><br></pre></td></tr></table></figure>

<h2 id="配置后备-fallback-URL"><a href="#配置后备-fallback-URL" class="headerlink" title="配置后备(fallback) URL"></a>配置后备(fallback) URL</h2><p>在集成 React Router 之前，我们需要配置一下我们的开发服务器。 显然，我们的开发服务器无法感知配置在 React Router 中的 route。 比如：你想访问并刷新 <code>/todos</code>，由于是一个单页面应用，你的开发服务器需要生成并返回 <code>index.html</code>。 这里，我们将演示如何在流行的开发服务器上启用这项功能。</p>
<blockquote>
<h3 id="使用-Create-React-App-须知"><a href="#使用-Create-React-App-须知" class="headerlink" title="使用 Create React App 须知"></a>使用 Create React App 须知</h3><p>如果你是使用 Create React App （你可以点击<a target="_blank" rel="noopener" href="https://facebook.github.io/react/blog/2016/07/22/create-apps-with-no-configuration.html">这里</a>了解更多，译者注）工具来生成项目，会自动为你配置好后备(fallback) URL。</p>
</blockquote>
<h3 id="配置-Express"><a href="#配置-Express" class="headerlink" title="配置 Express"></a>配置 Express</h3><p>如果你使用的是 Express 来返回你的 <code>index.html</code> 页面，可以增加以下代码到你的项目中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/*&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.sendfile(path.join(__dirname, <span class="string">&#x27;index.html&#x27;</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="配置-WebpackDevServer"><a href="#配置-WebpackDevServer" class="headerlink" title="配置 WebpackDevServer"></a>配置 WebpackDevServer</h3><p>如果你正在使用 WebpackDevServer 来返回你的 <code>index.html</code> 页面， 你可以增加如下配置到 webpack.config.dev.js：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">  <span class="attr">historyApiFallback</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="连接-React-Router-和-Redux-应用"><a href="#连接-React-Router-和-Redux-应用" class="headerlink" title="连接 React Router 和 Redux 应用"></a>连接 React Router 和 Redux 应用</h2><p>在这一章，我们将使用 <a target="_blank" rel="noopener" href="https://github.com/reactjs/redux/tree/master/examples/todos">Todos</a> 作为例子。我们建议你在阅读本章的时候，先将仓库克隆下来。</p>
<p>首先，我们需要从 React Router 中导入 <code>&lt;Router /&gt;</code> 和 <code>&lt;Route /&gt;</code>。代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserRouter <span class="keyword">as</span> Router, Route &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br></pre></td></tr></table></figure>

<p>在 React 应用中，通常你会用 <code>&lt;Router /&gt;</code> 包裹 <code>&lt;Route /&gt;</code>。 如此，当 URL 变化的时候，<code>&lt;Router /&gt;</code> 将会匹配到指定的路由，然后渲染路由绑定的组件。 <code>&lt;Route /&gt;</code> 用来显式地把路由映射到应用的组件结构上。 用 <code>path</code> 指定 URL，用 <code>component</code> 指定路由命中 URL 后需要渲染的那个组件。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Root = <span class="function">() =&gt;</span> (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">component</span>=<span class="string">&#123;App&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>另外，在我们的 Redux 应用中，我们仍将使用 <code>&lt;Provider /&gt;</code>。 <code>&lt;Provider /&gt;</code> 是由 React Redux 提供的高阶组件，用来让你将 Redux 绑定到 React （详见 <a target="_blank" rel="noopener" href="https://cn.redux.js.org/docs/basics/UsageWithReact.html">搭配 React</a>）。</p>
<p>然后，我们从 React Redux 导入 <code>&lt;Provider /&gt;</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br></pre></td></tr></table></figure>

<p>我们将用 <code>&lt;Provider /&gt;</code> 包裹 <code>&lt;Router /&gt;</code>，以便于路由处理器可以<a target="_blank" rel="noopener" href="https://cn.redux.js.org/docs/basics/UsageWithReact.html#passing-the-store">访问 <code>store</code></a>。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Root = <span class="function">(<span class="params">&#123; store &#125;</span>) =&gt;</span> (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">component</span>=<span class="string">&#123;App&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>现在，如果 URL 匹配到 ‘/‘，将会渲染 <code>&lt;App /&gt;</code> 组件。此外，我们将在 ‘/‘ 后面增加参数 <code>:filter?</code>, 以便以后我们从 URL 中读取参数 <code>:filter</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route path=<span class="string">&quot;/:filter?&quot;</span> component=&#123;App&#125; /&gt;</span><br></pre></td></tr></table></figure>

<p>也许你想将 ‘#’ 从 URL 中移除（例如：<code>http://localhost:3000/#/?_k=4sbb0i</code>）。 你需要从 React Router 导入 <code>browserHistory</code> 来实现：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Router, Route, browserHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="components-Root-js"><a href="#components-Root-js" class="headerlink" title="components/Root.js"></a><code>components/Root.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; BrowserRouter <span class="keyword">as</span> Router, Route &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"><span class="keyword">const</span> Root = <span class="function">(<span class="params">&#123; store &#125;</span>) =&gt;</span> (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/:filter?&quot;</span> <span class="attr">component</span>=<span class="string">&#123;App&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line">Root.propTypes = &#123;</span><br><span class="line">  <span class="attr">store</span>: PropTypes.object.isRequired</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Root</span><br></pre></td></tr></table></figure>

<p>我们需要重构 <code>index.js</code> 来把 <code>&lt;Root /&gt;</code> 组件渲染到 DOM 上。</p>
<h4 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a><code>index.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> todoApp <span class="keyword">from</span> <span class="string">&#x27;./reducers&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Root <span class="keyword">from</span> <span class="string">&#x27;./components/Root&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(todoApp)</span><br><span class="line"></span><br><span class="line">render(<span class="xml"><span class="tag">&lt;<span class="name">Root</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span> /&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="通过-React-Router-导航"><a href="#通过-React-Router-导航" class="headerlink" title="通过 React Router 导航"></a>通过 React Router 导航</h2><p>React Router 提供了 <a target="_blank" rel="noopener" href="https://github.com/reactjs/react-router/blob/master/docs/API.md#link">``</a> 来实现导航功能。 如果你需要自定义样式，<code>react-router-dom</code> 提供了另一个可以自定义样式的特殊 <code>&lt;Link /&gt;</code> 叫做 <a target="_blank" rel="noopener" href="https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/api/NavLink.md">``</a>。 例如你可以通过 <code>activeStyle</code> 属性来指定激活状态的样式。</p>
<p>在我们的示例中，我们可以在一个新的容器组件 <code>&lt;FilterLink/&gt;</code> 中 使用 <code>&lt;NavLink/&gt;</code> ，以便动态地更改 URL。</p>
<h3 id="containers-FilterLink-js"><a href="#containers-FilterLink-js" class="headerlink" title="containers/FilterLink.js"></a><code>containers/FilterLink.js</code></h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; NavLink &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">const</span> FilterLink = <span class="function">(<span class="params">&#123; filter, children &#125;</span>) =&gt;</span> (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">NavLink</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">    <span class="attr">to</span>=<span class="string">&#123;filter</span> === <span class="string">&#x27;SHOW_ALL&#x27;</span> ? &#x27;/&#x27; <span class="attr">:</span> `/$&#123;<span class="attr">filter</span>&#125;`&#125;</span></span></span><br><span class="line"><span class="tag"><span class="xml">    <span class="attr">activeStyle</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">textDecoration:</span> &#x27;<span class="attr">none</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">color:</span> &#x27;<span class="attr">black</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="xml">    &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="xml">  &gt;</span></span></span><br><span class="line"><span class="xml">    &#123;children&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> FilterLink</span><br></pre></td></tr></table></figure>

<h3 id="components-Footer-js"><a href="#components-Footer-js" class="headerlink" title="components/Footer.js"></a><code>components/Footer.js</code></h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> FilterLink <span class="keyword">from</span> <span class="string">&#x27;../containers/FilterLink&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; VisibilityFilters &#125; <span class="keyword">from</span> <span class="string">&#x27;../actions&#x27;</span></span><br><span class="line"><span class="keyword">const</span> Footer = <span class="function">() =&gt;</span> (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">    Show: <span class="tag">&lt;<span class="name">FilterLink</span> <span class="attr">filter</span>=<span class="string">&#123;VisibilityFilters.SHOW_ALL&#125;</span>&gt;</span>All<span class="tag">&lt;/<span class="name">FilterLink</span>&gt;</span></span></span><br><span class="line"><span class="xml">    &#123;&#x27;, &#x27;&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">FilterLink</span> <span class="attr">filter</span>=<span class="string">&#123;VisibilityFilters.SHOW_ACTIVE&#125;</span>&gt;</span>Active<span class="tag">&lt;/<span class="name">FilterLink</span>&gt;</span></span></span><br><span class="line"><span class="xml">    &#123;&#x27;, &#x27;&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">FilterLink</span> <span class="attr">filter</span>=<span class="string">&#123;VisibilityFilters.SHOW_COMPLETED&#125;</span>&gt;</span>Completed<span class="tag">&lt;/<span class="name">FilterLink</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Footer</span><br></pre></td></tr></table></figure>

<p>这时，如果你点击 <code>&lt;FilterLink /&gt;</code>，你将看到你的 URL 在 <code>&#39;/SHOW_COMPLETED&#39;</code>，<code>&#39;/SHOW_ACTIVE&#39;</code>，<code>&#39;/&#39;</code> 间切换。 甚至还支持浏览的回退功能，可以从历史记录中找到之前的 URL 并回退。</p>
<h2 id="从-URL-中读取数据"><a href="#从-URL-中读取数据" class="headerlink" title="从 URL 中读取数据"></a>从 URL 中读取数据</h2><p>现在，即使 URL 改变，todo 列表也不会被过滤。 这是因为我们是在 <code>&lt;VisibleTodoList /&gt;</code> 的 <code>mapStateToProps()</code> 函数中过滤的。 这个目前仍然是和 <code>state</code> 绑定，而不是和 URL 绑定。 <code>mapStateToProps</code> 的第二可选参数 <code>ownProps</code>，这个是一个传递给 <code>&lt;VisibleTodoList /&gt;</code> 所有属性的对象。</p>
<h3 id="containers-VisibleTodoList-js"><a href="#containers-VisibleTodoList-js" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, ownProps</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">todos</span>: getVisibleTodos(state.todos, ownProps.filter) <span class="comment">// 以前是 getVisibleTodos(state.todos, state.visibilityFilter)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>目前我们还没有传递任何参数给 <code>&lt;App /&gt;</code>，所以 <code>ownProps</code> 依然是一个空对象。 为了能够根据 URL 来过滤我们的 todo 列表，我们需要向 <code>&lt;VisibleTodoList /&gt;</code> 传递 URL 参数。</p>
<p>之前我们写过：<code>&lt;Route path=&quot;/:filter?&quot; component=&#123;App&#125; /&gt;</code>，这使得可以在 <code>App</code> 中获取 <code>params</code> 的属性。</p>
<p><code>params</code> 是一个包含 url 中所有指定参数的对象。 <em>例如：如果我们访问 <code>localhost:3000/SHOW_COMPLETED</code>，那么 <code>match.params</code> 将等价于 <code>&#123; filter: &#39;SHOW_COMPLETED&#39; &#125;</code>。 现在，我们可以在 <code>&lt;App /&gt;</code> 中读取 URL 参数了。</em></p>
<p>注意，我们将使用 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment">ES6 的解构赋值</a>来对 <code>params</code> 进行赋值，以此传递给 <code>&lt;VisibleTodoList /&gt;</code>。</p>
<h3 id="components-App-js"><a href="#components-App-js" class="headerlink" title="components/App.js"></a><code>components/App.js</code></h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> App = <span class="function">(<span class="params">&#123; match: &#123; params &#125; &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">AddTodo</span> /&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">VisibleTodoList</span> <span class="attr">filter</span>=<span class="string">&#123;params.filter</span> || &#x27;<span class="attr">SHOW_ALL</span>&#x27;&#125; /&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></div></article><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>